+ export ARNOLD_WORKER_GPU=1
+ ARNOLD_WORKER_GPU=1
+ export ARNOLD_WORKER_NUM=1
+ ARNOLD_WORKER_NUM=1
+ export TORCH_CUDA_ARCH_LIST=12.0+PTX
+ TORCH_CUDA_ARCH_LIST=12.0+PTX
+ HDFS_ROOT=/workspace/verl
+ DATA_ROOT=/workspace/verl
+ backend=megatron
+ project_name=wuxibin_gspo
+ experiment_name=qwen3-30B-base-grpo-megatron
+ default_local_dir=/workspace/verl/checkpoint/wuxibin_gspo/qwen3-30B-base-grpo-megatron
+ adv_estimator=grpo
+ loss_mode=gspo
+ use_kl_in_reward=False
+ kl_coef=0.001
+ use_kl_loss=False
+ kl_loss_coef=0.001
+ clip_ratio_low=3e-4
+ clip_ratio_high=4e-4
+ actor_lr=1e-6
+ critic_lr=2e-6
+ gae_gamma=1.0
+ gae_lam=0.95
+ critic_warmup=0
+ train_files=hf://datasets/BytedTsinghua-SIA/DAPO-Math-17k/data/dapo-math-17k.parquet
+ test_files=hf://datasets/BytedTsinghua-SIA/AIME-2024/data/aime-2024.parquet
+ actor_model_path=Qwen/Qwen3-30B-A3B-Base
+ critic_model_path=Qwen/Qwen3-30B-A3B-Base
+ max_prompt_length=2048
+ max_response_length=8192
+ enable_overlong_buffer=True
+ overlong_buffer_len=4096
+ overlong_penalty_factor=1.0
+ train_batch_size=256
+ ppo_mini_batch_size=32
+ n_resp_per_prompt=16
+ n_resp_per_prompt_val=1
+ actor_max_token_len_per_gpu=30720
+ critic_max_token_len_per_gpu=40960
+ USP_SIZE=4
+ ACTOR_FSDP_CONFIG='
    actor_rollout_ref.actor.fsdp_config.strategy=megatron     actor_rollout_ref.actor.fsdp_config.param_offload=True     actor_rollout_ref.actor.fsdp_config.optimizer_offload=True     actor_rollout_ref.actor.ulysses_sequence_parallel_size=4'
+ TP_SIZE=1
+ CP_SIZE=1
+ PP_SIZE=1
+ VPP_SIZE=null
+ EP_SIZE=1
+ ETP_SIZE=1
+ ACTOR_MEGATRON_CONFIG='
    actor_rollout_ref.actor.megatron.tensor_model_parallel_size=1     actor_rollout_ref.actor.megatron.context_parallel_size=1     actor_rollout_ref.actor.megatron.pipeline_model_parallel_size=1     actor_rollout_ref.actor.megatron.virtual_pipeline_model_parallel_size=null     actor_rollout_ref.actor.megatron.expert_model_parallel_size=1     actor_rollout_ref.actor.megatron.expert_tensor_parallel_size=1     actor_rollout_ref.actor.megatron.param_offload=True     actor_rollout_ref.actor.megatron.grad_offload=True     actor_rollout_ref.actor.megatron.optimizer_offload=True     +actor_rollout_ref.actor.megatron.override_transformer_config.moe_router_dtype=fp32     +actor_rollout_ref.actor.megatron.override_transformer_config.moe_permute_fusion=True     +actor_rollout_ref.actor.megatron.override_transformer_config.recompute_method=uniform     +actor_rollout_ref.actor.megatron.override_transformer_config.recompute_granularity=full     +actor_rollout_ref.actor.megatron.override_transformer_config.recompute_num_layers=1     +actor_rollout_ref.actor.megatron.override_transformer_config.apply_rope_fusion=True     +actor_rollout_ref.actor.megatron.override_transformer_config.gradient_accumulation_fusion=False     actor_rollout_ref.actor.megatron.use_mbridge=True'
+ ACTOR_CONFIG='
    actor_rollout_ref.actor.optim.lr=1e-6     actor_rollout_ref.model.path=Qwen/Qwen3-30B-A3B-Base     actor_rollout_ref.model.use_remove_padding=True     actor_rollout_ref.actor.use_kl_loss=False     actor_rollout_ref.actor.kl_loss_coef=0.001     actor_rollout_ref.actor.clip_ratio_low=3e-4     actor_rollout_ref.actor.clip_ratio_high=4e-4     actor_rollout_ref.actor.clip_ratio_c=10.0     actor_rollout_ref.actor.policy_loss.loss_mode=gspo
    actor_rollout_ref.actor.use_dynamic_bsz=True     actor_rollout_ref.actor.ppo_mini_batch_size=32     actor_rollout_ref.actor.ppo_max_token_len_per_gpu=30720'
+ CIRITC_CONFIG='
    critic.optim.lr=2e-6     critic.model.path=Qwen/Qwen3-30B-A3B-Base     critic.model.use_remove_padding=True     critic.ppo_max_token_len_per_gpu=40960     critic.ulysses_sequence_parallel_size=4'
+ CRITIC_FSDP_CONFIG='
    critic.model.fsdp_config.strategy=megatron     critic.model.fsdp_config.param_offload=True     critic.model.fsdp_config.optimizer_offload=True     critic.model.ulysses_sequence_parallel_size=4'
+ CRITIC_MEGATRON_CONFIG='
    critic.megatron.tensor_model_parallel_size=1     critic.megatron.context_parallel_size=1     critic.megatron.pipeline_model_parallel_size=1     critic.megatron.virtual_pipeline_model_parallel_size=null     critic.megatron.expert_model_parallel_size=1     critic.megatron.expert_tensor_parallel_size=1     critic.megatron.param_offload=True     critic.megatron.grad_offload=True     critic.megatron.optimizer_offload=True     +critic.megatron.override_transformer_config.moe_router_dtype=fp32     +critic.megatron.override_transformer_config.moe_permute_fusion=True     +critic.megatron.override_transformer_config.recompute_method=uniform     +critic.megatron.override_transformer_config.recompute_granularity=full     +critic.megatron.override_transformer_config.recompute_num_layers=1     +critic.megatron.override_transformer_config.apply_rope_fusion=True     +critic.megatron.override_transformer_config.gradient_accumulation_fusion=False     critic.megatron.use_mbridge=True'
+ [[ megatron == \m\e\g\a\t\r\o\n ]]
+ CONFIG_NAME=ppo_megatron_trainer
+ ACTOR_CONFIG='
    actor_rollout_ref.actor.optim.lr=1e-6     actor_rollout_ref.model.path=Qwen/Qwen3-30B-A3B-Base     actor_rollout_ref.model.use_remove_padding=True     actor_rollout_ref.actor.use_kl_loss=False     actor_rollout_ref.actor.kl_loss_coef=0.001     actor_rollout_ref.actor.clip_ratio_low=3e-4     actor_rollout_ref.actor.clip_ratio_high=4e-4     actor_rollout_ref.actor.clip_ratio_c=10.0     actor_rollout_ref.actor.policy_loss.loss_mode=gspo
    actor_rollout_ref.actor.use_dynamic_bsz=True     actor_rollout_ref.actor.ppo_mini_batch_size=32     actor_rollout_ref.actor.ppo_max_token_len_per_gpu=30720 
    actor_rollout_ref.actor.megatron.tensor_model_parallel_size=1     actor_rollout_ref.actor.megatron.context_parallel_size=1     actor_rollout_ref.actor.megatron.pipeline_model_parallel_size=1     actor_rollout_ref.actor.megatron.virtual_pipeline_model_parallel_size=null     actor_rollout_ref.actor.megatron.expert_model_parallel_size=1     actor_rollout_ref.actor.megatron.expert_tensor_parallel_size=1     actor_rollout_ref.actor.megatron.param_offload=True     actor_rollout_ref.actor.megatron.grad_offload=True     actor_rollout_ref.actor.megatron.optimizer_offload=True     +actor_rollout_ref.actor.megatron.override_transformer_config.moe_router_dtype=fp32     +actor_rollout_ref.actor.megatron.override_transformer_config.moe_permute_fusion=True     +actor_rollout_ref.actor.megatron.override_transformer_config.recompute_method=uniform     +actor_rollout_ref.actor.megatron.override_transformer_config.recompute_granularity=full     +actor_rollout_ref.actor.megatron.override_transformer_config.recompute_num_layers=1     +actor_rollout_ref.actor.megatron.override_transformer_config.apply_rope_fusion=True     +actor_rollout_ref.actor.megatron.override_transformer_config.gradient_accumulation_fusion=False     actor_rollout_ref.actor.megatron.use_mbridge=True'
+ [[ grpo == \g\a\e ]]
+ CIRITC_CONFIG=
+ rollout_name=vllm
+ '[' vllm = vllm ']'
+ export VLLM_USE_V1=1
+ VLLM_USE_V1=1
+ infer_tp=1
+ infer_dp=1
+ infer_ep=1
+ gpu_memory_utilization=0.8
+ ROLLOUT_CONFIG='
    actor_rollout_ref.rollout.name=vllm     actor_rollout_ref.rollout.mode=async     actor_rollout_ref.rollout.tensor_model_parallel_size=1     actor_rollout_ref.rollout.data_parallel_size=1     actor_rollout_ref.rollout.expert_parallel_size=1     actor_rollout_ref.rollout.gpu_memory_utilization=0.8     actor_rollout_ref.rollout.n=16     actor_rollout_ref.rollout.val_kwargs.top_p=0.7     actor_rollout_ref.rollout.val_kwargs.temperature=1.0     actor_rollout_ref.rollout.val_kwargs.n=1'
+ REWARD_CONFIG='
    reward_model.reward_manager=dapo     +reward_model.reward_kwargs.overlong_buffer_cfg.enable=True     +reward_model.reward_kwargs.overlong_buffer_cfg.len=4096     +reward_model.reward_kwargs.overlong_buffer_cfg.penalty_factor=1.0     +reward_model.reward_kwargs.overlong_buffer_cfg.log=False     +reward_model.reward_kwargs.max_resp_len=8192'
+ python3 -m verl.trainer.main_ppo --config-path=./config --config-name=ppo_megatron_trainer algorithm.adv_estimator=grpo algorithm.use_kl_in_reward=False algorithm.kl_ctrl.kl_coef=0.001 algorithm.gamma=1.0 algorithm.lam=0.95 data.train_files=hf://datasets/BytedTsinghua-SIA/DAPO-Math-17k/data/dapo-math-17k.parquet data.val_files=hf://datasets/BytedTsinghua-SIA/AIME-2024/data/aime-2024.parquet data.return_raw_chat=True data.train_batch_size=256 data.max_prompt_length=2048 data.max_response_length=8192 data.filter_overlong_prompts=True data.filter_overlong_prompts_workers=64 data.truncation=error trainer.use_legacy_worker_impl=disable trainer.critic_warmup=0 'trainer.logger=[console,wandb]' trainer.project_name=wuxibin_gspo trainer.experiment_name=qwen3-30B-base-grpo-megatron trainer.default_local_dir=/workspace/verl/checkpoint/wuxibin_gspo/qwen3-30B-base-grpo-megatron trainer.n_gpus_per_node=1 trainer.nnodes=1 trainer.val_before_train=False trainer.log_val_generations=100 trainer.save_freq=-1 trainer.test_freq=10 trainer.total_epochs=10 trainer.total_training_steps=500 actor_rollout_ref.actor.optim.lr=1e-6 actor_rollout_ref.model.path=Qwen/Qwen3-30B-A3B-Base actor_rollout_ref.model.use_remove_padding=True actor_rollout_ref.actor.use_kl_loss=False actor_rollout_ref.actor.kl_loss_coef=0.001 actor_rollout_ref.actor.clip_ratio_low=3e-4 actor_rollout_ref.actor.clip_ratio_high=4e-4 actor_rollout_ref.actor.clip_ratio_c=10.0 actor_rollout_ref.actor.policy_loss.loss_mode=gspo actor_rollout_ref.actor.use_dynamic_bsz=True actor_rollout_ref.actor.ppo_mini_batch_size=32 actor_rollout_ref.actor.ppo_max_token_len_per_gpu=30720 actor_rollout_ref.actor.megatron.tensor_model_parallel_size=1 actor_rollout_ref.actor.megatron.context_parallel_size=1 actor_rollout_ref.actor.megatron.pipeline_model_parallel_size=1 actor_rollout_ref.actor.megatron.virtual_pipeline_model_parallel_size=null actor_rollout_ref.actor.megatron.expert_model_parallel_size=1 actor_rollout_ref.actor.megatron.expert_tensor_parallel_size=1 actor_rollout_ref.actor.megatron.param_offload=True actor_rollout_ref.actor.megatron.grad_offload=True actor_rollout_ref.actor.megatron.optimizer_offload=True +actor_rollout_ref.actor.megatron.override_transformer_config.moe_router_dtype=fp32 +actor_rollout_ref.actor.megatron.override_transformer_config.moe_permute_fusion=True +actor_rollout_ref.actor.megatron.override_transformer_config.recompute_method=uniform +actor_rollout_ref.actor.megatron.override_transformer_config.recompute_granularity=full +actor_rollout_ref.actor.megatron.override_transformer_config.recompute_num_layers=1 +actor_rollout_ref.actor.megatron.override_transformer_config.apply_rope_fusion=True +actor_rollout_ref.actor.megatron.override_transformer_config.gradient_accumulation_fusion=False actor_rollout_ref.actor.megatron.use_mbridge=True actor_rollout_ref.rollout.name=vllm actor_rollout_ref.rollout.mode=async actor_rollout_ref.rollout.tensor_model_parallel_size=1 actor_rollout_ref.rollout.data_parallel_size=1 actor_rollout_ref.rollout.expert_parallel_size=1 actor_rollout_ref.rollout.gpu_memory_utilization=0.8 actor_rollout_ref.rollout.n=16 actor_rollout_ref.rollout.val_kwargs.top_p=0.7 actor_rollout_ref.rollout.val_kwargs.temperature=1.0 actor_rollout_ref.rollout.val_kwargs.n=1 reward_model.reward_manager=dapo +reward_model.reward_kwargs.overlong_buffer_cfg.enable=True +reward_model.reward_kwargs.overlong_buffer_cfg.len=4096 +reward_model.reward_kwargs.overlong_buffer_cfg.penalty_factor=1.0 +reward_model.reward_kwargs.overlong_buffer_cfg.log=False +reward_model.reward_kwargs.max_resp_len=8192
2025-12-24 04:55:26,580	INFO worker.py:1942 -- Started a local Ray instance. View the dashboard at [1m[32mhttp://127.0.0.1:8265 [39m[22m
[36m(pid=2344)[0m W1224 04:55:32.097000 2344 torch/utils/cpp_extension.py:118] No CUDA runtime is found, using CUDA_HOME='/usr/local/cuda'
[36m(TaskRunner pid=2344)[0m /workspace/verl/verl/verl/trainer/main_ppo.py:307: UserWarning: Disabled critic as algorithm.adv_estimator != gae. If it is not intended, please set critic.enable=True
[36m(TaskRunner pid=2344)[0m   use_critic=need_critic(config),
ray init kwargs: {'num_cpus': None, 'runtime_env': {'env_vars': {'TOKENIZERS_PARALLELISM': 'true', 'NCCL_DEBUG': 'WARN', 'VLLM_LOGGING_LEVEL': 'WARN', 'VLLM_ALLOW_RUNTIME_LORA_UPDATING': 'true', 'VLLM_ALLREDUCE_USE_SYMM_MEM': '0', 'CUDA_DEVICE_MAX_CONNECTIONS': '1', 'NCCL_CUMEM_ENABLE': '0'}, 'working_dir': None}}
[36m(TaskRunner pid=2344)[0m TaskRunner hostname: verl-related-work, PID: 2344
[36m(TaskRunner pid=2344)[0m {'actor_rollout_ref': {'actor': {'_target_': 'verl.workers.config.McoreActorConfig',
[36m(TaskRunner pid=2344)[0m                                  'calculate_entropy': False,
[36m(TaskRunner pid=2344)[0m                                  'checkpoint': {'_target_': 'verl.trainer.config.CheckpointConfig',
[36m(TaskRunner pid=2344)[0m                                                 'async_save': False,
[36m(TaskRunner pid=2344)[0m                                                 'load_contents': ['model',
[36m(TaskRunner pid=2344)[0m                                                                   'optimizer',
[36m(TaskRunner pid=2344)[0m                                                                   'extra'],
[36m(TaskRunner pid=2344)[0m                                                 'save_contents': ['model',
[36m(TaskRunner pid=2344)[0m                                                                   'optimizer',
[36m(TaskRunner pid=2344)[0m                                                                   'extra']},
[36m(TaskRunner pid=2344)[0m                                  'clip_ratio': 0.2,
[36m(TaskRunner pid=2344)[0m                                  'clip_ratio_c': 10.0,
[36m(TaskRunner pid=2344)[0m                                  'clip_ratio_high': 0.0004,
[36m(TaskRunner pid=2344)[0m                                  'clip_ratio_low': 0.0003,
[36m(TaskRunner pid=2344)[0m                                  'data_loader_seed': 42,
[36m(TaskRunner pid=2344)[0m                                  'entropy_coeff': 0,
[36m(TaskRunner pid=2344)[0m                                  'freeze_vision_tower': False,
[36m(TaskRunner pid=2344)[0m                                  'kl_loss_coef': 0.001,
[36m(TaskRunner pid=2344)[0m                                  'kl_loss_type': 'low_var_kl',
[36m(TaskRunner pid=2344)[0m                                  'load_weight': True,
[36m(TaskRunner pid=2344)[0m                                  'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=2344)[0m                                  'loss_scale_factor': None,
[36m(TaskRunner pid=2344)[0m                                  'megatron': {'_target_': 'verl.workers.config.McoreEngineConfig',
[36m(TaskRunner pid=2344)[0m                                               'context_parallel_size': 1,
[36m(TaskRunner pid=2344)[0m                                               'dist_checkpointing_path': None,
[36m(TaskRunner pid=2344)[0m                                               'dist_checkpointing_prefix': '',
[36m(TaskRunner pid=2344)[0m                                               'dtype': 'bfloat16',
[36m(TaskRunner pid=2344)[0m                                               'expert_model_parallel_size': 1,
[36m(TaskRunner pid=2344)[0m                                               'expert_tensor_parallel_size': 1,
[36m(TaskRunner pid=2344)[0m                                               'forward_only': False,
[36m(TaskRunner pid=2344)[0m                                               'grad_offload': True,
[36m(TaskRunner pid=2344)[0m                                               'optimizer_offload': True,
[36m(TaskRunner pid=2344)[0m                                               'override_ddp_config': {},
[36m(TaskRunner pid=2344)[0m                                               'override_mcore_model_config': {},
[36m(TaskRunner pid=2344)[0m                                               'override_transformer_config': {'apply_rope_fusion': True,
[36m(TaskRunner pid=2344)[0m                                                                               'attention_backend': 'flash',
[36m(TaskRunner pid=2344)[0m                                                                               'gradient_accumulation_fusion': False,
[36m(TaskRunner pid=2344)[0m                                                                               'moe_permute_fusion': True,
[36m(TaskRunner pid=2344)[0m                                                                               'moe_router_dtype': 'fp32',
[36m(TaskRunner pid=2344)[0m                                                                               'recompute_granularity': 'full',
[36m(TaskRunner pid=2344)[0m                                                                               'recompute_method': 'uniform',
[36m(TaskRunner pid=2344)[0m                                                                               'recompute_modules': ['core_attn'],
[36m(TaskRunner pid=2344)[0m                                                                               'recompute_num_layers': 1},
[36m(TaskRunner pid=2344)[0m                                               'param_offload': True,
[36m(TaskRunner pid=2344)[0m                                               'pipeline_model_parallel_size': 1,
[36m(TaskRunner pid=2344)[0m                                               'seed': 42,
[36m(TaskRunner pid=2344)[0m                                               'sequence_parallel': True,
[36m(TaskRunner pid=2344)[0m                                               'tensor_model_parallel_size': 1,
[36m(TaskRunner pid=2344)[0m                                               'use_dist_checkpointing': False,
[36m(TaskRunner pid=2344)[0m                                               'use_distributed_optimizer': True,
[36m(TaskRunner pid=2344)[0m                                               'use_mbridge': True,
[36m(TaskRunner pid=2344)[0m                                               'use_remove_padding': True,
[36m(TaskRunner pid=2344)[0m                                               'vanilla_mbridge': True,
[36m(TaskRunner pid=2344)[0m                                               'virtual_pipeline_model_parallel_size': None},
[36m(TaskRunner pid=2344)[0m                                  'optim': {'_target_': 'verl.workers.config.McoreOptimizerConfig',
[36m(TaskRunner pid=2344)[0m                                            'betas': [0.9, 0.999],
[36m(TaskRunner pid=2344)[0m                                            'clip_grad': 1.0,
[36m(TaskRunner pid=2344)[0m                                            'lr': 1e-06,
[36m(TaskRunner pid=2344)[0m                                            'lr_decay_steps': None,
[36m(TaskRunner pid=2344)[0m                                            'lr_decay_style': 'constant',
[36m(TaskRunner pid=2344)[0m                                            'lr_warmup_init': 0.0,
[36m(TaskRunner pid=2344)[0m                                            'lr_warmup_steps': -1,
[36m(TaskRunner pid=2344)[0m                                            'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=2344)[0m                                            'lr_wsd_decay_steps': None,
[36m(TaskRunner pid=2344)[0m                                            'lr_wsd_decay_style': 'exponential',
[36m(TaskRunner pid=2344)[0m                                            'min_lr': 0.0,
[36m(TaskRunner pid=2344)[0m                                            'optimizer': 'adam',
[36m(TaskRunner pid=2344)[0m                                            'override_optimizer_config': {},
[36m(TaskRunner pid=2344)[0m                                            'total_training_steps': -1,
[36m(TaskRunner pid=2344)[0m                                            'use_checkpoint_opt_param_scheduler': False,
[36m(TaskRunner pid=2344)[0m                                            'weight_decay': 0.01,
[36m(TaskRunner pid=2344)[0m                                            'weight_decay_incr_style': 'constant'},
[36m(TaskRunner pid=2344)[0m                                  'policy_loss': {'_target_': 'verl.workers.config.PolicyLossConfig',
[36m(TaskRunner pid=2344)[0m                                                  'clip_cov_lb': 1.0,
[36m(TaskRunner pid=2344)[0m                                                  'clip_cov_ratio': 0.0002,
[36m(TaskRunner pid=2344)[0m                                                  'clip_cov_ub': 5.0,
[36m(TaskRunner pid=2344)[0m                                                  'kl_cov_ratio': 0.0002,
[36m(TaskRunner pid=2344)[0m                                                  'loss_mode': 'gspo',
[36m(TaskRunner pid=2344)[0m                                                  'ppo_kl_coef': 0.1},
[36m(TaskRunner pid=2344)[0m                                  'ppo_epochs': 1,
[36m(TaskRunner pid=2344)[0m                                  'ppo_max_token_len_per_gpu': 30720,
[36m(TaskRunner pid=2344)[0m                                  'ppo_micro_batch_size': None,
[36m(TaskRunner pid=2344)[0m                                  'ppo_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=2344)[0m                                  'ppo_mini_batch_size': 32,
[36m(TaskRunner pid=2344)[0m                                  'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=2344)[0m                                               'all_ranks': False,
[36m(TaskRunner pid=2344)[0m                                               'enable': False,
[36m(TaskRunner pid=2344)[0m                                               'ranks': [],
[36m(TaskRunner pid=2344)[0m                                               'save_path': 'outputs/profile',
[36m(TaskRunner pid=2344)[0m                                               'tool': None,
[36m(TaskRunner pid=2344)[0m                                               'tool_config': {'npu': {'_target_': 'verl.utils.profiler.config.NPUToolConfig',
[36m(TaskRunner pid=2344)[0m                                                                       'analysis': True,
[36m(TaskRunner pid=2344)[0m                                                                       'contents': [],
[36m(TaskRunner pid=2344)[0m                                                                       'discrete': False,
[36m(TaskRunner pid=2344)[0m                                                                       'level': 'level0'},
[36m(TaskRunner pid=2344)[0m                                                               'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=2344)[0m                                                                        'discrete': False},
[36m(TaskRunner pid=2344)[0m                                                               'torch': {'_target_': 'verl.utils.profiler.config.TorchProfilerToolConfig',
[36m(TaskRunner pid=2344)[0m                                                                         'step_end': None,
[36m(TaskRunner pid=2344)[0m                                                                         'step_start': 0},
[36m(TaskRunner pid=2344)[0m                                                               'torch_memory': {'_target_': 'verl.utils.profiler.config.TorchMemoryToolConfig',
[36m(TaskRunner pid=2344)[0m                                                                                'stack_depth': 32,
[36m(TaskRunner pid=2344)[0m                                                                                'trace_alloc_max_entries': 100000}}},
[36m(TaskRunner pid=2344)[0m                                  'rollout_n': 16,
[36m(TaskRunner pid=2344)[0m                                  'router_replay': {'_target_': 'verl.workers.config.RouterReplayConfig',
[36m(TaskRunner pid=2344)[0m                                                    'mode': 'disabled',
[36m(TaskRunner pid=2344)[0m                                                    'record_file': None,
[36m(TaskRunner pid=2344)[0m                                                    'replay_file': None},
[36m(TaskRunner pid=2344)[0m                                  'shuffle': False,
[36m(TaskRunner pid=2344)[0m                                  'strategy': 'megatron',
[36m(TaskRunner pid=2344)[0m                                  'use_dynamic_bsz': True,
[36m(TaskRunner pid=2344)[0m                                  'use_fused_kernels': False,
[36m(TaskRunner pid=2344)[0m                                  'use_kl_loss': False,
[36m(TaskRunner pid=2344)[0m                                  'use_torch_compile': True},
[36m(TaskRunner pid=2344)[0m                        'hybrid_engine': True,
[36m(TaskRunner pid=2344)[0m                        'model': {'_target_': 'verl.workers.config.HFModelConfig',
[36m(TaskRunner pid=2344)[0m                                  'custom_chat_template': None,
[36m(TaskRunner pid=2344)[0m                                  'enable_activation_offload': False,
[36m(TaskRunner pid=2344)[0m                                  'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=2344)[0m                                  'exclude_modules': None,
[36m(TaskRunner pid=2344)[0m                                  'external_lib': None,
[36m(TaskRunner pid=2344)[0m                                  'fused_kernel_options': {'impl_backend': 'torch'},
[36m(TaskRunner pid=2344)[0m                                  'hf_config_path': None,
[36m(TaskRunner pid=2344)[0m                                  'lora': {'a2a_experimental': False,
[36m(TaskRunner pid=2344)[0m                                           'adapter_path': None,
[36m(TaskRunner pid=2344)[0m                                           'alpha': 32,
[36m(TaskRunner pid=2344)[0m                                           'dropout': 0.0,
[36m(TaskRunner pid=2344)[0m                                           'dropout_position': 'pre',
[36m(TaskRunner pid=2344)[0m                                           'dtype': None,
[36m(TaskRunner pid=2344)[0m                                           'exclude_modules': [],
[36m(TaskRunner pid=2344)[0m                                           'freeze_language_model': True,
[36m(TaskRunner pid=2344)[0m                                           'freeze_vision_model': True,
[36m(TaskRunner pid=2344)[0m                                           'freeze_vision_projection': True,
[36m(TaskRunner pid=2344)[0m                                           'lora_A_init_method': 'xavier',
[36m(TaskRunner pid=2344)[0m                                           'lora_B_init_method': 'zero',
[36m(TaskRunner pid=2344)[0m                                           'rank': 0,
[36m(TaskRunner pid=2344)[0m                                           'target_modules': ['linear_qkv',
[36m(TaskRunner pid=2344)[0m                                                              'linear_proj',
[36m(TaskRunner pid=2344)[0m                                                              'linear_fc1',
[36m(TaskRunner pid=2344)[0m                                                              'linear_fc2'],
[36m(TaskRunner pid=2344)[0m                                           'type': 'lora'},
[36m(TaskRunner pid=2344)[0m                                  'lora_adapter_path': None,
[36m(TaskRunner pid=2344)[0m                                  'lora_alpha': 16,
[36m(TaskRunner pid=2344)[0m                                  'lora_rank': 0,
[36m(TaskRunner pid=2344)[0m                                  'override_config': {'model_config': {},
[36m(TaskRunner pid=2344)[0m                                                      'moe_config': {'freeze_moe_router': False}},
[36m(TaskRunner pid=2344)[0m                                  'path': 'Qwen/Qwen3-30B-A3B-Base',
[36m(TaskRunner pid=2344)[0m                                  'target_modules': 'all-linear',
[36m(TaskRunner pid=2344)[0m                                  'tokenizer_path': None,
[36m(TaskRunner pid=2344)[0m                                  'trust_remote_code': False,
[36m(TaskRunner pid=2344)[0m                                  'use_fused_kernels': False,
[36m(TaskRunner pid=2344)[0m                                  'use_liger': False,
[36m(TaskRunner pid=2344)[0m                                  'use_remove_padding': True,
[36m(TaskRunner pid=2344)[0m                                  'use_shm': False},
[36m(TaskRunner pid=2344)[0m                        'nccl_timeout': 600,
[36m(TaskRunner pid=2344)[0m                        'ref': {'_target_': 'verl.workers.config.McoreActorConfig',
[36m(TaskRunner pid=2344)[0m                                'load_weight': True,
[36m(TaskRunner pid=2344)[0m                                'log_prob_max_token_len_per_gpu': 30720,
[36m(TaskRunner pid=2344)[0m                                'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=2344)[0m                                'log_prob_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=2344)[0m                                'log_prob_use_dynamic_bsz': True,
[36m(TaskRunner pid=2344)[0m                                'megatron': {'_target_': 'verl.workers.config.McoreEngineConfig',
[36m(TaskRunner pid=2344)[0m                                             'context_parallel_size': 1,
[36m(TaskRunner pid=2344)[0m                                             'dist_checkpointing_path': None,
[36m(TaskRunner pid=2344)[0m                                             'dist_checkpointing_prefix': '',
[36m(TaskRunner pid=2344)[0m                                             'dtype': 'bfloat16',
[36m(TaskRunner pid=2344)[0m                                             'expert_model_parallel_size': 1,
[36m(TaskRunner pid=2344)[0m                                             'expert_tensor_parallel_size': 1,
[36m(TaskRunner pid=2344)[0m                                             'forward_only': True,
[36m(TaskRunner pid=2344)[0m                                             'grad_offload': False,
[36m(TaskRunner pid=2344)[0m                                             'optimizer_offload': False,
[36m(TaskRunner pid=2344)[0m                                             'override_ddp_config': {},
[36m(TaskRunner pid=2344)[0m                                             'override_mcore_model_config': {},
[36m(TaskRunner pid=2344)[0m                                             'override_transformer_config': {'apply_rope_fusion': True,
[36m(TaskRunner pid=2344)[0m                                                                             'attention_backend': 'flash',
[36m(TaskRunner pid=2344)[0m                                                                             'gradient_accumulation_fusion': False,
[36m(TaskRunner pid=2344)[0m                                                                             'moe_permute_fusion': True,
[36m(TaskRunner pid=2344)[0m                                                                             'moe_router_dtype': 'fp32',
[36m(TaskRunner pid=2344)[0m                                                                             'recompute_granularity': 'full',
[36m(TaskRunner pid=2344)[0m                                                                             'recompute_method': 'uniform',
[36m(TaskRunner pid=2344)[0m                                                                             'recompute_modules': ['core_attn'],
[36m(TaskRunner pid=2344)[0m                                                                             'recompute_num_layers': 1},
[36m(TaskRunner pid=2344)[0m                                             'param_offload': True,
[36m(TaskRunner pid=2344)[0m                                             'pipeline_model_parallel_size': 1,
[36m(TaskRunner pid=2344)[0m                                             'seed': 42,
[36m(TaskRunner pid=2344)[0m                                             'sequence_parallel': True,
[36m(TaskRunner pid=2344)[0m                                             'tensor_model_parallel_size': 1,
[36m(TaskRunner pid=2344)[0m                                             'use_dist_checkpointing': False,
[36m(TaskRunner pid=2344)[0m                                             'use_distributed_optimizer': True,
[36m(TaskRunner pid=2344)[0m                                             'use_mbridge': True,
[36m(TaskRunner pid=2344)[0m                                             'use_remove_padding': True,
[36m(TaskRunner pid=2344)[0m                                             'vanilla_mbridge': True,
[36m(TaskRunner pid=2344)[0m                                             'virtual_pipeline_model_parallel_size': None},
[36m(TaskRunner pid=2344)[0m                                'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=2344)[0m                                             'all_ranks': False,
[36m(TaskRunner pid=2344)[0m                                             'enable': False,
[36m(TaskRunner pid=2344)[0m                                             'ranks': [],
[36m(TaskRunner pid=2344)[0m                                             'save_path': 'outputs/profile',
[36m(TaskRunner pid=2344)[0m                                             'tool': None,
[36m(TaskRunner pid=2344)[0m                                             'tool_config': {'npu': {'_target_': 'verl.utils.profiler.config.NPUToolConfig',
[36m(TaskRunner pid=2344)[0m                                                                     'analysis': True,
[36m(TaskRunner pid=2344)[0m                                                                     'contents': [],
[36m(TaskRunner pid=2344)[0m                                                                     'discrete': False,
[36m(TaskRunner pid=2344)[0m                                                                     'level': 'level0'},
[36m(TaskRunner pid=2344)[0m                                                             'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=2344)[0m                                                                      'discrete': False},
[36m(TaskRunner pid=2344)[0m                                                             'torch': {'_target_': 'verl.utils.profiler.config.TorchProfilerToolConfig',
[36m(TaskRunner pid=2344)[0m                                                                       'step_end': None,
[36m(TaskRunner pid=2344)[0m                                                                       'step_start': 0},
[36m(TaskRunner pid=2344)[0m                                                             'torch_memory': {'_target_': 'verl.utils.profiler.config.TorchMemoryToolConfig',
[36m(TaskRunner pid=2344)[0m                                                                              'stack_depth': 32,
[36m(TaskRunner pid=2344)[0m                                                                              'trace_alloc_max_entries': 100000}}},
[36m(TaskRunner pid=2344)[0m                                'rollout_n': 16,
[36m(TaskRunner pid=2344)[0m                                'router_replay': {'_target_': 'verl.workers.config.RouterReplayConfig',
[36m(TaskRunner pid=2344)[0m                                                  'mode': 'disabled',
[36m(TaskRunner pid=2344)[0m                                                  'record_file': None,
[36m(TaskRunner pid=2344)[0m                                                  'replay_file': None},
[36m(TaskRunner pid=2344)[0m                                'strategy': 'megatron',
[36m(TaskRunner pid=2344)[0m                                'use_torch_compile': True},
[36m(TaskRunner pid=2344)[0m                        'rollout': {'_target_': 'verl.workers.config.RolloutConfig',
[36m(TaskRunner pid=2344)[0m                                    'agent': {'_target_': 'verl.workers.config.AgentLoopConfig',
[36m(TaskRunner pid=2344)[0m                                              'agent_loop_config_path': None,
[36m(TaskRunner pid=2344)[0m                                              'custom_async_server': {'_target_': 'verl.workers.config.CustomAsyncServerConfig',
[36m(TaskRunner pid=2344)[0m                                                                      'name': None,
[36m(TaskRunner pid=2344)[0m                                                                      'path': None},
[36m(TaskRunner pid=2344)[0m                                              'default_agent_loop': 'single_turn_agent',
[36m(TaskRunner pid=2344)[0m                                              'num_workers': 8},
[36m(TaskRunner pid=2344)[0m                                    'calculate_log_probs': False,
[36m(TaskRunner pid=2344)[0m                                    'cudagraph_capture_sizes': None,
[36m(TaskRunner pid=2344)[0m                                    'data_parallel_size': 1,
[36m(TaskRunner pid=2344)[0m                                    'disable_log_stats': True,
[36m(TaskRunner pid=2344)[0m                                    'do_sample': True,
[36m(TaskRunner pid=2344)[0m                                    'dtype': 'bfloat16',
[36m(TaskRunner pid=2344)[0m                                    'enable_chunked_prefill': True,
[36m(TaskRunner pid=2344)[0m                                    'enable_prefix_caching': True,
[36m(TaskRunner pid=2344)[0m                                    'enable_rollout_routing_replay': False,
[36m(TaskRunner pid=2344)[0m                                    'enforce_eager': False,
[36m(TaskRunner pid=2344)[0m                                    'engine_kwargs': {'sglang': {}, 'vllm': {}},
[36m(TaskRunner pid=2344)[0m                                    'expert_parallel_size': 1,
[36m(TaskRunner pid=2344)[0m                                    'free_cache_engine': True,
[36m(TaskRunner pid=2344)[0m                                    'gpu_memory_utilization': 0.8,
[36m(TaskRunner pid=2344)[0m                                    'ignore_eos': False,
[36m(TaskRunner pid=2344)[0m                                    'layer_name_map': {'gate_proj_layer_name': 'gate_up',
[36m(TaskRunner pid=2344)[0m                                                       'qkv_layer_name': 'qkv'},
[36m(TaskRunner pid=2344)[0m                                    'load_format': 'dummy',
[36m(TaskRunner pid=2344)[0m                                    'log_prob_max_token_len_per_gpu': 30720,
[36m(TaskRunner pid=2344)[0m                                    'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=2344)[0m                                    'log_prob_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=2344)[0m                                    'log_prob_use_dynamic_bsz': True,
[36m(TaskRunner pid=2344)[0m                                    'max_model_len': None,
[36m(TaskRunner pid=2344)[0m                                    'max_num_batched_tokens': 8192,
[36m(TaskRunner pid=2344)[0m                                    'max_num_seqs': 1024,
[36m(TaskRunner pid=2344)[0m                                    'mode': 'async',
[36m(TaskRunner pid=2344)[0m                                    'multi_stage_wake_up': False,
[36m(TaskRunner pid=2344)[0m                                    'multi_turn': {'_target_': 'verl.workers.config.MultiTurnConfig',
[36m(TaskRunner pid=2344)[0m                                                   'enable': False,
[36m(TaskRunner pid=2344)[0m                                                   'format': 'hermes',
[36m(TaskRunner pid=2344)[0m                                                   'interaction_config_path': None,
[36m(TaskRunner pid=2344)[0m                                                   'max_assistant_turns': None,
[36m(TaskRunner pid=2344)[0m                                                   'max_parallel_calls': 1,
[36m(TaskRunner pid=2344)[0m                                                   'max_tool_response_length': 256,
[36m(TaskRunner pid=2344)[0m                                                   'max_user_turns': None,
[36m(TaskRunner pid=2344)[0m                                                   'num_repeat_rollouts': None,
[36m(TaskRunner pid=2344)[0m                                                   'tokenization_sanity_check_mode': 'strict',
[36m(TaskRunner pid=2344)[0m                                                   'tool_config_path': None,
[36m(TaskRunner pid=2344)[0m                                                   'tool_response_truncate_side': 'middle',
[36m(TaskRunner pid=2344)[0m                                                   'use_inference_chat_template': False},
[36m(TaskRunner pid=2344)[0m                                    'n': 16,
[36m(TaskRunner pid=2344)[0m                                    'name': 'vllm',
[36m(TaskRunner pid=2344)[0m                                    'over_sample_rate': 0,
[36m(TaskRunner pid=2344)[0m                                    'pipeline_model_parallel_size': 1,
[36m(TaskRunner pid=2344)[0m                                    'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=2344)[0m                                                 'all_ranks': False,
[36m(TaskRunner pid=2344)[0m                                                 'enable': False,
[36m(TaskRunner pid=2344)[0m                                                 'ranks': [],
[36m(TaskRunner pid=2344)[0m                                                 'save_path': 'outputs/profile',
[36m(TaskRunner pid=2344)[0m                                                 'tool': None,
[36m(TaskRunner pid=2344)[0m                                                 'tool_config': {'npu': {'_target_': 'verl.utils.profiler.config.NPUToolConfig',
[36m(TaskRunner pid=2344)[0m                                                                         'analysis': True,
[36m(TaskRunner pid=2344)[0m                                                                         'contents': [],
[36m(TaskRunner pid=2344)[0m                                                                         'discrete': False,
[36m(TaskRunner pid=2344)[0m                                                                         'level': 'level0'},
[36m(TaskRunner pid=2344)[0m                                                                 'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=2344)[0m                                                                          'discrete': False},
[36m(TaskRunner pid=2344)[0m                                                                 'torch': {'_target_': 'verl.utils.profiler.config.TorchProfilerToolConfig',
[36m(TaskRunner pid=2344)[0m                                                                           'step_end': None,
[36m(TaskRunner pid=2344)[0m                                                                           'step_start': 0},
[36m(TaskRunner pid=2344)[0m                                                                 'torch_memory': {'_target_': 'verl.utils.profiler.config.TorchMemoryToolConfig',
[36m(TaskRunner pid=2344)[0m                                                                                  'stack_depth': 32,
[36m(TaskRunner pid=2344)[0m                                                                                  'trace_alloc_max_entries': 100000}}},
[36m(TaskRunner pid=2344)[0m                                    'prometheus': {'_target_': 'verl.workers.config.PrometheusConfig',
[36m(TaskRunner pid=2344)[0m                                                   'enable': False,
[36m(TaskRunner pid=2344)[0m                                                   'file': '/tmp/ray/session_latest/metrics/prometheus/prometheus.yml',
[36m(TaskRunner pid=2344)[0m                                                   'port': 9090,
[36m(TaskRunner pid=2344)[0m                                                   'served_model_name': 'Qwen/Qwen3-30B-A3B-Base'},
[36m(TaskRunner pid=2344)[0m                                    'prompt_length': 2048,
[36m(TaskRunner pid=2344)[0m                                    'quantization': None,
[36m(TaskRunner pid=2344)[0m                                    'quantization_config_file': None,
[36m(TaskRunner pid=2344)[0m                                    'response_length': 8192,
[36m(TaskRunner pid=2344)[0m                                    'skip_dump_dir': '/tmp/rollout_dump',
[36m(TaskRunner pid=2344)[0m                                    'skip_rollout': False,
[36m(TaskRunner pid=2344)[0m                                    'skip_tokenizer_init': True,
[36m(TaskRunner pid=2344)[0m                                    'temperature': 1.0,
[36m(TaskRunner pid=2344)[0m                                    'tensor_model_parallel_size': 1,
[36m(TaskRunner pid=2344)[0m                                    'top_k': -1,
[36m(TaskRunner pid=2344)[0m                                    'top_p': 1,
[36m(TaskRunner pid=2344)[0m                                    'trace': {'_target_': 'verl.workers.config.TraceConfig',
[36m(TaskRunner pid=2344)[0m                                              'backend': None,
[36m(TaskRunner pid=2344)[0m                                              'max_samples_per_step_per_worker': None,
[36m(TaskRunner pid=2344)[0m                                              'token2text': False},
[36m(TaskRunner pid=2344)[0m                                    'update_weights_bucket_megabytes': 512,
[36m(TaskRunner pid=2344)[0m                                    'val_kwargs': {'_target_': 'verl.workers.config.SamplingConfig',
[36m(TaskRunner pid=2344)[0m                                                   'do_sample': False,
[36m(TaskRunner pid=2344)[0m                                                   'n': 1,
[36m(TaskRunner pid=2344)[0m                                                   'temperature': 1.0,
[36m(TaskRunner pid=2344)[0m                                                   'top_k': -1,
[36m(TaskRunner pid=2344)[0m                                                   'top_p': 0.7}}},
[36m(TaskRunner pid=2344)[0m  'algorithm': {'_target_': 'verl.trainer.config.AlgoConfig',
[36m(TaskRunner pid=2344)[0m                'adv_estimator': 'grpo',
[36m(TaskRunner pid=2344)[0m                'gamma': 1.0,
[36m(TaskRunner pid=2344)[0m                'kl_ctrl': {'_target_': 'verl.trainer.config.KLControlConfig',
[36m(TaskRunner pid=2344)[0m                            'horizon': 10000,
[36m(TaskRunner pid=2344)[0m                            'kl_coef': 0.001,
[36m(TaskRunner pid=2344)[0m                            'target_kl': 0.1,
[36m(TaskRunner pid=2344)[0m                            'type': 'fixed'},
[36m(TaskRunner pid=2344)[0m                'kl_penalty': 'kl',
[36m(TaskRunner pid=2344)[0m                'lam': 0.95,
[36m(TaskRunner pid=2344)[0m                'norm_adv_by_std_in_grpo': True,
[36m(TaskRunner pid=2344)[0m                'pf_ppo': {'reweight_method': 'pow', 'weight_pow': 2.0},
[36m(TaskRunner pid=2344)[0m                'rollout_correction': {'bypass_mode': False,
[36m(TaskRunner pid=2344)[0m                                       'loss_type': 'ppo_clip',
[36m(TaskRunner pid=2344)[0m                                       'rollout_is': None,
[36m(TaskRunner pid=2344)[0m                                       'rollout_is_batch_normalize': False,
[36m(TaskRunner pid=2344)[0m                                       'rollout_is_threshold': 2.0,
[36m(TaskRunner pid=2344)[0m                                       'rollout_rs': None,
[36m(TaskRunner pid=2344)[0m                                       'rollout_rs_threshold': None,
[36m(TaskRunner pid=2344)[0m                                       'rollout_rs_threshold_lower': None,
[36m(TaskRunner pid=2344)[0m                                       'rollout_token_veto_threshold': None},
[36m(TaskRunner pid=2344)[0m                'use_kl_in_reward': False,
[36m(TaskRunner pid=2344)[0m                'use_pf_ppo': False},
[36m(TaskRunner pid=2344)[0m  'critic': {'_target_': 'verl.workers.config.McoreCriticConfig',
[36m(TaskRunner pid=2344)[0m             'checkpoint': {'_target_': 'verl.trainer.config.CheckpointConfig',
[36m(TaskRunner pid=2344)[0m                            'async_save': False,
[36m(TaskRunner pid=2344)[0m                            'load_contents': ['model', 'optimizer', 'extra'],
[36m(TaskRunner pid=2344)[0m                            'save_contents': ['model', 'optimizer', 'extra']},
[36m(TaskRunner pid=2344)[0m             'cliprange_value': 0.5,
[36m(TaskRunner pid=2344)[0m             'data_loader_seed': 42,
[36m(TaskRunner pid=2344)[0m             'enable': None,
[36m(TaskRunner pid=2344)[0m             'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=2344)[0m             'load_weight': True,
[36m(TaskRunner pid=2344)[0m             'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=2344)[0m             'megatron': {'_target_': 'verl.workers.config.McoreEngineConfig',
[36m(TaskRunner pid=2344)[0m                          'context_parallel_size': 1,
[36m(TaskRunner pid=2344)[0m                          'dist_checkpointing_path': None,
[36m(TaskRunner pid=2344)[0m                          'dist_checkpointing_prefix': '',
[36m(TaskRunner pid=2344)[0m                          'dtype': 'bfloat16',
[36m(TaskRunner pid=2344)[0m                          'expert_model_parallel_size': 1,
[36m(TaskRunner pid=2344)[0m                          'expert_tensor_parallel_size': None,
[36m(TaskRunner pid=2344)[0m                          'forward_only': False,
[36m(TaskRunner pid=2344)[0m                          'grad_offload': False,
[36m(TaskRunner pid=2344)[0m                          'optimizer_offload': False,
[36m(TaskRunner pid=2344)[0m                          'override_ddp_config': {},
[36m(TaskRunner pid=2344)[0m                          'override_mcore_model_config': {},
[36m(TaskRunner pid=2344)[0m                          'override_transformer_config': {'attention_backend': 'flash',
[36m(TaskRunner pid=2344)[0m                                                          'recompute_granularity': None,
[36m(TaskRunner pid=2344)[0m                                                          'recompute_method': None,
[36m(TaskRunner pid=2344)[0m                                                          'recompute_modules': ['core_attn'],
[36m(TaskRunner pid=2344)[0m                                                          'recompute_num_layers': None},
[36m(TaskRunner pid=2344)[0m                          'param_offload': False,
[36m(TaskRunner pid=2344)[0m                          'pipeline_model_parallel_size': 1,
[36m(TaskRunner pid=2344)[0m                          'seed': 42,
[36m(TaskRunner pid=2344)[0m                          'sequence_parallel': True,
[36m(TaskRunner pid=2344)[0m                          'tensor_model_parallel_size': 1,
[36m(TaskRunner pid=2344)[0m                          'use_dist_checkpointing': False,
[36m(TaskRunner pid=2344)[0m                          'use_distributed_optimizer': True,
[36m(TaskRunner pid=2344)[0m                          'use_mbridge': True,
[36m(TaskRunner pid=2344)[0m                          'use_remove_padding': True,
[36m(TaskRunner pid=2344)[0m                          'vanilla_mbridge': True,
[36m(TaskRunner pid=2344)[0m                          'virtual_pipeline_model_parallel_size': None},
[36m(TaskRunner pid=2344)[0m             'model': {'_target_': 'verl.trainer.config.BaseModelConfig',
[36m(TaskRunner pid=2344)[0m                       'external_lib': None,
[36m(TaskRunner pid=2344)[0m                       'lora': {'a2a_experimental': False,
[36m(TaskRunner pid=2344)[0m                                'adapter_path': None,
[36m(TaskRunner pid=2344)[0m                                'alpha': 32,
[36m(TaskRunner pid=2344)[0m                                'dropout': 0.0,
[36m(TaskRunner pid=2344)[0m                                'dropout_position': 'pre',
[36m(TaskRunner pid=2344)[0m                                'dtype': None,
[36m(TaskRunner pid=2344)[0m                                'exclude_modules': [],
[36m(TaskRunner pid=2344)[0m                                'freeze_language_model': True,
[36m(TaskRunner pid=2344)[0m                                'freeze_vision_model': True,
[36m(TaskRunner pid=2344)[0m                                'freeze_vision_projection': True,
[36m(TaskRunner pid=2344)[0m                                'lora_A_init_method': 'xavier',
[36m(TaskRunner pid=2344)[0m                                'lora_B_init_method': 'zero',
[36m(TaskRunner pid=2344)[0m                                'rank': 0,
[36m(TaskRunner pid=2344)[0m                                'target_modules': ['linear_qkv',
[36m(TaskRunner pid=2344)[0m                                                   'linear_proj',
[36m(TaskRunner pid=2344)[0m                                                   'linear_fc1',
[36m(TaskRunner pid=2344)[0m                                                   'linear_fc2'],
[36m(TaskRunner pid=2344)[0m                                'type': 'lora'},
[36m(TaskRunner pid=2344)[0m                       'override_config': {'model_config': {},
[36m(TaskRunner pid=2344)[0m                                           'moe_config': {'freeze_moe_router': False}},
[36m(TaskRunner pid=2344)[0m                       'path': '~/models/deepseek-llm-7b-chat',
[36m(TaskRunner pid=2344)[0m                       'tokenizer_path': 'Qwen/Qwen3-30B-A3B-Base',
[36m(TaskRunner pid=2344)[0m                       'trust_remote_code': False},
[36m(TaskRunner pid=2344)[0m             'nccl_timeout': 600,
[36m(TaskRunner pid=2344)[0m             'optim': {'_target_': 'verl.workers.config.McoreOptimizerConfig',
[36m(TaskRunner pid=2344)[0m                       'betas': [0.9, 0.999],
[36m(TaskRunner pid=2344)[0m                       'clip_grad': 1.0,
[36m(TaskRunner pid=2344)[0m                       'lr': 1e-05,
[36m(TaskRunner pid=2344)[0m                       'lr_decay_steps': None,
[36m(TaskRunner pid=2344)[0m                       'lr_decay_style': 'constant',
[36m(TaskRunner pid=2344)[0m                       'lr_warmup_init': 0.0,
[36m(TaskRunner pid=2344)[0m                       'lr_warmup_steps': -1,
[36m(TaskRunner pid=2344)[0m                       'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=2344)[0m                       'lr_wsd_decay_steps': None,
[36m(TaskRunner pid=2344)[0m                       'lr_wsd_decay_style': 'exponential',
[36m(TaskRunner pid=2344)[0m                       'min_lr': 0.0,
[36m(TaskRunner pid=2344)[0m                       'optimizer': 'adam',
[36m(TaskRunner pid=2344)[0m                       'override_optimizer_config': {},
[36m(TaskRunner pid=2344)[0m                       'total_training_steps': -1,
[36m(TaskRunner pid=2344)[0m                       'use_checkpoint_opt_param_scheduler': False,
[36m(TaskRunner pid=2344)[0m                       'weight_decay': 0.01,
[36m(TaskRunner pid=2344)[0m                       'weight_decay_incr_style': 'constant'},
[36m(TaskRunner pid=2344)[0m             'ppo_epochs': 1,
[36m(TaskRunner pid=2344)[0m             'ppo_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=2344)[0m             'ppo_micro_batch_size': None,
[36m(TaskRunner pid=2344)[0m             'ppo_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=2344)[0m             'ppo_mini_batch_size': 32,
[36m(TaskRunner pid=2344)[0m             'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=2344)[0m                          'all_ranks': False,
[36m(TaskRunner pid=2344)[0m                          'enable': False,
[36m(TaskRunner pid=2344)[0m                          'ranks': [],
[36m(TaskRunner pid=2344)[0m                          'save_path': 'outputs/profile',
[36m(TaskRunner pid=2344)[0m                          'tool': None,
[36m(TaskRunner pid=2344)[0m                          'tool_config': {'npu': {'_target_': 'verl.utils.profiler.config.NPUToolConfig',
[36m(TaskRunner pid=2344)[0m                                                  'analysis': True,
[36m(TaskRunner pid=2344)[0m                                                  'contents': [],
[36m(TaskRunner pid=2344)[0m                                                  'discrete': False,
[36m(TaskRunner pid=2344)[0m                                                  'level': 'level0'},
[36m(TaskRunner pid=2344)[0m                                          'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=2344)[0m                                                   'discrete': False},
[36m(TaskRunner pid=2344)[0m                                          'torch': {'_target_': 'verl.utils.profiler.config.TorchProfilerToolConfig',
[36m(TaskRunner pid=2344)[0m                                                    'step_end': None,
[36m(TaskRunner pid=2344)[0m                                                    'step_start': 0},
[36m(TaskRunner pid=2344)[0m                                          'torch_memory': {'_target_': 'verl.utils.profiler.config.TorchMemoryToolConfig',
[36m(TaskRunner pid=2344)[0m                                                           'stack_depth': 32,
[36m(TaskRunner pid=2344)[0m                                                           'trace_alloc_max_entries': 100000}}},
[36m(TaskRunner pid=2344)[0m             'rollout_n': 16,
[36m(TaskRunner pid=2344)[0m             'shuffle': False,
[36m(TaskRunner pid=2344)[0m             'strategy': 'megatron',
[36m(TaskRunner pid=2344)[0m             'use_dynamic_bsz': True},
[36m(TaskRunner pid=2344)[0m  'custom_reward_function': {'name': 'compute_score', 'path': None},
[36m(TaskRunner pid=2344)[0m  'data': {'apply_chat_template_kwargs': {},
[36m(TaskRunner pid=2344)[0m           'custom_cls': {'name': None, 'path': None},
[36m(TaskRunner pid=2344)[0m           'datagen': {'name': None, 'path': None},
[36m(TaskRunner pid=2344)[0m           'dataloader_num_workers': 8,
[36m(TaskRunner pid=2344)[0m           'filter_overlong_prompts': True,
[36m(TaskRunner pid=2344)[0m           'filter_overlong_prompts_workers': 64,
[36m(TaskRunner pid=2344)[0m           'image_key': 'images',
[36m(TaskRunner pid=2344)[0m           'image_patch_size': 14,
[36m(TaskRunner pid=2344)[0m           'max_prompt_length': 2048,
[36m(TaskRunner pid=2344)[0m           'max_response_length': 8192,
[36m(TaskRunner pid=2344)[0m           'prompt_key': 'prompt',
[36m(TaskRunner pid=2344)[0m           'return_full_prompt': False,
[36m(TaskRunner pid=2344)[0m           'return_multi_modal_inputs': True,
[36m(TaskRunner pid=2344)[0m           'return_raw_chat': True,
[36m(TaskRunner pid=2344)[0m           'return_raw_input_ids': False,
[36m(TaskRunner pid=2344)[0m           'reward_fn_key': 'data_source',
[36m(TaskRunner pid=2344)[0m           'sampler': {'class_name': None, 'class_path': None},
[36m(TaskRunner pid=2344)[0m           'seed': None,
[36m(TaskRunner pid=2344)[0m           'shuffle': True,
[36m(TaskRunner pid=2344)[0m           'tokenizer': None,
[36m(TaskRunner pid=2344)[0m           'tool_config_path': None,
[36m(TaskRunner pid=2344)[0m           'train_batch_size': 256,
[36m(TaskRunner pid=2344)[0m           'train_files': 'hf://datasets/BytedTsinghua-SIA/DAPO-Math-17k/data/dapo-math-17k.parquet',
[36m(TaskRunner pid=2344)[0m           'train_max_samples': -1,
[36m(TaskRunner pid=2344)[0m           'truncation': 'error',
[36m(TaskRunner pid=2344)[0m           'trust_remote_code': False,
[36m(TaskRunner pid=2344)[0m           'use_shm': False,
[36m(TaskRunner pid=2344)[0m           'val_batch_size': None,
[36m(TaskRunner pid=2344)[0m           'val_files': 'hf://datasets/BytedTsinghua-SIA/AIME-2024/data/aime-2024.parquet',
[36m(TaskRunner pid=2344)[0m           'val_max_samples': -1,
[36m(TaskRunner pid=2344)[0m           'validation_shuffle': False,
[36m(TaskRunner pid=2344)[0m           'video_key': 'videos'},
[36m(TaskRunner pid=2344)[0m  'global_profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=2344)[0m                      'global_tool_config': {'nsys': {'controller_nsight_options': {'cuda-graph-trace': 'graph',
[36m(TaskRunner pid=2344)[0m                                                                                    'cuda-memory-usage': 'true',
[36m(TaskRunner pid=2344)[0m                                                                                    'trace': 'cuda,nvtx,cublas,ucx'},
[36m(TaskRunner pid=2344)[0m                                                      'discrete': False,
[36m(TaskRunner pid=2344)[0m                                                      'worker_nsight_options': {'capture-range': 'cudaProfilerApi',
[36m(TaskRunner pid=2344)[0m                                                                                'capture-range-end': None,
[36m(TaskRunner pid=2344)[0m                                                                                'cuda-graph-trace': 'graph',
[36m(TaskRunner pid=2344)[0m                                                                                'cuda-memory-usage': 'true',
[36m(TaskRunner pid=2344)[0m                                                                                'kill': 'none',
[36m(TaskRunner pid=2344)[0m                                                                                'trace': 'cuda,nvtx,cublas,ucx'}},
[36m(TaskRunner pid=2344)[0m                                             'torch_memory': {'context': 'all',
[36m(TaskRunner pid=2344)[0m                                                              'kw_args': {},
[36m(TaskRunner pid=2344)[0m                                                              'stack_depth': 32,
[36m(TaskRunner pid=2344)[0m                                                              'stacks': 'all',
[36m(TaskRunner pid=2344)[0m                                                              'trace_alloc_max_entries': 100000}},
[36m(TaskRunner pid=2344)[0m                      'profile_continuous_steps': False,
[36m(TaskRunner pid=2344)[0m                      'save_path': 'outputs/profile',
[36m(TaskRunner pid=2344)[0m                      'steps': None,
[36m(TaskRunner pid=2344)[0m                      'tool': None},
[36m(TaskRunner pid=2344)[0m  'ray_kwargs': {'ray_init': {'num_cpus': None}, 'timeline_json_file': None},
[36m(TaskRunner pid=2344)[0m  'reward_manager': {'_target_': 'verl.trainer.config.config.RewardManagerConfig',
[36m(TaskRunner pid=2344)[0m                     'module': {'_target_': 'verl.trainer.config.config.ModuleConfig',
[36m(TaskRunner pid=2344)[0m                                'name': 'custom_reward_manager',
[36m(TaskRunner pid=2344)[0m                                'path': None},
[36m(TaskRunner pid=2344)[0m                     'name': 'dapo',
[36m(TaskRunner pid=2344)[0m                     'source': 'register'},
[36m(TaskRunner pid=2344)[0m  'reward_model': {'enable': False,
[36m(TaskRunner pid=2344)[0m                   'enable_resource_pool': False,
[36m(TaskRunner pid=2344)[0m                   'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=2344)[0m                   'launch_reward_fn_async': False,
[36m(TaskRunner pid=2344)[0m                   'load_weight': True,
[36m(TaskRunner pid=2344)[0m                   'max_length': None,
[36m(TaskRunner pid=2344)[0m                   'megatron': {'_target_': 'verl.workers.config.MegatronEngineConfig',
[36m(TaskRunner pid=2344)[0m                                'context_parallel_size': 1,
[36m(TaskRunner pid=2344)[0m                                'dist_checkpointing_path': None,
[36m(TaskRunner pid=2344)[0m                                'dist_checkpointing_prefix': '',
[36m(TaskRunner pid=2344)[0m                                'dtype': 'bfloat16',
[36m(TaskRunner pid=2344)[0m                                'expert_model_parallel_size': 1,
[36m(TaskRunner pid=2344)[0m                                'expert_tensor_parallel_size': None,
[36m(TaskRunner pid=2344)[0m                                'override_transformer_config': {'apply_rope_fusion': True,
[36m(TaskRunner pid=2344)[0m                                                                'attention_backend': 'flash',
[36m(TaskRunner pid=2344)[0m                                                                'gradient_accumulation_fusion': False,
[36m(TaskRunner pid=2344)[0m                                                                'moe_permute_fusion': True,
[36m(TaskRunner pid=2344)[0m                                                                'moe_router_dtype': 'fp32',
[36m(TaskRunner pid=2344)[0m                                                                'recompute_granularity': 'full',
[36m(TaskRunner pid=2344)[0m                                                                'recompute_method': 'uniform',
[36m(TaskRunner pid=2344)[0m                                                                'recompute_modules': ['core_attn'],
[36m(TaskRunner pid=2344)[0m                                                                'recompute_num_layers': 1},
[36m(TaskRunner pid=2344)[0m                                'param_offload': False,
[36m(TaskRunner pid=2344)[0m                                'pipeline_model_parallel_size': 1,
[36m(TaskRunner pid=2344)[0m                                'seed': 42,
[36m(TaskRunner pid=2344)[0m                                'sequence_parallel': True,
[36m(TaskRunner pid=2344)[0m                                'tensor_model_parallel_size': 1,
[36m(TaskRunner pid=2344)[0m                                'use_dist_checkpointing': False,
[36m(TaskRunner pid=2344)[0m                                'use_distributed_optimizer': False,
[36m(TaskRunner pid=2344)[0m                                'use_mbridge': True,
[36m(TaskRunner pid=2344)[0m                                'use_remove_padding': True,
[36m(TaskRunner pid=2344)[0m                                'vanilla_mbridge': True,
[36m(TaskRunner pid=2344)[0m                                'virtual_pipeline_model_parallel_size': None},
[36m(TaskRunner pid=2344)[0m                   'micro_batch_size': None,
[36m(TaskRunner pid=2344)[0m                   'micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=2344)[0m                   'model': {'external_lib': None,
[36m(TaskRunner pid=2344)[0m                             'input_tokenizer': 'Qwen/Qwen3-30B-A3B-Base',
[36m(TaskRunner pid=2344)[0m                             'override_config': {},
[36m(TaskRunner pid=2344)[0m                             'path': '~/models/FsfairX-LLaMA3-RM-v0.1',
[36m(TaskRunner pid=2344)[0m                             'trust_remote_code': False},
[36m(TaskRunner pid=2344)[0m                   'n_gpus_per_node': 8,
[36m(TaskRunner pid=2344)[0m                   'nccl_timeout': 600,
[36m(TaskRunner pid=2344)[0m                   'nnodes': 0,
[36m(TaskRunner pid=2344)[0m                   'num_workers': 1,
[36m(TaskRunner pid=2344)[0m                   'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=2344)[0m                                'all_ranks': False,
[36m(TaskRunner pid=2344)[0m                                'enable': False,
[36m(TaskRunner pid=2344)[0m                                'ranks': [],
[36m(TaskRunner pid=2344)[0m                                'save_path': 'outputs/profile',
[36m(TaskRunner pid=2344)[0m                                'tool': None,
[36m(TaskRunner pid=2344)[0m                                'tool_config': {'npu': {'_target_': 'verl.utils.profiler.config.NPUToolConfig',
[36m(TaskRunner pid=2344)[0m                                                        'analysis': True,
[36m(TaskRunner pid=2344)[0m                                                        'contents': [],
[36m(TaskRunner pid=2344)[0m                                                        'discrete': False,
[36m(TaskRunner pid=2344)[0m                                                        'level': 'level0'},
[36m(TaskRunner pid=2344)[0m                                                'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=2344)[0m                                                         'discrete': False},
[36m(TaskRunner pid=2344)[0m                                                'torch': {'_target_': 'verl.utils.profiler.config.TorchProfilerToolConfig',
[36m(TaskRunner pid=2344)[0m                                                          'step_end': None,
[36m(TaskRunner pid=2344)[0m                                                          'step_start': 0},[36m(TaskRunner pid=2344)[0m <string>:35: UserWarning: set sequence parallel to false as TP size is 1
[36m(TaskRunner pid=2344)[0m /workspace/verl/verl/verl/utils/profiler/config.py:49: UserWarning: Torch profiler tool config is not fully supported now.
[36m(TaskRunner pid=2344)[0m   warnings.warn("Torch profiler tool config is not fully supported now.", stacklevel=1)
[36m(TaskRunner pid=2344)[0m Generating train split: 0 examples [00:00, ? examples/s]
[36m(TaskRunner pid=2344)[0m Generating train split: 1048576 examples [00:02, 418246.91 examples/s]
[36m(TaskRunner pid=2344)[0m Generating train split: 1791700 examples [00:02, 720586.94 examples/s]Generating train split: 1791700 examples [00:02, 635731.24 examples/s]
[36m(TaskRunner pid=2344)[0m Setting TOKENIZERS_PARALLELISM=false for forked processes.
[36m(TaskRunner pid=2344)[0m WARNING:2025-12-24 04:55:38,539:Setting TOKENIZERS_PARALLELISM=false for forked processes.
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):   0%|          | 0/1791700 [00:00<?, ? examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):   0%|          | 1000/1791700 [00:00<27:32, 1083.64 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):   0%|          | 2000/1791700 [00:01<15:12, 1961.02 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):   0%|          | 5000/1791700 [00:01<05:27, 5448.86 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):   0%|          | 7000/1791700 [00:01<04:09, 7140.79 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):   1%|          | 10000/1791700 [00:01<02:43, 10883.11 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):   1%|          | 13000/1791700 [00:01<02:02, 14492.51 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):   1%|          | 16000/1791700 [00:01<01:44, 17000.08 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):   1%|          | 19000/1791700 [00:01<01:29, 19839.22 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):   1%|▏         | 23000/1791700 [00:02<01:12, 24271.59 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):   1%|▏         | 26000/1791700 [00:02<01:08, 25606.73 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):   2%|▏         | 29000/1791700 [00:02<01:08, 25713.57 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):   2%|▏         | 36000/1791700 [00:02<00:49, 35797.02 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):   2%|▏         | 40000/1791700 [00:02<00:48, 36245.11 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):   2%|▏         | 44000/1791700 [00:02<00:50, 34630.98 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):   3%|▎         | 52000/1791700 [00:02<00:37, 46608.88 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):   3%|▎         | 58000/1791700 [00:02<00:36, 46945.36 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):   4%|▎         | 67000/1791700 [00:02<00:30, 56892.63 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):   4%|▍         | 73000/1791700 [00:03<00:31, 54382.42 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):   4%|▍         | 79000/1791700 [00:03<00:32, 52344.85 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):   5%|▍         | 87000/1791700 [00:03<00:28, 59000.51 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):   5%|▌         | 95000/1791700 [00:03<00:29, 57247.54 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):   6%|▌         | 102000/1791700 [00:03<00:27, 60502.97 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):   6%|▋         | 115000/1791700 [00:03<00:21, 76627.16 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):   7%|▋         | 123000/1791700 [00:03<00:24, 69303.49 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):   7%|▋         | 131000/1791700 [00:03<00:25, 66381.28 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):   8%|▊         | 142000/1791700 [00:04<00:24, 68606.27 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):   8%|▊         | 149000/1791700 [00:04<00:23, 68525.75 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):   9%|▉         | 158000/1791700 [00:04<00:22, 73345.59 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):   9%|▉         | 166000/1791700 [00:04<00:23, 68100.40 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  10%|▉         | 174000/1791700 [00:04<00:24, 65851.45 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  10%|█         | 185000/1791700 [00:04<00:21, 74059.82 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  11%|█         | 193000/1791700 [00:04<00:22, 69950.16 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  11%|█▏        | 202000/1791700 [00:04<00:22, 71610.33 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  12%|█▏        | 210000/1791700 [00:05<00:23, 67639.74 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  12%|█▏        | 220000/1791700 [00:05<00:22, 70183.58 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  13%|█▎        | 229000/1791700 [00:05<00:22, 68784.45 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  13%|█▎        | 237000/1791700 [00:05<00:21, 70700.05 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  14%|█▎        | 246000/1791700 [00:05<00:20, 75471.43 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  14%|█▍        | 254000/1791700 [00:05<00:24, 62154.59 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  15%|█▍        | 265000/1791700 [00:05<00:21, 72040.64 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  15%|█▌        | 275000/1791700 [00:05<00:23, 65443.18 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  16%|█▌        | 286000/1791700 [00:06<00:20, 74645.80 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  17%|█▋        | 297000/1791700 [00:06<00:18, 82325.07 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  17%|█▋        | 306000/1791700 [00:06<00:21, 67694.31 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  18%|█▊        | 317000/1791700 [00:06<00:19, 76008.92 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  18%|█▊        | 326000/1791700 [00:06<00:21, 68232.55 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  19%|█▉        | 336000/1791700 [00:06<00:19, 74818.19 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  19%|█▉        | 345000/1791700 [00:06<00:18, 77756.88 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  20%|█▉        | 354000/1791700 [00:07<00:20, 68491.29 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  20%|██        | 362000/1791700 [00:07<00:20, 69392.36 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  21%|██        | 371000/1791700 [00:07<00:19, 71216.61 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  21%|██        | 380000/1791700 [00:07<00:19, 73773.10 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  22%|██▏       | 388000/1791700 [00:07<00:19, 73186.60 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  22%|██▏       | 396000/1791700 [00:07<00:19, 73339.71 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  23%|██▎       | 404000/1791700 [00:07<00:19, 69867.10 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  23%|██▎       | 412000/1791700 [00:07<00:20, 67551.80 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  23%|██▎       | 419000/1791700 [00:07<00:20, 66777.58 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  24%|██▍       | 429000/1791700 [00:08<00:18, 74868.20 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  24%|██▍       | 437000/1791700 [00:08<00:19, 70347.12 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  25%|██▍       | 446000/1791700 [00:08<00:17, 75297.87 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  25%|██▌       | 455000/1791700 [00:08<00:17, 74418.46 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  26%|██▌       | 463000/1791700 [00:08<00:19, 68986.69 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  26%|██▋       | 474000/1791700 [00:08<00:16, 77610.36 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  27%|██▋       | 482000/1791700 [00:08<00:18, 71317.04 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  27%|██▋       | 490000/1791700 [00:08<00:18, 70804.81 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  28%|██▊       | 500000/1791700 [00:09<00:17, 73636.59 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  28%|██▊       | 508000/1791700 [00:09<00:18, 67702.88 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  29%|██▉       | 519000/1791700 [00:09<00:16, 75748.29 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  29%|██▉       | 527000/1791700 [00:09<00:19, 65820.28 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  30%|██▉       | 537000/1791700 [00:09<00:17, 71897.87 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  31%|███       | 548000/1791700 [00:09<00:16, 76451.14 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  31%|███       | 556000/1791700 [00:09<00:17, 69661.66 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  31%|███▏      | 564000/1791700 [00:09<00:17, 72181.34 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  32%|███▏      | 572000/1791700 [00:10<00:17, 70735.09 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  32%|███▏      | 580000/1791700 [00:10<00:17, 70560.06 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  33%|███▎      | 590000/1791700 [00:10<00:15, 78317.24 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  33%|███▎      | 599000/1791700 [00:10<00:17, 68899.74 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  34%|███▍      | 607000/1791700 [00:10<00:17, 68919.71 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  34%|███▍      | 617000/1791700 [00:10<00:15, 74517.48 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  35%|███▍      | 625000/1791700 [00:10<00:16, 70101.66 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  35%|███▌      | 633000/1791700 [00:10<00:16, 71208.66 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  36%|███▌      | 642000/1791700 [00:11<00:16, 68895.99 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  36%|███▋      | 650000/1791700 [00:11<00:16, 70114.94 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  37%|███▋      | 661000/1791700 [00:11<00:16, 69771.71 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  37%|███▋      | 670000/1791700 [00:11<00:15, 72630.72 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  38%|███▊      | 678000/1791700 [00:11<00:16, 68455.38 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  38%|███▊      | 685000/1791700 [00:11<00:16, 68431.40 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  39%|███▉      | 695000/1791700 [00:11<00:16, 66428.37 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  39%|███▉      | 706000/1791700 [00:11<00:15, 70840.49 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  40%|███▉      | 715000/1791700 [00:12<00:15, 68203.72 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  40%|████      | 722000/1791700 [00:12<00:16, 66728.74 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  41%|████      | 730000/1791700 [00:12<00:15, 68558.89 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  41%|████      | 737000/1791700 [00:12<00:16, 63303.33 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  42%|████▏     | 747000/1791700 [00:12<00:14, 71689.44 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  42%|████▏     | 755000/1791700 [00:12<00:14, 71790.48 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  43%|████▎     | 763000/1791700 [00:12<00:14, 69340.10 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  43%|████▎     | 771000/1791700 [00:12<00:14, 71432.65 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  43%|████▎     | 779000/1791700 [00:13<00:14, 67878.62 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  44%|████▍     | 789000/1791700 [00:13<00:13, 75516.02 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  44%|████▍     | 797000/1791700 [00:13<00:13, 71911.69 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  45%|████▍     | 806000/1791700 [00:13<00:13, 72983.35 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  45%|████▌     | 814000/1791700 [00:13<00:13, 73863.63 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  46%|████▌     | 823000/1791700 [00:13<00:13, 74411.74 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  46%|████▋     | 831000/1791700 [00:13<00:12, 74016.12 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  47%|████▋     | 839000/1791700 [00:13<00:12, 74337.80 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  47%|████▋     | 847000/1791700 [00:13<00:12, 75075.62 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  48%|████▊     | 855000/1791700 [00:14<00:12, 73170.82 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  48%|████▊     | 863000/1791700 [00:14<00:12, 75064.54 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  49%|████▊     | 871000/1791700 [00:14<00:12, 76466.50 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  49%|████▉     | 879000/1791700 [00:14<00:12, 74066.06 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  50%|████▉     | 887000/1791700 [00:14<00:13, 68009.57 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  50%|█████     | 896000/1791700 [00:14<00:12, 71303.24 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  50%|█████     | 904000/1791700 [00:14<00:12, 71464.57 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  51%|█████     | 912000/1791700 [00:14<00:12, 68017.28 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  51%|█████▏    | 921000/1791700 [00:14<00:11, 73074.66 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  52%|█████▏    | 929000/1791700 [00:15<00:12, 71092.31 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  52%|█████▏    | 937000/1791700 [00:15<00:11, 71954.87 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  53%|█████▎    | 945000/1791700 [00:15<00:11, 71669.57 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  53%|█████▎    | 954000/1791700 [00:15<00:11, 72086.15 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  54%|█████▎    | 963000/1791700 [00:15<00:11, 72977.60 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  54%|█████▍    | 971000/1791700 [00:15<00:11, 73304.72 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  55%|█████▍    | 979000/1791700 [00:15<00:11, 72993.19 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  55%|█████▌    | 987000/1791700 [00:15<00:11, 69322.90 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  56%|█████▌    | 996000/1791700 [00:16<00:11, 70649.09 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  56%|█████▌    | 1004000/1791700 [00:16<00:11, 68608.09 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  56%|█████▋    | 1011000/1791700 [00:16<00:11, 68808.54 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  57%|█████▋    | 1019000/1791700 [00:16<00:10, 71215.19 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  57%|█████▋    | 1027000/1791700 [00:16<00:10, 71522.24 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  58%|█████▊    | 1035000/1791700 [00:16<00:11, 68578.24 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  58%|█████▊    | 1043000/1791700 [00:16<00:10, 69920.38 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  59%|█████▊    | 1052000/1791700 [00:16<00:09, 74982.26 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  59%|█████▉    | 1060000/1791700 [00:16<00:10, 67127.00 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  60%|█████▉    | 1067000/1791700 [00:17<00:11, 65821.01 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  60%|██████    | 1079000/1791700 [00:17<00:09, 74523.77 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  61%|██████    | 1087000/1791700 [00:17<00:10, 64722.96 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  61%|██████▏   | 1100000/1791700 [00:17<00:08, 78819.02 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  62%|██████▏   | 1109000/1791700 [00:17<00:10, 64961.74 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  63%|██████▎   | 1122000/1791700 [00:17<00:08, 78925.07 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  63%|██████▎   | 1131000/1791700 [00:17<00:10, 64079.46 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  64%|██████▎   | 1141000/1791700 [00:18<00:09, 68570.73 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  64%|██████▍   | 1149000/1791700 [00:18<00:11, 57629.96 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  65%|██████▍   | 1156000/1791700 [00:18<00:11, 54214.03 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  65%|██████▌   | 1166000/1791700 [00:18<00:09, 63292.46 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  66%|██████▌   | 1174000/1791700 [00:18<00:09, 65905.76 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  66%|██████▌   | 1182000/1791700 [00:18<00:09, 61028.51 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  66%|██████▋   | 1189000/1791700 [00:18<00:10, 58712.26 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  67%|██████▋   | 1196000/1791700 [00:19<00:09, 60937.22 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  67%|██████▋   | 1204000/1791700 [00:19<00:09, 63814.45 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  68%|██████▊   | 1211000/1791700 [00:19<00:09, 62632.32 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  68%|██████▊   | 1219000/1791700 [00:19<00:08, 66354.07 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  69%|██████▊   | 1229000/1791700 [00:19<00:08, 68939.96 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  69%|██████▉   | 1236000/1791700 [00:19<00:08, 66750.31 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  69%|██████▉   | 1244000/1791700 [00:19<00:07, 69177.08 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  70%|██████▉   | 1253000/1791700 [00:19<00:07, 73207.42 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  70%|███████   | 1261000/1791700 [00:20<00:08, 65693.84 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  71%|███████   | 1269000/1791700 [00:20<00:07, 68245.61 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  71%|███████▏  | 1279000/1791700 [00:20<00:06, 75786.19 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  72%|███████▏  | 1287000/1791700 [00:20<00:06, 73993.05 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  72%|███████▏  | 1295000/1791700 [00:20<00:06, 75335.81 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  73%|███████▎  | 1303000/1791700 [00:20<00:07, 66915.16 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  73%|███████▎  | 1315000/1791700 [00:20<00:06, 78870.31 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  74%|███████▍  | 1324000/1791700 [00:20<00:07, 62932.40 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  75%|███████▍  | 1339000/1791700 [00:21<00:05, 80393.49 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  75%|███████▌  | 1348000/1791700 [00:21<00:06, 64148.47 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  76%|███████▌  | 1359000/1791700 [00:21<00:05, 73466.46 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  76%|███████▋  | 1368000/1791700 [00:21<00:06, 61761.13 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  77%|███████▋  | 1377000/1791700 [00:21<00:06, 65542.17 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  77%|███████▋  | 1387000/1791700 [00:21<00:05, 72651.85 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  78%|███████▊  | 1396000/1791700 [00:21<00:06, 65788.62 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  78%|███████▊  | 1406000/1791700 [00:22<00:05, 72383.21 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  79%|███████▉  | 1414000/1791700 [00:22<00:05, 63591.81 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  79%|███████▉  | 1421000/1791700 [00:22<00:05, 62829.19 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  80%|███████▉  | 1432000/1791700 [00:22<00:05, 68667.76 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  80%|████████  | 1440000/1791700 [00:22<00:05, 64021.26 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  81%|████████  | 1450000/1791700 [00:22<00:04, 71551.86 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  81%|████████▏ | 1458000/1791700 [00:22<00:04, 70160.97 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  82%|████████▏ | 1466000/1791700 [00:23<00:05, 64620.27 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  82%|████████▏ | 1475000/1791700 [00:23<00:04, 69625.76 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  83%|████████▎ | 1483000/1791700 [00:23<00:04, 70826.20 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  83%|████████▎ | 1491000/1791700 [00:23<00:04, 63255.15 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  84%|████████▍ | 1501000/1791700 [00:23<00:04, 61412.95 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  84%|████████▍ | 1510000/1791700 [00:23<00:04, 66160.07 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  85%|████████▍ | 1518000/1791700 [00:23<00:04, 68247.98 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  85%|████████▌ | 1526000/1791700 [00:23<00:04, 59348.25 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  86%|████████▌ | 1535000/1791700 [00:24<00:03, 64788.48 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  86%|████████▌ | 1543000/1791700 [00:24<00:03, 67939.17 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  87%|████████▋ | 1551000/1791700 [00:24<00:03, 67466.09 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  87%|████████▋ | 1559000/1791700 [00:24<00:03, 70487.10 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  87%|████████▋ | 1567000/1791700 [00:24<00:03, 70014.64 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  88%|████████▊ | 1575000/1791700 [00:24<00:03, 69404.82 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  88%|████████▊ | 1584000/1791700 [00:24<00:02, 74019.55 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  89%|████████▉ | 1592000/1791700 [00:24<00:03, 60880.60 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  90%|████████▉ | 1604000/1791700 [00:25<00:02, 71095.63 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  90%|████████▉ | 1612000/1791700 [00:25<00:02, 62230.07 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  90%|█████████ | 1621000/1791700 [00:25<00:02, 68496.00 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  91%|█████████ | 1630000/1791700 [00:25<00:02, 72691.05 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  91%|█████████▏| 1638655/1791700 [00:25<00:02, 66337.82 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  92%|█████████▏| 1649655/1791700 [00:25<00:02, 67755.79 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  93%|█████████▎| 1657655/1791700 [00:25<00:02, 62749.12 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  93%|█████████▎| 1671655/1791700 [00:26<00:01, 75401.55 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  94%|█████████▍| 1680310/1791700 [00:26<00:01, 60795.20 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  95%|█████████▍| 1693965/1791700 [00:26<00:01, 76326.62 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  95%|█████████▌| 1703273/1791700 [00:26<00:01, 61630.64 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  96%|█████████▌| 1716273/1791700 [00:26<00:01, 71618.82 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  96%|█████████▋| 1725236/1791700 [00:26<00:01, 61097.39 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  97%|█████████▋| 1733890/1791700 [00:27<00:00, 65171.95 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  97%|█████████▋| 1741852/1791700 [00:27<00:00, 55151.20 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  98%|█████████▊| 1748852/1791700 [00:27<00:00, 55498.87 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  98%|█████████▊| 1755506/1791700 [00:27<00:00, 46141.37 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  98%|█████████▊| 1761160/1791700 [00:27<00:00, 46997.33 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  99%|█████████▊| 1767160/1791700 [00:27<00:00, 41300.92 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  99%|█████████▉| 1771814/1791700 [00:27<00:00, 41807.81 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  99%|█████████▉| 1776776/1791700 [00:28<00:00, 35957.18 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  99%|█████████▉| 1780776/1791700 [00:28<00:00, 35458.22 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24): 100%|█████████▉| 1785430/1791700 [00:28<00:00, 26700.64 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24): 100%|█████████▉| 1789392/1791700 [00:28<00:00, 21854.79 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24): 100%|██████████| 1791700/1791700 [00:29<00:00, 61236.83 examples/s]
[36m(TaskRunner pid=2344)[0m Generating train split: 0 examples [00:00, ? examples/s]Generating train split: 960 examples [00:00, 258028.31 examples/s]
[36m(TaskRunner pid=2344)[0m Setting TOKENIZERS_PARALLELISM=false for forked processes.
[36m(TaskRunner pid=2344)[0m WARNING:2025-12-24 04:56:08,476:Setting TOKENIZERS_PARALLELISM=false for forked processes.
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):   0%|          | 0/960 [00:00<?, ? examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):   4%|▍         | 40/960 [00:00<00:15, 58.05 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  12%|█▎        | 120/960 [00:00<00:04, 169.50 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  17%|█▋        | 160/960 [00:01<00:04, 189.04 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  25%|██▌       | 240/960 [00:01<00:02, 240.33 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  29%|██▉       | 280/960 [00:01<00:03, 207.56 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  42%|████▏     | 400/960 [00:01<00:02, 271.01 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  46%|████▌     | 440/960 [00:02<00:01, 261.35 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  50%|█████     | 480/960 [00:02<00:01, 280.66 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  54%|█████▍    | 520/960 [00:02<00:01, 301.81 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  58%|█████▊    | 560/960 [00:02<00:01, 311.31 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  67%|██████▋   | 640/960 [00:02<00:00, 334.22 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  71%|███████   | 680/960 [00:02<00:00, 338.67 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  79%|███████▉  | 760/960 [00:02<00:00, 340.23 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  88%|████████▊ | 840/960 [00:03<00:00, 402.41 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24):  96%|█████████▌| 920/960 [00:03<00:00, 390.82 examples/s]
[36m(TaskRunner pid=2344)[0m Filtering prompts longer than 2048 tokens (num_proc=24): 100%|██████████| 960/960 [00:03<00:00, 271.77 examples/s]
[36m(TaskRunner pid=2344)[0m /workspace/verl/verl/verl/trainer/ppo/ray_trainer.py:335: UserWarning: Disabled critic as algorithm.adv_estimator != gae. If it is not intended, please set critic.enable=True
[36m(TaskRunner pid=2344)[0m   self.use_critic = need_critic(self.config)
[36m(WorkerDict pid=3078)[0m <string>:35: UserWarning: set sequence parallel to false as TP size is 1
[36m(WorkerDict pid=3078)[0m /workspace/verl/verl/verl/utils/profiler/config.py:49: UserWarning: Torch profiler tool config is not fully supported now.
[36m(WorkerDict pid=3078)[0m   warnings.warn("Torch profiler tool config is not fully supported now.", stacklevel=1)

[36m(TaskRunner pid=2344)[0m                                                'torch_memory': {'_target_': 'verl.utils.profiler.config.TorchMemoryToolConfig',
[36m(TaskRunner pid=2344)[0m                                                                 'stack_depth': 32,
[36m(TaskRunner pid=2344)[0m                                                                 'trace_alloc_max_entries': 100000}}},
[36m(TaskRunner pid=2344)[0m                   'reward_kwargs': {'max_resp_len': 8192,
[36m(TaskRunner pid=2344)[0m                                     'overlong_buffer_cfg': {'enable': True,
[36m(TaskRunner pid=2344)[0m                                                             'len': 4096,
[36m(TaskRunner pid=2344)[0m                                                             'log': False,
[36m(TaskRunner pid=2344)[0m                                                             'penalty_factor': 1.0}},
[36m(TaskRunner pid=2344)[0m                   'reward_loop_class_name': None,
[36m(TaskRunner pid=2344)[0m                   'reward_loop_module_path': None,
[36m(TaskRunner pid=2344)[0m                   'reward_loop_source': 'register',
[36m(TaskRunner pid=2344)[0m                   'reward_manager': 'dapo',
[36m(TaskRunner pid=2344)[0m                   'rollout': {'_target_': 'verl.workers.config.RolloutConfig',
[36m(TaskRunner pid=2344)[0m                               'cudagraph_capture_sizes': None,
[36m(TaskRunner pid=2344)[0m                               'data_parallel_size': 1,
[36m(TaskRunner pid=2344)[0m                               'disable_log_stats': True,
[36m(TaskRunner pid=2344)[0m                               'dtype': 'bfloat16',
[36m(TaskRunner pid=2344)[0m                               'enable_chunked_prefill': True,
[36m(TaskRunner pid=2344)[0m                               'enable_prefix_caching': True,
[36m(TaskRunner pid=2344)[0m                               'enforce_eager': True,
[36m(TaskRunner pid=2344)[0m                               'engine_kwargs': {},
[36m(TaskRunner pid=2344)[0m                               'expert_parallel_size': 1,
[36m(TaskRunner pid=2344)[0m                               'free_cache_engine': True,
[36m(TaskRunner pid=2344)[0m                               'gpu_memory_utilization': 0.5,
[36m(TaskRunner pid=2344)[0m                               'limit_images': None,
[36m(TaskRunner pid=2344)[0m                               'load_format': 'auto',
[36m(TaskRunner pid=2344)[0m                               'max_model_len': None,
[36m(TaskRunner pid=2344)[0m                               'max_num_batched_tokens': 8192,
[36m(TaskRunner pid=2344)[0m                               'max_num_seqs': 1024,
[36m(TaskRunner pid=2344)[0m                               'name': '???',
[36m(TaskRunner pid=2344)[0m                               'prompt_length': 2048,
[36m(TaskRunner pid=2344)[0m                               'response_length': 2048,
[36m(TaskRunner pid=2344)[0m                               'skip_tokenizer_init': False,
[36m(TaskRunner pid=2344)[0m                               'tensor_model_parallel_size': 2},
[36m(TaskRunner pid=2344)[0m                   'sandbox_fusion': {'max_concurrent': 64,
[36m(TaskRunner pid=2344)[0m                                      'memory_limit_mb': 1024,
[36m(TaskRunner pid=2344)[0m                                      'url': None},
[36m(TaskRunner pid=2344)[0m                   'strategy': 'megatron',
[36m(TaskRunner pid=2344)[0m                   'use_dynamic_bsz': True,
[36m(TaskRunner pid=2344)[0m                   'use_reward_loop': True},
[36m(TaskRunner pid=2344)[0m  'trainer': {'balance_batch': True,
[36m(TaskRunner pid=2344)[0m              'critic_warmup': 0,
[36m(TaskRunner pid=2344)[0m              'default_hdfs_dir': None,
[36m(TaskRunner pid=2344)[0m              'default_local_dir': '/workspace/verl/checkpoint/wuxibin_gspo/qwen3-30B-base-grpo-megatron',
[36m(TaskRunner pid=2344)[0m              'del_local_ckpt_after_load': False,
[36m(TaskRunner pid=2344)[0m              'device': 'cuda',
[36m(TaskRunner pid=2344)[0m              'esi_redundant_time': 0,
[36m(TaskRunner pid=2344)[0m              'experiment_name': 'qwen3-30B-base-grpo-megatron',
[36m(TaskRunner pid=2344)[0m              'log_val_generations': 100,
[36m(TaskRunner pid=2344)[0m              'logger': ['console', 'wandb'],
[36m(TaskRunner pid=2344)[0m              'max_actor_ckpt_to_keep': None,
[36m(TaskRunner pid=2344)[0m              'max_critic_ckpt_to_keep': None,
[36m(TaskRunner pid=2344)[0m              'n_gpus_per_node': 1,
[36m(TaskRunner pid=2344)[0m              'nnodes': 1,
[36m(TaskRunner pid=2344)[0m              'project_name': 'wuxibin_gspo',
[36m(TaskRunner pid=2344)[0m              'ray_wait_register_center_timeout': 300,
[36m(TaskRunner pid=2344)[0m              'resume_from_path': None,
[36m(TaskRunner pid=2344)[0m              'resume_mode': 'auto',
[36m(TaskRunner pid=2344)[0m              'rollout_data_dir': None,
[36m(TaskRunner pid=2344)[0m              'save_freq': -1,
[36m(TaskRunner pid=2344)[0m              'test_freq': 10,
[36m(TaskRunner pid=2344)[0m              'total_epochs': 10,
[36m(TaskRunner pid=2344)[0m              'total_training_steps': 500,
[36m(TaskRunner pid=2344)[0m              'use_legacy_worker_impl': 'disable',
[36m(TaskRunner pid=2344)[0m              'val_before_train': False},
[36m(TaskRunner pid=2344)[0m  'transfer_queue': {'enable': False}}
[36m(TaskRunner pid=2344)[0m [validate_config] All configuration checks passed successfully!
[36m(TaskRunner pid=2344)[0m Using dataset class: RLHFDataset
[36m(TaskRunner pid=2344)[0m dataset len: 1791700
[36m(TaskRunner pid=2344)[0m filter dataset len: 1791700
[36m(TaskRunner pid=2344)[0m Using dataset class: RLHFDataset
[36m(TaskRunner pid=2344)[0m dataset len: 960
[36m(TaskRunner pid=2344)[0m filter dataset len: 960
[36m(TaskRunner pid=2344)[0m Size of train dataloader: 6998, Size of val dataloader: 1
[36m(TaskRunner pid=2344)[0m Total training steps: 500
[36m(TaskRunner pid=2344)[0m colocated worker base class <class 'verl.single_controller.base.worker.Worker'>
[36m(TaskRunner pid=2344)[0m bind role actor_rollout method chat_completion to class <class 'verl.single_controller.ray.base.create_colocated_worker_cls.<locals>.WorkerDict'>
[36m(TaskRunner pid=2344)[0m bind role actor_rollout method generate to class <class 'verl.single_controller.ray.base.create_colocated_worker_cls.<locals>.WorkerDict'>
[36m(TaskRunner pid=2344)[0m bind role actor_rollout method get_zeromq_address to class <class 'verl.single_controller.ray.base.create_colocated_worker_cls.<locals>.WorkerDict'>
[36m(TaskRunner pid=2344)[0m bind role actor_rollout method sleep to class <class 'verl.single_controller.ray.base.create_colocated_worker_cls.<locals>.WorkerDict'>
[36m(TaskRunner pid=2344)[0m bind role actor_rollout method wake_up to class <class 'verl.single_controller.ray.base.create_colocated_worker_cls.<locals>.WorkerDict'>
[36m(WorkerDict pid=3078)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=3078)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=3078)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=3078)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=3078)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=3078)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=3078)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=3078)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=3078)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0[36m(WorkerDict pid=3078)[0m /usr/local/lib/python3.12/dist-packages/megatron/core/transformer/transformer_config.py:1338: UserWarning: Using a large number of experts (e.g. >=32) without fp32 routing. Consider enabling moe_router_dtype for better numerical stability.
[36m(WorkerDict pid=3078)[0m   warnings.warn(
[36m(WorkerDict pid=3078)[0m /usr/local/lib/python3.12/dist-packages/transformer_engine/pytorch/cpu_offload.py:695: DeprecationWarning: Offloading weights is deprecated. Using offload_weights=True does not have any effect.
[36m(WorkerDict pid=3078)[0m   warnings.warn(

[36m(WorkerDict pid=3078)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=3078)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=3078)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=3078)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=3078)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=3078)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=3078)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=3078)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=3078)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=3078)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=3078)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=3078)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=3078)[0m TF config: TransformerConfig(tensor_model_parallel_size=1, pipeline_model_parallel_comm_backend=None, pipeline_model_parallel_size=1, virtual_pipeline_model_parallel_size=None, sequence_parallel=False, context_parallel_size=1, hierarchical_context_parallel_sizes=None, expert_model_parallel_size=1, expert_tensor_parallel_size=1, moe_extended_tp=False, perform_initialization=True, use_cpu_initialization=False, fp16=False, bf16=True, params_dtype=torch.bfloat16, timers=None, finalize_model_grads_func=None, grad_scale_func=None, no_sync_func=None, grad_sync_func=None, param_sync_func=None, deterministic_mode=False, enable_autocast=False, autocast_dtype=torch.bfloat16, num_microbatches_with_partial_activation_checkpoints=None, gradient_accumulation_fusion=False, async_tensor_model_parallel_allreduce=False, use_te_rng_tracker=False, tp_comm_overlap=False, tp_comm_bulk_wgrad=True, tp_comm_bulk_dgrad=True, tp_comm_overlap_ag=True, tp_comm_overlap_rs=True, tp_comm_overlap_rs_dgrad=False, tp_comm_split_ag=True, tp_comm_atomic_ag=False, tp_comm_split_rs=True, tp_comm_atomic_rs=False, cross_entropy_loss_fusion=False, cross_entropy_fusion_impl='native', tp_comm_overlap_disable_qkv=False, tp_comm_overlap_disable_fc1=False, tp_comm_bootstrap_backend='nccl', overlap_moe_expert_parallel_comm=False, delay_wgrad_compute=False, pipeline_dtype=torch.bfloat16, variable_seq_lengths=True, overlap_p2p_comm=False, batch_p2p_comm=False, batch_p2p_sync=True, use_ring_exchange_p2p=False, deallocate_pipeline_outputs=False, defer_embedding_wgrad_compute=False, wgrad_deferral_limit=0, overlap_p2p_comm_warmup_flush=False, microbatch_group_size_per_vp_stage=1, cpu_offloading=False, cpu_offloading_num_layers=0, _cpu_offloading_context=None, cpu_offloading_activations=True, cpu_offloading_weights=True, barrier_with_L1_time=True, num_layers=48, mtp_num_layers=None, mtp_loss_scaling_factor=None, num_layers_in_first_pipeline_stage=None, num_layers_in_last_pipeline_stage=None, pipeline_model_parallel_layout=None, account_for_embedding_in_pipeline_split=False, account_for_loss_in_pipeline_split=False, hidden_size=2048, num_attention_heads=32, attention_backend=<AttnBackend.flash: 1>, softmax_scale=None, num_query_groups=4, ffn_hidden_size=6144, kv_channels=128, hidden_dropout=0.0, attention_dropout=0.0, fp32_residual_connection=False, apply_residual_connection_post_layernorm=False, layernorm_epsilon=1e-06, layernorm_zero_centered_gamma=False, add_bias_linear=False, add_qkv_bias=False, gated_linear_unit=True, activation_func=<function silu at 0x7f8696b498a0>, activation_func_fp8_input_store=False, num_moe_experts=128, rotary_interleaved=False, window_size=None, normalization='RMSNorm', qk_layernorm=True, test_mode=False, calculate_per_token_loss=False, multi_latent_attention=False, no_rope_freq=None, moe_deepep_num_sms=20, init_method=functools.partial(<function normal_ at 0x7f86969c6200>, mean=0.0, std=0.02), output_layer_init_method=functools.partial(<function normal_ at 0x7f86969c6200>, mean=0.0, std=0.0020412414523193153), init_method_std=0.02, embedding_init_method=functools.partial(<function normal_ at 0x7f86969c6200>, mean=0.0, std=0.02), embedding_init_method_std=0.02, init_model_with_meta_device=False, apply_query_key_layer_scaling=False, attention_softmax_in_fp32=True, disable_bf16_reduced_precision_matmul=False, bias_activation_fusion=True, masked_softmax_fusion=True, persist_layer_norm=True, memory_efficient_layer_norm=False, bias_dropout_fusion=True, apply_rope_fusion=True, use_fused_weighted_squared_relu=False, recompute_granularity='full', recompute_method='uniform', recompute_num_layers=1, distribute_saved_activations=None, recompute_modules=['core_attn'], fp8=None, fp8_recipe='delayed', fp8_param=False, fp8_margin=0, fp8_interval=1, fp8_amax_history_len=1, fp8_amax_compute_algo='most_recent', fp8_wgrad=True, fp8_dot_product_attention=False, fp8_multi_head_attention=False, tp_only_amax_red=False, first_last_layers_bf16=False, num_layers_at_start_in_bf16=1, num_layers_at_end_in_bf16=1, use_kitchen=False, moe_shared_expert_intermediate_size=None, moe_shared_expert_overlap=False, moe_layer_freq=1, moe_ffn_hidden_size=768, moe_router_load_balancing_type='none', moe_router_topk=8, moe_router_topk_limited_devices=None, moe_router_padding_for_fp8=False, moe_router_num_groups=None, moe_router_group_topk=None, moe_router_pre_softmax=False, moe_router_topk_scaling_factor=None, moe_router_score_function='softmax', moe_router_dtype='fp32', moe_router_enable_expert_bias=False, moe_router_bias_update_rate=0.001, moe_router_force_load_balancing=False, moe_grouped_gemm=True, moe_use_legacy_grouped_gemm=False, moe_aux_loss_coeff=0.001, moe_z_loss_coeff=None, moe_input_jitter_eps=None, moe_token_dropping=False, moe_token_dispatcher_type='alltoall', moe_enable_deepep=False, moe_per_layer_logging=False, moe_expert_capacity_factor=None, moe_pad_expert_input_to_capacity=False, moe_token_drop_policy='probs', moe_layer_recompute=False, moe_permute_fusion=True, moe_router_fusion=False, moe_apply_probs_on_input=False, cp_comm_type=None, enable_cuda_graph=False, cuda_graph_use_single_mempool=False, cuda_graph_retain_backward_graph=False, cuda_graph_warmup_steps=3, external_cuda_graph=False, cuda_graph_scope='full', clone_scatter_output_in_embedding=True, disable_parameter_transpose_cache=False, config_logger_dir='', flash_decode=False, inference_rng_tracker=False, symmetric_ar_type=None, mrope_section=None, is_hybrid_model=False, mamba_state_dim=128, mamba_head_dim=64, mamba_num_groups=8, mamba_num_heads=None, use_mamba_mem_eff_path=True, mlp_chunks_for_prefill=1, heterogeneous_block_specs=False, hetereogenous_dist_checkpoint=False, quant_recipe=None, transformer_impl='transformer_engine')
[36m(WorkerDict pid=3078)[0m  > number of parameters on (tensor, pipeline) model parallel rank (0, 0): 30532122624
Error executing job with overrides: ['algorithm.adv_estimator=grpo', 'algorithm.use_kl_in_reward=False', 'algorithm.kl_ctrl.kl_coef=0.001', 'algorithm.gamma=1.0', 'algorithm.lam=0.95', 'data.train_files=hf://datasets/BytedTsinghua-SIA/DAPO-Math-17k/data/dapo-math-17k.parquet', 'data.val_files=hf://datasets/BytedTsinghua-SIA/AIME-2024/data/aime-2024.parquet', 'data.return_raw_chat=True', 'data.train_batch_size=256', 'data.max_prompt_length=2048', 'data.max_response_length=8192', 'data.filter_overlong_prompts=True', 'data.filter_overlong_prompts_workers=64', 'data.truncation=error', 'trainer.use_legacy_worker_impl=disable', 'trainer.critic_warmup=0', 'trainer.logger=[console,wandb]', 'trainer.project_name=wuxibin_gspo', 'trainer.experiment_name=qwen3-30B-base-grpo-megatron', 'trainer.default_local_dir=/workspace/verl/checkpoint/wuxibin_gspo/qwen3-30B-base-grpo-megatron', 'trainer.n_gpus_per_node=1', 'trainer.nnodes=1', 'trainer.val_before_train=False', 'trainer.log_val_generations=100', 'trainer.save_freq=-1', 'trainer.test_freq=10', 'trainer.total_epochs=10', 'trainer.total_training_steps=500', 'actor_rollout_ref.actor.optim.lr=1e-6', 'actor_rollout_ref.model.path=Qwen/Qwen3-30B-A3B-Base', 'actor_rollout_ref.model.use_remove_padding=True', 'actor_rollout_ref.actor.use_kl_loss=False', 'actor_rollout_ref.actor.kl_loss_coef=0.001', 'actor_rollout_ref.actor.clip_ratio_low=3e-4', 'actor_rollout_ref.actor.clip_ratio_high=4e-4', 'actor_rollout_ref.actor.clip_ratio_c=10.0', 'actor_rollout_ref.actor.policy_loss.loss_mode=gspo', 'actor_rollout_ref.actor.use_dynamic_bsz=True', 'actor_rollout_ref.actor.ppo_mini_batch_size=32', 'actor_rollout_ref.actor.ppo_max_token_len_per_gpu=30720', 'actor_rollout_ref.actor.megatron.tensor_model_parallel_size=1', 'actor_rollout_ref.actor.megatron.context_parallel_size=1', 'actor_rollout_ref.actor.megatron.pipeline_model_parallel_size=1', 'actor_rollout_ref.actor.megatron.virtual_pipeline_model_parallel_size=null', 'actor_rollout_ref.actor.megatron.expert_model_parallel_size=1', 'actor_rollout_ref.actor.megatron.expert_tensor_parallel_size=1', 'actor_rollout_ref.actor.megatron.param_offload=True', 'actor_rollout_ref.actor.megatron.grad_offload=True', 'actor_rollout_ref.actor.megatron.optimizer_offload=True', '+actor_rollout_ref.actor.megatron.override_transformer_config.moe_router_dtype=fp32', '+actor_rollout_ref.actor.megatron.override_transformer_config.moe_permute_fusion=True', '+actor_rollout_ref.actor.megatron.override_transformer_config.recompute_method=uniform', '+actor_rollout_ref.actor.megatron.override_transformer_config.recompute_granularity=full', '+actor_rollout_ref.actor.megatron.override_transformer_config.recompute_num_layers=1', '+actor_rollout_ref.actor.megatron.override_transformer_config.apply_rope_fusion=True', '+actor_rollout_ref.actor.megatron.override_transformer_config.gradient_accumulation_fusion=False', 'actor_rollout_ref.actor.megatron.use_mbridge=True', 'actor_rollout_ref.rollout.name=vllm', 'actor_rollout_ref.rollout.mode=async', 'actor_rollout_ref.rollout.tensor_model_parallel_size=1', 'actor_rollout_ref.rollout.data_parallel_size=1', 'actor_rollout_ref.rollout.expert_parallel_size=1', 'actor_rollout_ref.rollout.gpu_memory_utilization=0.8', 'actor_rollout_ref.rollout.n=16', 'actor_rollout_ref.rollout.val_kwargs.top_p=0.7', 'actor_rollout_ref.rollout.val_kwargs.temperature=1.0', 'actor_rollout_ref.rollout.val_kwargs.n=1', 'reward_model.reward_manager=dapo', '+reward_model.reward_kwargs.overlong_buffer_cfg.enable=True', '+reward_model.reward_kwargs.overlong_buffer_cfg.len=4096', '+reward_model.reward_kwargs.overlong_buffer_cfg.penalty_factor=1.0', '+reward_model.reward_kwargs.overlong_buffer_cfg.log=False', '+reward_model.reward_kwargs.max_resp_len=8192']
Traceback (most recent call last):
  File "/workspace/verl/verl/verl/trainer/main_ppo.py", line 45, in main
    run_ppo(config)
  File "/workspace/verl/verl/verl/trainer/main_ppo.py", line 99, in run_ppo
    ray.get(runner.run.remote(config))
  File "/usr/local/lib/python3.12/dist-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/ray/_private/client_mode_hook.py", line 104, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/ray/_private/worker.py", line 2882, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/ray/_private/worker.py", line 968, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(OutOfMemoryError): [36mray::TaskRunner.run()[39m (pid=2344, ip=162.243.206.134, actor_id=85d36ef73ace39ccf12b07be01000000, repr=<main_ppo.TaskRunner object at 0x7f6b2c023290>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/verl/verl/verl/trainer/main_ppo.py", line 371, in run
    trainer.init_workers()
  File "/workspace/verl/verl/verl/trainer/ppo/ray_trainer.py", line 912, in init_workers
    self.actor_rollout_wg.init_model()
  File "/workspace/verl/verl/verl/single_controller/ray/base.py", line 53, in __call__
    output = ray.get(output)
             ^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ray.exceptions.RayTaskError(OutOfMemoryError): [36mray::WorkerDict.actor_rollout_init_model()[39m (pid=3078, ip=162.243.206.134, actor_id=56fa620646140272a66f148001000000, repr=<verl.single_controller.ray.base.WorkerDict object at 0x7f7186476030>)
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
           ^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/verl/verl/verl/single_controller/ray/base.py", line 841, in func
    return getattr(self.worker_dict[key], name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/verl/verl/verl/single_controller/base/decorator.py", line 456, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/verl/verl/verl/utils/transferqueue_utils.py", line 309, in dummy_inner
    output = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/verl/verl/verl/workers/engine_workers.py", line 469, in init_model
    self.actor.reset()
  File "/workspace/verl/verl/verl/single_controller/base/decorator.py", line 456, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/verl/verl/verl/utils/transferqueue_utils.py", line 309, in dummy_inner
    output = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/verl/verl/verl/workers/engine_workers.py", line 120, in reset
    self.engine.initialize()
  File "/workspace/verl/verl/verl/workers/engine/megatron/transformer_impl.py", line 281, in initialize
    self.module = self._build_megatron_module()
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/verl/verl/verl/workers/engine/megatron/transformer_impl.py", line 208, in _build_megatron_module
    module, updated_tf_config = make_megatron_module(
                                ^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/verl/verl/verl/utils/megatron_utils.py", line 270, in make_megatron_module
    model = bridge.get_model(
            ^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/mbridge/core/bridge.py", line 120, in get_model
    model = get_model(
            ^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/mbridge/core/util.py", line 228, in get_model
    DP(
  File "/usr/local/lib/python3.12/dist-packages/megatron/core/distributed/distributed_data_parallel.py", line 374, in __init__
    self.buffers, self.bucket_groups = _allocate_buffers_for_parameters(
                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/megatron/core/distributed/distributed_data_parallel.py", line 284, in _allocate_buffers_for_parameters
    _ParamAndGradBuffer(
  File "/usr/local/lib/python3.12/dist-packages/megatron/core/distributed/param_and_grad_buffer.py", line 705, in __init__
    self.grad_data = torch.zeros(
                     ^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 113.74 GiB. GPU 0 has a total capacity of 139.80 GiB of which 19.39 GiB is free. Process 48206 has 120.41 GiB memory in use. Of the allocated memory 113.74 GiB is allocated by PyTorch, and 6.00 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
