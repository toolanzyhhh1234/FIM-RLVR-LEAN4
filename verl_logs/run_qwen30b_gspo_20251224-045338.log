+ export ARNOLD_WORKER_GPU=1
+ ARNOLD_WORKER_GPU=1
+ export ARNOLD_WORKER_NUM=1
+ ARNOLD_WORKER_NUM=1
+ export TORCH_CUDA_ARCH_LIST=12.0+PTX
+ TORCH_CUDA_ARCH_LIST=12.0+PTX
+ HDFS_ROOT=/workspace/verl
+ DATA_ROOT=/workspace/verl
+ backend=megatron
+ project_name=wuxibin_gspo
+ experiment_name=qwen3-30B-base-grpo-megatron
+ default_local_dir=/workspace/verl/checkpoint/wuxibin_gspo/qwen3-30B-base-grpo-megatron
+ adv_estimator=grpo
+ loss_mode=gspo
+ use_kl_in_reward=False
+ kl_coef=0.001
+ use_kl_loss=False
+ kl_loss_coef=0.001
+ clip_ratio_low=3e-4
+ clip_ratio_high=4e-4
+ actor_lr=1e-6
+ critic_lr=2e-6
+ gae_gamma=1.0
+ gae_lam=0.95
+ critic_warmup=0
+ train_files=hf://datasets/BytedTsinghua-SIA/DAPO-Math-17k/data/dapo-math-17k.parquet
+ test_files=hf://datasets/BytedTsinghua-SIA/AIME-2024/data/aime-2024.parquet
+ actor_model_path=Qwen/Qwen3-30B-A3B-Base
+ critic_model_path=Qwen/Qwen3-30B-A3B-Base
+ max_prompt_length=2048
+ max_response_length=8192
+ enable_overlong_buffer=True
+ overlong_buffer_len=4096
+ overlong_penalty_factor=1.0
+ train_batch_size=256
+ ppo_mini_batch_size=32
+ n_resp_per_prompt=16
+ n_resp_per_prompt_val=1
+ actor_max_token_len_per_gpu=30720
+ critic_max_token_len_per_gpu=40960
+ USP_SIZE=4
+ ACTOR_FSDP_CONFIG='
    actor_rollout_ref.actor.fsdp_config.strategy=megatron     actor_rollout_ref.actor.fsdp_config.param_offload=True     actor_rollout_ref.actor.fsdp_config.optimizer_offload=True     actor_rollout_ref.actor.ulysses_sequence_parallel_size=4'
+ TP_SIZE=1
+ CP_SIZE=1
+ PP_SIZE=1
+ VPP_SIZE=null
+ EP_SIZE=1
+ ETP_SIZE=1
+ ACTOR_MEGATRON_CONFIG='
    actor_rollout_ref.actor.megatron.tensor_model_parallel_size=1     actor_rollout_ref.actor.megatron.context_parallel_size=1     actor_rollout_ref.actor.megatron.pipeline_model_parallel_size=1     actor_rollout_ref.actor.megatron.virtual_pipeline_model_parallel_size=null     actor_rollout_ref.actor.megatron.expert_model_parallel_size=1     actor_rollout_ref.actor.megatron.expert_tensor_parallel_size=1     actor_rollout_ref.actor.megatron.param_offload=True     actor_rollout_ref.actor.megatron.grad_offload=True     actor_rollout_ref.actor.megatron.optimizer_offload=True     +actor_rollout_ref.actor.megatron.override_transformer_config.moe_router_dtype=fp32     +actor_rollout_ref.actor.megatron.override_transformer_config.moe_permute_fusion=True     +actor_rollout_ref.actor.megatron.override_transformer_config.recompute_method=uniform     +actor_rollout_ref.actor.megatron.override_transformer_config.recompute_granularity=full     +actor_rollout_ref.actor.megatron.override_transformer_config.recompute_num_layers=1     +actor_rollout_ref.actor.megatron.override_transformer_config.apply_rope_fusion=True     +actor_rollout_ref.actor.megatron.override_transformer_config.gradient_accumulation_fusion=False     actor_rollout_ref.actor.megatron.use_mbridge=True'
+ ACTOR_CONFIG='
    actor_rollout_ref.actor.optim.lr=1e-6     actor_rollout_ref.model.path=Qwen/Qwen3-30B-A3B-Base     actor_rollout_ref.model.use_remove_padding=True     actor_rollout_ref.actor.use_kl_loss=False     actor_rollout_ref.actor.kl_loss_coef=0.001     actor_rollout_ref.actor.clip_ratio_low=3e-4     actor_rollout_ref.actor.clip_ratio_high=4e-4     actor_rollout_ref.actor.clip_ratio_c=10.0     actor_rollout_ref.actor.policy_loss.loss_mode=gspo
    actor_rollout_ref.actor.use_dynamic_bsz=True     actor_rollout_ref.actor.ppo_mini_batch_size=32     actor_rollout_ref.actor.ppo_max_token_len_per_gpu=30720'
+ CIRITC_CONFIG='
    critic.optim.lr=2e-6     critic.model.path=Qwen/Qwen3-30B-A3B-Base     critic.model.use_remove_padding=True     critic.ppo_max_token_len_per_gpu=40960     critic.ulysses_sequence_parallel_size=4'
+ CRITIC_FSDP_CONFIG='
    critic.model.fsdp_config.strategy=megatron     critic.model.fsdp_config.param_offload=True     critic.model.fsdp_config.optimizer_offload=True     critic.model.ulysses_sequence_parallel_size=4'
+ CRITIC_MEGATRON_CONFIG='
    critic.megatron.tensor_model_parallel_size=1     critic.megatron.context_parallel_size=1     critic.megatron.pipeline_model_parallel_size=1     critic.megatron.virtual_pipeline_model_parallel_size=null     critic.megatron.expert_model_parallel_size=1     critic.megatron.expert_tensor_parallel_size=1     critic.megatron.param_offload=True     critic.megatron.grad_offload=True     critic.megatron.optimizer_offload=True     +critic.megatron.override_transformer_config.moe_router_dtype=fp32     +critic.megatron.override_transformer_config.moe_permute_fusion=True     +critic.megatron.override_transformer_config.recompute_method=uniform     +critic.megatron.override_transformer_config.recompute_granularity=full     +critic.megatron.override_transformer_config.recompute_num_layers=1     +critic.megatron.override_transformer_config.apply_rope_fusion=True     +critic.megatron.override_transformer_config.gradient_accumulation_fusion=False     critic.megatron.use_mbridge=True'
+ [[ megatron == \m\e\g\a\t\r\o\n ]]
+ CONFIG_NAME=ppo_megatron_trainer
+ ACTOR_CONFIG='
    actor_rollout_ref.actor.optim.lr=1e-6     actor_rollout_ref.model.path=Qwen/Qwen3-30B-A3B-Base     actor_rollout_ref.model.use_remove_padding=True     actor_rollout_ref.actor.use_kl_loss=False     actor_rollout_ref.actor.kl_loss_coef=0.001     actor_rollout_ref.actor.clip_ratio_low=3e-4     actor_rollout_ref.actor.clip_ratio_high=4e-4     actor_rollout_ref.actor.clip_ratio_c=10.0     actor_rollout_ref.actor.policy_loss.loss_mode=gspo
    actor_rollout_ref.actor.use_dynamic_bsz=True     actor_rollout_ref.actor.ppo_mini_batch_size=32     actor_rollout_ref.actor.ppo_max_token_len_per_gpu=30720 
    actor_rollout_ref.actor.megatron.tensor_model_parallel_size=1     actor_rollout_ref.actor.megatron.context_parallel_size=1     actor_rollout_ref.actor.megatron.pipeline_model_parallel_size=1     actor_rollout_ref.actor.megatron.virtual_pipeline_model_parallel_size=null     actor_rollout_ref.actor.megatron.expert_model_parallel_size=1     actor_rollout_ref.actor.megatron.expert_tensor_parallel_size=1     actor_rollout_ref.actor.megatron.param_offload=True     actor_rollout_ref.actor.megatron.grad_offload=True     actor_rollout_ref.actor.megatron.optimizer_offload=True     +actor_rollout_ref.actor.megatron.override_transformer_config.moe_router_dtype=fp32     +actor_rollout_ref.actor.megatron.override_transformer_config.moe_permute_fusion=True     +actor_rollout_ref.actor.megatron.override_transformer_config.recompute_method=uniform     +actor_rollout_ref.actor.megatron.override_transformer_config.recompute_granularity=full     +actor_rollout_ref.actor.megatron.override_transformer_config.recompute_num_layers=1     +actor_rollout_ref.actor.megatron.override_transformer_config.apply_rope_fusion=True     +actor_rollout_ref.actor.megatron.override_transformer_config.gradient_accumulation_fusion=False     actor_rollout_ref.actor.megatron.use_mbridge=True'
+ [[ grpo == \g\a\e ]]
+ CIRITC_CONFIG=
+ rollout_name=vllm
+ '[' vllm = vllm ']'
+ export VLLM_USE_V1=1
+ VLLM_USE_V1=1
+ infer_tp=1
+ infer_dp=1
+ infer_ep=1
+ gpu_memory_utilization=0.8
+ ROLLOUT_CONFIG='
    actor_rollout_ref.rollout.name=vllm     actor_rollout_ref.rollout.mode=async     actor_rollout_ref.rollout.tensor_model_parallel_size=1     actor_rollout_ref.rollout.data_parallel_size=1     actor_rollout_ref.rollout.expert_parallel_size=1     actor_rollout_ref.rollout.gpu_memory_utilization=0.8     actor_rollout_ref.rollout.n=16     actor_rollout_ref.rollout.val_kwargs.top_p=0.7     actor_rollout_ref.rollout.val_kwargs.temperature=1.0     actor_rollout_ref.rollout.val_kwargs.n=1'
+ REWARD_CONFIG='
    reward_model.reward_manager=dapo     +reward_model.reward_kwargs.overlong_buffer_cfg.enable=True     +reward_model.reward_kwargs.overlong_buffer_cfg.len=4096     +reward_model.reward_kwargs.overlong_buffer_cfg.penalty_factor=1.0     +reward_model.reward_kwargs.overlong_buffer_cfg.log=False     +reward_model.reward_kwargs.max_resp_len=8192'
+ python3 -m verl.trainer.main_ppo --config-path=./config --config-name=ppo_megatron_trainer algorithm.adv_estimator=grpo algorithm.use_kl_in_reward=False algorithm.kl_ctrl.kl_coef=0.001 algorithm.gamma=1.0 algorithm.lam=0.95 data.train_files=hf://datasets/BytedTsinghua-SIA/DAPO-Math-17k/data/dapo-math-17k.parquet data.val_files=hf://datasets/BytedTsinghua-SIA/AIME-2024/data/aime-2024.parquet data.return_raw_chat=True data.train_batch_size=256 data.max_prompt_length=2048 data.max_response_length=8192 data.filter_overlong_prompts=True data.filter_overlong_prompts_workers=64 data.truncation=error trainer.use_legacy_worker_impl=disable trainer.critic_warmup=0 'trainer.logger=[console,wandb]' trainer.project_name=wuxibin_gspo trainer.experiment_name=qwen3-30B-base-grpo-megatron trainer.default_local_dir=/workspace/verl/checkpoint/wuxibin_gspo/qwen3-30B-base-grpo-megatron trainer.n_gpus_per_node=1 trainer.nnodes=1 trainer.val_before_train=False trainer.log_val_generations=100 trainer.save_freq=-1 trainer.test_freq=10 trainer.total_epochs=10 trainer.total_training_steps=500 actor_rollout_ref.actor.optim.lr=1e-6 actor_rollout_ref.model.path=Qwen/Qwen3-30B-A3B-Base actor_rollout_ref.model.use_remove_padding=True actor_rollout_ref.actor.use_kl_loss=False actor_rollout_ref.actor.kl_loss_coef=0.001 actor_rollout_ref.actor.clip_ratio_low=3e-4 actor_rollout_ref.actor.clip_ratio_high=4e-4 actor_rollout_ref.actor.clip_ratio_c=10.0 actor_rollout_ref.actor.policy_loss.loss_mode=gspo actor_rollout_ref.actor.use_dynamic_bsz=True actor_rollout_ref.actor.ppo_mini_batch_size=32 actor_rollout_ref.actor.ppo_max_token_len_per_gpu=30720 actor_rollout_ref.actor.megatron.tensor_model_parallel_size=1 actor_rollout_ref.actor.megatron.context_parallel_size=1 actor_rollout_ref.actor.megatron.pipeline_model_parallel_size=1 actor_rollout_ref.actor.megatron.virtual_pipeline_model_parallel_size=null actor_rollout_ref.actor.megatron.expert_model_parallel_size=1 actor_rollout_ref.actor.megatron.expert_tensor_parallel_size=1 actor_rollout_ref.actor.megatron.param_offload=True actor_rollout_ref.actor.megatron.grad_offload=True actor_rollout_ref.actor.megatron.optimizer_offload=True +actor_rollout_ref.actor.megatron.override_transformer_config.moe_router_dtype=fp32 +actor_rollout_ref.actor.megatron.override_transformer_config.moe_permute_fusion=True +actor_rollout_ref.actor.megatron.override_transformer_config.recompute_method=uniform +actor_rollout_ref.actor.megatron.override_transformer_config.recompute_granularity=full +actor_rollout_ref.actor.megatron.override_transformer_config.recompute_num_layers=1 +actor_rollout_ref.actor.megatron.override_transformer_config.apply_rope_fusion=True +actor_rollout_ref.actor.megatron.override_transformer_config.gradient_accumulation_fusion=False actor_rollout_ref.actor.megatron.use_mbridge=True actor_rollout_ref.rollout.name=vllm actor_rollout_ref.rollout.mode=async actor_rollout_ref.rollout.tensor_model_parallel_size=1 actor_rollout_ref.rollout.data_parallel_size=1 actor_rollout_ref.rollout.expert_parallel_size=1 actor_rollout_ref.rollout.gpu_memory_utilization=0.8 actor_rollout_ref.rollout.n=16 actor_rollout_ref.rollout.val_kwargs.top_p=0.7 actor_rollout_ref.rollout.val_kwargs.temperature=1.0 actor_rollout_ref.rollout.val_kwargs.n=1 reward_model.reward_manager=dapo +reward_model.reward_kwargs.overlong_buffer_cfg.enable=True +reward_model.reward_kwargs.overlong_buffer_cfg.len=4096 +reward_model.reward_kwargs.overlong_buffer_cfg.penalty_factor=1.0 +reward_model.reward_kwargs.overlong_buffer_cfg.log=False +reward_model.reward_kwargs.max_resp_len=8192
/usr/bin/python3: Error while finding module specification for 'verl.trainer.main_ppo' (ModuleNotFoundError: No module named 'verl')
