+ export ARNOLD_WORKER_GPU=1
+ ARNOLD_WORKER_GPU=1
+ export ARNOLD_WORKER_NUM=1
+ ARNOLD_WORKER_NUM=1
+ export TORCH_CUDA_ARCH_LIST=12.0+PTX
+ TORCH_CUDA_ARCH_LIST=12.0+PTX
+ HDFS_ROOT=/root/FIM-RLVR-LEAN4
+ DATA_ROOT=/root/FIM-RLVR-LEAN4
+ backend=megatron
+ project_name=wuxibin_gspo
+ experiment_name=qwen3-30B-base-grpo-megatron
+ default_local_dir=/root/FIM-RLVR-LEAN4/checkpoint/wuxibin_gspo/qwen3-30B-base-grpo-megatron
+ adv_estimator=grpo
+ loss_mode=gspo
+ use_kl_in_reward=False
+ kl_coef=0.001
+ use_kl_loss=False
+ kl_loss_coef=0.001
+ clip_ratio_low=3e-4
+ clip_ratio_high=4e-4
+ actor_lr=1e-6
+ critic_lr=2e-6
+ gae_gamma=1.0
+ gae_lam=0.95
+ critic_warmup=0
+ train_files=hf://datasets/BytedTsinghua-SIA/DAPO-Math-17k/data/dapo-math-17k.parquet
+ test_files=hf://datasets/BytedTsinghua-SIA/AIME-2024/data/aime-2024.parquet
+ actor_model_path=Qwen/Qwen3-30B-A3B-Base
+ critic_model_path=Qwen/Qwen3-30B-A3B-Base
+ max_prompt_length=2048
+ max_response_length=8192
+ enable_overlong_buffer=True
+ overlong_buffer_len=4096
+ overlong_penalty_factor=1.0
+ train_batch_size=256
+ ppo_mini_batch_size=32
+ n_resp_per_prompt=16
+ n_resp_per_prompt_val=1
+ actor_max_token_len_per_gpu=30720
+ critic_max_token_len_per_gpu=40960
+ USP_SIZE=4
+ ACTOR_FSDP_CONFIG='
    actor_rollout_ref.actor.fsdp_config.strategy=megatron     actor_rollout_ref.actor.fsdp_config.param_offload=True     actor_rollout_ref.actor.fsdp_config.optimizer_offload=True     actor_rollout_ref.actor.ulysses_sequence_parallel_size=4'
+ TP_SIZE=1
+ CP_SIZE=1
+ PP_SIZE=1
+ VPP_SIZE=null
+ EP_SIZE=1
+ ETP_SIZE=1
+ ACTOR_MEGATRON_CONFIG='
    actor_rollout_ref.actor.megatron.tensor_model_parallel_size=1     actor_rollout_ref.actor.megatron.context_parallel_size=1     actor_rollout_ref.actor.megatron.pipeline_model_parallel_size=1     actor_rollout_ref.actor.megatron.virtual_pipeline_model_parallel_size=null     actor_rollout_ref.actor.megatron.expert_model_parallel_size=1     actor_rollout_ref.actor.megatron.expert_tensor_parallel_size=1     actor_rollout_ref.actor.megatron.param_offload=True     actor_rollout_ref.actor.megatron.grad_offload=True     actor_rollout_ref.actor.megatron.optimizer_offload=True     +actor_rollout_ref.actor.megatron.override_transformer_config.moe_router_dtype=fp32     +actor_rollout_ref.actor.megatron.override_transformer_config.moe_permute_fusion=True     +actor_rollout_ref.actor.megatron.override_transformer_config.recompute_method=uniform     +actor_rollout_ref.actor.megatron.override_transformer_config.recompute_granularity=full     +actor_rollout_ref.actor.megatron.override_transformer_config.recompute_num_layers=1     +actor_rollout_ref.actor.megatron.override_transformer_config.apply_rope_fusion=True     +actor_rollout_ref.actor.megatron.override_transformer_config.gradient_accumulation_fusion=False     actor_rollout_ref.actor.megatron.use_mbridge=True'
+ ACTOR_CONFIG='
    actor_rollout_ref.actor.optim.lr=1e-6     actor_rollout_ref.model.path=Qwen/Qwen3-30B-A3B-Base     actor_rollout_ref.model.use_remove_padding=True     actor_rollout_ref.actor.use_kl_loss=False     actor_rollout_ref.actor.kl_loss_coef=0.001     actor_rollout_ref.actor.clip_ratio_low=3e-4     actor_rollout_ref.actor.clip_ratio_high=4e-4     actor_rollout_ref.actor.clip_ratio_c=10.0     actor_rollout_ref.actor.policy_loss.loss_mode=gspo
    actor_rollout_ref.actor.use_dynamic_bsz=True     actor_rollout_ref.actor.ppo_mini_batch_size=32     actor_rollout_ref.actor.ppo_max_token_len_per_gpu=30720'
+ CIRITC_CONFIG='
    critic.optim.lr=2e-6     critic.model.path=Qwen/Qwen3-30B-A3B-Base     critic.model.use_remove_padding=True     critic.ppo_max_token_len_per_gpu=40960     critic.ulysses_sequence_parallel_size=4'
+ CRITIC_FSDP_CONFIG='
    critic.model.fsdp_config.strategy=megatron     critic.model.fsdp_config.param_offload=True     critic.model.fsdp_config.optimizer_offload=True     critic.model.ulysses_sequence_parallel_size=4'
+ CRITIC_MEGATRON_CONFIG='
    critic.megatron.tensor_model_parallel_size=1     critic.megatron.context_parallel_size=1     critic.megatron.pipeline_model_parallel_size=1     critic.megatron.virtual_pipeline_model_parallel_size=null     critic.megatron.expert_model_parallel_size=1     critic.megatron.expert_tensor_parallel_size=1     critic.megatron.param_offload=True     critic.megatron.grad_offload=True     critic.megatron.optimizer_offload=True     +critic.megatron.override_transformer_config.moe_router_dtype=fp32     +critic.megatron.override_transformer_config.moe_permute_fusion=True     +critic.megatron.override_transformer_config.recompute_method=uniform     +critic.megatron.override_transformer_config.recompute_granularity=full     +critic.megatron.override_transformer_config.recompute_num_layers=1     +critic.megatron.override_transformer_config.apply_rope_fusion=True     +critic.megatron.override_transformer_config.gradient_accumulation_fusion=False     critic.megatron.use_mbridge=True'
+ [[ megatron == \m\e\g\a\t\r\o\n ]]
+ CONFIG_NAME=ppo_megatron_trainer
+ ACTOR_CONFIG='
    actor_rollout_ref.actor.optim.lr=1e-6     actor_rollout_ref.model.path=Qwen/Qwen3-30B-A3B-Base     actor_rollout_ref.model.use_remove_padding=True     actor_rollout_ref.actor.use_kl_loss=False     actor_rollout_ref.actor.kl_loss_coef=0.001     actor_rollout_ref.actor.clip_ratio_low=3e-4     actor_rollout_ref.actor.clip_ratio_high=4e-4     actor_rollout_ref.actor.clip_ratio_c=10.0     actor_rollout_ref.actor.policy_loss.loss_mode=gspo
    actor_rollout_ref.actor.use_dynamic_bsz=True     actor_rollout_ref.actor.ppo_mini_batch_size=32     actor_rollout_ref.actor.ppo_max_token_len_per_gpu=30720 
    actor_rollout_ref.actor.megatron.tensor_model_parallel_size=1     actor_rollout_ref.actor.megatron.context_parallel_size=1     actor_rollout_ref.actor.megatron.pipeline_model_parallel_size=1     actor_rollout_ref.actor.megatron.virtual_pipeline_model_parallel_size=null     actor_rollout_ref.actor.megatron.expert_model_parallel_size=1     actor_rollout_ref.actor.megatron.expert_tensor_parallel_size=1     actor_rollout_ref.actor.megatron.param_offload=True     actor_rollout_ref.actor.megatron.grad_offload=True     actor_rollout_ref.actor.megatron.optimizer_offload=True     +actor_rollout_ref.actor.megatron.override_transformer_config.moe_router_dtype=fp32     +actor_rollout_ref.actor.megatron.override_transformer_config.moe_permute_fusion=True     +actor_rollout_ref.actor.megatron.override_transformer_config.recompute_method=uniform     +actor_rollout_ref.actor.megatron.override_transformer_config.recompute_granularity=full     +actor_rollout_ref.actor.megatron.override_transformer_config.recompute_num_layers=1     +actor_rollout_ref.actor.megatron.override_transformer_config.apply_rope_fusion=True     +actor_rollout_ref.actor.megatron.override_transformer_config.gradient_accumulation_fusion=False     actor_rollout_ref.actor.megatron.use_mbridge=True'
+ [[ grpo == \g\a\e ]]
+ CIRITC_CONFIG=
+ rollout_name=vllm
+ '[' vllm = vllm ']'
+ export VLLM_USE_V1=1
+ VLLM_USE_V1=1
+ infer_tp=1
+ infer_dp=1
+ infer_ep=1
+ gpu_memory_utilization=0.8
+ ROLLOUT_CONFIG='
    actor_rollout_ref.rollout.name=vllm     actor_rollout_ref.rollout.mode=async     actor_rollout_ref.rollout.tensor_model_parallel_size=1     actor_rollout_ref.rollout.data_parallel_size=1     actor_rollout_ref.rollout.expert_parallel_size=1     actor_rollout_ref.rollout.gpu_memory_utilization=0.8     actor_rollout_ref.rollout.n=16     actor_rollout_ref.rollout.val_kwargs.top_p=0.7     actor_rollout_ref.rollout.val_kwargs.temperature=1.0     actor_rollout_ref.rollout.val_kwargs.n=1'
+ REWARD_CONFIG='
    reward_model.reward_manager=dapo     +reward_model.reward_kwargs.overlong_buffer_cfg.enable=True     +reward_model.reward_kwargs.overlong_buffer_cfg.len=4096     +reward_model.reward_kwargs.overlong_buffer_cfg.penalty_factor=1.0     +reward_model.reward_kwargs.overlong_buffer_cfg.log=False     +reward_model.reward_kwargs.max_resp_len=8192'
+ python3 -m verl.trainer.main_ppo --config-path=./config --config-name=ppo_megatron_trainer algorithm.adv_estimator=grpo algorithm.use_kl_in_reward=False algorithm.kl_ctrl.kl_coef=0.001 algorithm.gamma=1.0 algorithm.lam=0.95 data.train_files=hf://datasets/BytedTsinghua-SIA/DAPO-Math-17k/data/dapo-math-17k.parquet data.val_files=hf://datasets/BytedTsinghua-SIA/AIME-2024/data/aime-2024.parquet data.return_raw_chat=True data.train_batch_size=256 data.max_prompt_length=2048 data.max_response_length=8192 data.filter_overlong_prompts=True data.filter_overlong_prompts_workers=64 data.truncation=error trainer.use_legacy_worker_impl=disable trainer.critic_warmup=0 'trainer.logger=[console,wandb]' trainer.project_name=wuxibin_gspo trainer.experiment_name=qwen3-30B-base-grpo-megatron trainer.default_local_dir=/root/FIM-RLVR-LEAN4/checkpoint/wuxibin_gspo/qwen3-30B-base-grpo-megatron trainer.n_gpus_per_node=1 trainer.nnodes=1 trainer.val_before_train=False trainer.log_val_generations=100 trainer.save_freq=-1 trainer.test_freq=10 trainer.total_epochs=10 trainer.total_training_steps=500 actor_rollout_ref.actor.optim.lr=1e-6 actor_rollout_ref.model.path=Qwen/Qwen3-30B-A3B-Base actor_rollout_ref.model.use_remove_padding=True actor_rollout_ref.actor.use_kl_loss=False actor_rollout_ref.actor.kl_loss_coef=0.001 actor_rollout_ref.actor.clip_ratio_low=3e-4 actor_rollout_ref.actor.clip_ratio_high=4e-4 actor_rollout_ref.actor.clip_ratio_c=10.0 actor_rollout_ref.actor.policy_loss.loss_mode=gspo actor_rollout_ref.actor.use_dynamic_bsz=True actor_rollout_ref.actor.ppo_mini_batch_size=32 actor_rollout_ref.actor.ppo_max_token_len_per_gpu=30720 actor_rollout_ref.actor.megatron.tensor_model_parallel_size=1 actor_rollout_ref.actor.megatron.context_parallel_size=1 actor_rollout_ref.actor.megatron.pipeline_model_parallel_size=1 actor_rollout_ref.actor.megatron.virtual_pipeline_model_parallel_size=null actor_rollout_ref.actor.megatron.expert_model_parallel_size=1 actor_rollout_ref.actor.megatron.expert_tensor_parallel_size=1 actor_rollout_ref.actor.megatron.param_offload=True actor_rollout_ref.actor.megatron.grad_offload=True actor_rollout_ref.actor.megatron.optimizer_offload=True +actor_rollout_ref.actor.megatron.override_transformer_config.moe_router_dtype=fp32 +actor_rollout_ref.actor.megatron.override_transformer_config.moe_permute_fusion=True +actor_rollout_ref.actor.megatron.override_transformer_config.recompute_method=uniform +actor_rollout_ref.actor.megatron.override_transformer_config.recompute_granularity=full +actor_rollout_ref.actor.megatron.override_transformer_config.recompute_num_layers=1 +actor_rollout_ref.actor.megatron.override_transformer_config.apply_rope_fusion=True +actor_rollout_ref.actor.megatron.override_transformer_config.gradient_accumulation_fusion=False actor_rollout_ref.actor.megatron.use_mbridge=True actor_rollout_ref.rollout.name=vllm actor_rollout_ref.rollout.mode=async actor_rollout_ref.rollout.tensor_model_parallel_size=1 actor_rollout_ref.rollout.data_parallel_size=1 actor_rollout_ref.rollout.expert_parallel_size=1 actor_rollout_ref.rollout.gpu_memory_utilization=0.8 actor_rollout_ref.rollout.n=16 actor_rollout_ref.rollout.val_kwargs.top_p=0.7 actor_rollout_ref.rollout.val_kwargs.temperature=1.0 actor_rollout_ref.rollout.val_kwargs.n=1 reward_model.reward_manager=dapo +reward_model.reward_kwargs.overlong_buffer_cfg.enable=True +reward_model.reward_kwargs.overlong_buffer_cfg.len=4096 +reward_model.reward_kwargs.overlong_buffer_cfg.penalty_factor=1.0 +reward_model.reward_kwargs.overlong_buffer_cfg.log=False +reward_model.reward_kwargs.max_resp_len=8192
/root/anaconda3/envs/py310/lib/python3.10/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
  import pynvml  # type: ignore[import]
WARNING:2025-12-23 20:23:35,784:fused_indices_to_multihot has reached end of life. Please migrate to a non-experimental function.
2025-12-23 20:23:37,650	WARNING utils.py:458 -- Detecting docker specified CPUs. In previous versions of Ray, CPU detection in containers was incorrect. Please ensure that Ray has enough CPUs allocated. As a temporary workaround to revert to the prior behavior, set `RAY_USE_MULTIPROCESSING_CPU_COUNT=1` as an env var before starting Ray. Set the env var: `RAY_DISABLE_DOCKER_CPU_WARNING=1` to mute this warning.
2025-12-23 20:23:37,650	WARNING utils.py:470 -- Ray currently does not support initializing Ray with fractional cpus. Your num_cpus will be truncated from 30.71999 to 30.
2025-12-23 20:23:37,811	INFO worker.py:1998 -- Started a local Ray instance. View the dashboard at [1m[32m127.0.0.1:8265 [39m[22m
/root/anaconda3/envs/py310/lib/python3.10/site-packages/ray/_private/worker.py:2046: FutureWarning: Tip: In future versions of Ray, Ray will no longer override accelerator visible devices env var if num_gpus=0 or num_gpus=None (default). To enable this behavior and turn off this error message, set RAY_ACCEL_ENV_VAR_OVERRIDE_ON_ZERO=0
  warnings.warn(
[36m(pid=89263)[0m /root/anaconda3/envs/py310/lib/python3.10/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
[36m(pid=89263)[0m   import pynvml  # type: ignore[import]
[36m(pid=89263)[0m W1223 20:23:41.609000 89263 site-packages/torch/utils/cpp_extension.py:117] No CUDA runtime is found, using CUDA_HOME='/usr/local/cuda'
[36m(pid=89263)[0m WARNING:2025-12-23 20:23:41,625:fused_indices_to_multihot has reached end of life. Please migrate to a non-experimental function.
ray init kwargs: {'num_cpus': None, 'runtime_env': {'env_vars': {'TOKENIZERS_PARALLELISM': 'true', 'NCCL_DEBUG': 'WARN', 'VLLM_LOGGING_LEVEL': 'WARN', 'VLLM_ALLOW_RUNTIME_LORA_UPDATING': 'true', 'VLLM_ALLREDUCE_USE_SYMM_MEM': '0', 'CUDA_DEVICE_MAX_CONNECTIONS': '1', 'NCCL_CUMEM_ENABLE': '0'}, 'working_dir': None}}
[36m(TaskRunner pid=89263)[0m TaskRunner hostname: c8c86202c359, PID: 89263
[36m(TaskRunner pid=89263)[0m {'actor_rollout_ref': {'actor': {'_target_': 'verl.workers.config.McoreActorConfig',
[36m(TaskRunner pid=89263)[0m                                  'calculate_entropy': False,
[36m(TaskRunner pid=89263)[0m                                  'checkpoint': {'_target_': 'verl.trainer.config.CheckpointConfig',
[36m(TaskRunner pid=89263)[0m                                                 'async_save': False,
[36m(TaskRunner pid=89263)[0m                                                 'load_contents': ['model',
[36m(TaskRunner pid=89263)[0m                                                                   'optimizer',
[36m(TaskRunner pid=89263)[0m                                                                   'extra'],
[36m(TaskRunner pid=89263)[0m                                                 'save_contents': ['model',
[36m(TaskRunner pid=89263)[0m                                                                   'optimizer',
[36m(TaskRunner pid=89263)[0m                                                                   'extra']},
[36m(TaskRunner pid=89263)[0m                                  'clip_ratio': 0.2,
[36m(TaskRunner pid=89263)[0m                                  'clip_ratio_c': 10.0,
[36m(TaskRunner pid=89263)[0m                                  'clip_ratio_high': 0.0004,
[36m(TaskRunner pid=89263)[0m                                  'clip_ratio_low': 0.0003,
[36m(TaskRunner pid=89263)[0m                                  'data_loader_seed': 42,
[36m(TaskRunner pid=89263)[0m                                  'entropy_coeff': 0,
[36m(TaskRunner pid=89263)[0m                                  'freeze_vision_tower': False,
[36m(TaskRunner pid=89263)[0m                                  'kl_loss_coef': 0.001,
[36m(TaskRunner pid=89263)[0m                                  'kl_loss_type': 'low_var_kl',
[36m(TaskRunner pid=89263)[0m                                  'load_weight': True,
[36m(TaskRunner pid=89263)[0m                                  'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=89263)[0m                                  'loss_scale_factor': None,
[36m(TaskRunner pid=89263)[0m                                  'megatron': {'_target_': 'verl.workers.config.McoreEngineConfig',
[36m(TaskRunner pid=89263)[0m                                               'context_parallel_size': 1,
[36m(TaskRunner pid=89263)[0m                                               'dist_checkpointing_path': None,
[36m(TaskRunner pid=89263)[0m                                               'dist_checkpointing_prefix': '',
[36m(TaskRunner pid=89263)[0m                                               'dtype': 'bfloat16',
[36m(TaskRunner pid=89263)[0m                                               'expert_model_parallel_size': 1,
[36m(TaskRunner pid=89263)[0m                                               'expert_tensor_parallel_size': 1,
[36m(TaskRunner pid=89263)[0m                                               'forward_only': False,
[36m(TaskRunner pid=89263)[0m                                               'grad_offload': True,
[36m(TaskRunner pid=89263)[0m                                               'optimizer_offload': True,
[36m(TaskRunner pid=89263)[0m                                               'override_ddp_config': {},
[36m(TaskRunner pid=89263)[0m                                               'override_mcore_model_config': {},
[36m(TaskRunner pid=89263)[0m                                               'override_transformer_config': {'apply_rope_fusion': True,
[36m(TaskRunner pid=89263)[0m                                                                               'attention_backend': 'flash',
[36m(TaskRunner pid=89263)[0m                                                                               'gradient_accumulation_fusion': False,
[36m(TaskRunner pid=89263)[0m                                                                               'moe_permute_fusion': True,
[36m(TaskRunner pid=89263)[0m                                                                               'moe_router_dtype': 'fp32',
[36m(TaskRunner pid=89263)[0m                                                                               'recompute_granularity': 'full',
[36m(TaskRunner pid=89263)[0m                                                                               'recompute_method': 'uniform',
[36m(TaskRunner pid=89263)[0m                                                                               'recompute_modules': ['core_attn'],
[36m(TaskRunner pid=89263)[0m                                                                               'recompute_num_layers': 1},
[36m(TaskRunner pid=89263)[0m                                               'param_offload': True,
[36m(TaskRunner pid=89263)[0m                                               'pipeline_model_parallel_size': 1,
[36m(TaskRunner pid=89263)[0m                                               'seed': 42,
[36m(TaskRunner pid=89263)[0m                                               'sequence_parallel': True,
[36m(TaskRunner pid=89263)[0m                                               'tensor_model_parallel_size': 1,
[36m(TaskRunner pid=89263)[0m                                               'use_dist_checkpointing': False,
[36m(TaskRunner pid=89263)[0m                                               'use_distributed_optimizer': True,
[36m(TaskRunner pid=89263)[0m                                               'use_mbridge': True,
[36m(TaskRunner pid=89263)[0m                                               'use_remove_padding': True,
[36m(TaskRunner pid=89263)[0m                                               'vanilla_mbridge': True,
[36m(TaskRunner pid=89263)[0m                                               'virtual_pipeline_model_parallel_size': None},
[36m(TaskRunner pid=89263)[0m                                  'optim': {'_target_': 'verl.workers.config.McoreOptimizerConfig',
[36m(TaskRunner pid=89263)[0m                                            'betas': [0.9, 0.999],
[36m(TaskRunner pid=89263)[0m                                            'clip_grad': 1.0,
[36m(TaskRunner pid=89263)[0m                                            'lr': 1e-06,
[36m(TaskRunner pid=89263)[0m                                            'lr_decay_steps': None,
[36m(TaskRunner pid=89263)[0m                                            'lr_decay_style': 'constant',
[36m(TaskRunner pid=89263)[0m                                            'lr_warmup_init': 0.0,
[36m(TaskRunner pid=89263)[0m                                            'lr_warmup_steps': -1,
[36m(TaskRunner pid=89263)[0m                                            'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=89263)[0m                                            'lr_wsd_decay_steps': None,
[36m(TaskRunner pid=89263)[0m                                            'lr_wsd_decay_style': 'exponential',
[36m(TaskRunner pid=89263)[0m                                            'min_lr': 0.0,
[36m(TaskRunner pid=89263)[0m                                            'optimizer': 'adam',
[36m(TaskRunner pid=89263)[0m                                            'override_optimizer_config': {},
[36m(TaskRunner pid=89263)[0m                                            'total_training_steps': -1,
[36m(TaskRunner pid=89263)[0m                                            'use_checkpoint_opt_param_scheduler': False,
[36m(TaskRunner pid=89263)[0m                                            'weight_decay': 0.01,
[36m(TaskRunner pid=89263)[0m                                            'weight_decay_incr_style': 'constant'},
[36m(TaskRunner pid=89263)[0m                                  'policy_loss': {'_target_': 'verl.workers.config.PolicyLossConfig',
[36m(TaskRunner pid=89263)[0m                                                  'clip_cov_lb': 1.0,
[36m(TaskRunner pid=89263)[0m                                                  'clip_cov_ratio': 0.0002,
[36m(TaskRunner pid=89263)[0m                                                  'clip_cov_ub': 5.0,
[36m(TaskRunner pid=89263)[0m                                                  'kl_cov_ratio': 0.0002,
[36m(TaskRunner pid=89263)[0m                                                  'loss_mode': 'gspo',
[36m(TaskRunner pid=89263)[0m                                                  'ppo_kl_coef': 0.1},
[36m(TaskRunner pid=89263)[0m                                  'ppo_epochs': 1,
[36m(TaskRunner pid=89263)[0m                                  'ppo_max_token_len_per_gpu': 30720,
[36m(TaskRunner pid=89263)[0m                                  'ppo_micro_batch_size': None,
[36m(TaskRunner pid=89263)[0m                                  'ppo_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=89263)[0m                                  'ppo_mini_batch_size': 32,
[36m(TaskRunner pid=89263)[0m                                  'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=89263)[0m                                               'all_ranks': False,
[36m(TaskRunner pid=89263)[0m                                               'enable': False,
[36m(TaskRunner pid=89263)[0m                                               'ranks': [],
[36m(TaskRunner pid=89263)[0m                                               'save_path': 'outputs/profile',
[36m(TaskRunner pid=89263)[0m                                               'tool': None,
[36m(TaskRunner pid=89263)[0m                                               'tool_config': {'npu': {'_target_': 'verl.utils.profiler.config.NPUToolConfig',
[36m(TaskRunner pid=89263)[0m                                                                       'analysis': True,
[36m(TaskRunner pid=89263)[0m                                                                       'contents': [],
[36m(TaskRunner pid=89263)[0m                                                                       'discrete': False,
[36m(TaskRunner pid=89263)[0m                                                                       'level': 'level0'},
[36m(TaskRunner pid=89263)[0m                                                               'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=89263)[0m                                                                        'discrete': False},
[36m(TaskRunner pid=89263)[0m                                                               'torch': {'_target_': 'verl.utils.profiler.config.TorchProfilerToolConfig',
[36m(TaskRunner pid=89263)[0m                                                                         'step_end': None,
[36m(TaskRunner pid=89263)[0m                                                                         'step_start': 0},
[36m(TaskRunner pid=89263)[0m                                                               'torch_memory': {'_target_': 'verl.utils.profiler.config.TorchMemoryToolConfig',
[36m(TaskRunner pid=89263)[0m                                                                                'stack_depth': 32,
[36m(TaskRunner pid=89263)[0m                                                                                'trace_alloc_max_entries': 100000}}},
[36m(TaskRunner pid=89263)[0m                                  'rollout_n': 16,
[36m(TaskRunner pid=89263)[0m                                  'router_replay': {'_target_': 'verl.workers.config.RouterReplayConfig',
[36m(TaskRunner pid=89263)[0m                                                    'mode': 'disabled',
[36m(TaskRunner pid=89263)[0m                                                    'record_file': None,
[36m(TaskRunner pid=89263)[0m                                                    'replay_file': None},
[36m(TaskRunner pid=89263)[0m                                  'shuffle': False,
[36m(TaskRunner pid=89263)[0m                                  'strategy': 'megatron',
[36m(TaskRunner pid=89263)[0m                                  'use_dynamic_bsz': True,
[36m(TaskRunner pid=89263)[0m                                  'use_fused_kernels': False,
[36m(TaskRunner pid=89263)[0m                                  'use_kl_loss': False,
[36m(TaskRunner pid=89263)[0m                                  'use_torch_compile': True},
[36m(TaskRunner pid=89263)[0m                        'hybrid_engine': True,
[36m(TaskRunner pid=89263)[0m                        'model': {'_target_': 'verl.workers.config.HFModelConfig',
[36m(TaskRunner pid=89263)[0m                                  'custom_chat_template': None,
[36m(TaskRunner pid=89263)[0m                                  'enable_activation_offload': False,
[36m(TaskRunner pid=89263)[0m                                  'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=89263)[0m                                  'exclude_modules': None,
[36m(TaskRunner pid=89263)[0m                                  'external_lib': None,
[36m(TaskRunner pid=89263)[0m                                  'fused_kernel_options': {'impl_backend': 'torch'},
[36m(TaskRunner pid=89263)[0m                                  'hf_config_path': None,
[36m(TaskRunner pid=89263)[0m                                  'lora': {'a2a_experimental': False,
[36m(TaskRunner pid=89263)[0m                                           'adapter_path': None,
[36m(TaskRunner pid=89263)[0m                                           'alpha': 32,
[36m(TaskRunner pid=89263)[0m                                           'dropout': 0.0,
[36m(TaskRunner pid=89263)[0m                                           'dropout_position': 'pre',
[36m(TaskRunner pid=89263)[0m                                           'dtype': None,
[36m(TaskRunner pid=89263)[0m                                           'exclude_modules': [],
[36m(TaskRunner pid=89263)[0m                                           'freeze_language_model': True,
[36m(TaskRunner pid=89263)[0m                                           'freeze_vision_model': True,
[36m(TaskRunner pid=89263)[0m                                           'freeze_vision_projection': True,
[36m(TaskRunner pid=89263)[0m                                           'lora_A_init_method': 'xavier',
[36m(TaskRunner pid=89263)[0m                                           'lora_B_init_method': 'zero',
[36m(TaskRunner pid=89263)[0m                                           'rank': 0,
[36m(TaskRunner pid=89263)[0m                                           'target_modules': ['linear_qkv',
[36m(TaskRunner pid=89263)[0m                                                              'linear_proj',
[36m(TaskRunner pid=89263)[0m                                                              'linear_fc1',
[36m(TaskRunner pid=89263)[0m                                                              'linear_fc2'],
[36m(TaskRunner pid=89263)[0m                                           'type': 'lora'},
[36m(TaskRunner pid=89263)[0m                                  'lora_adapter_path': None,
[36m(TaskRunner pid=89263)[0m                                  'lora_alpha': 16,
[36m(TaskRunner pid=89263)[0m                                  'lora_rank': 0,
[36m(TaskRunner pid=89263)[0m                                  'override_config': {'model_config': {},
[36m(TaskRunner pid=89263)[0m                                                      'moe_config': {'freeze_moe_router': False}},
[36m(TaskRunner pid=89263)[0m                                  'path': 'Qwen/Qwen3-30B-A3B-Base',
[36m(TaskRunner pid=89263)[0m                                  'target_modules': 'all-linear',
[36m(TaskRunner pid=89263)[0m                                  'tokenizer_path': None,
[36m(TaskRunner pid=89263)[0m                                  'trust_remote_code': False,
[36m(TaskRunner pid=89263)[0m                                  'use_fused_kernels': False,
[36m(TaskRunner pid=89263)[0m                                  'use_liger': False,
[36m(TaskRunner pid=89263)[0m                                  'use_remove_padding': True,
[36m(TaskRunner pid=89263)[0m                                  'use_shm': False},
[36m(TaskRunner pid=89263)[0m                        'nccl_timeout': 600,
[36m(TaskRunner pid=89263)[0m                        'ref': {'_target_': 'verl.workers.config.McoreActorConfig',
[36m(TaskRunner pid=89263)[0m                                'load_weight': True,
[36m(TaskRunner pid=89263)[0m                                'log_prob_max_token_len_per_gpu': 30720,
[36m(TaskRunner pid=89263)[0m                                'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=89263)[0m                                'log_prob_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=89263)[0m                                'log_prob_use_dynamic_bsz': True,
[36m(TaskRunner pid=89263)[0m                                'megatron': {'_target_': 'verl.workers.config.McoreEngineConfig',
[36m(TaskRunner pid=89263)[0m                                             'context_parallel_size': 1,
[36m(TaskRunner pid=89263)[0m                                             'dist_checkpointing_path': None,
[36m(TaskRunner pid=89263)[0m                                             'dist_checkpointing_prefix': '',
[36m(TaskRunner pid=89263)[0m                                             'dtype': 'bfloat16',
[36m(TaskRunner pid=89263)[0m                                             'expert_model_parallel_size': 1,
[36m(TaskRunner pid=89263)[0m                                             'expert_tensor_parallel_size': 1,
[36m(TaskRunner pid=89263)[0m                                             'forward_only': True,
[36m(TaskRunner pid=89263)[0m                                             'grad_offload': False,
[36m(TaskRunner pid=89263)[0m                                             'optimizer_offload': False,
[36m(TaskRunner pid=89263)[0m                                             'override_ddp_config': {},
[36m(TaskRunner pid=89263)[0m                                             'override_mcore_model_config': {},
[36m(TaskRunner pid=89263)[0m                                             'override_transformer_config': {'apply_rope_fusion': True,
[36m(TaskRunner pid=89263)[0m                                                                             'attention_backend': 'flash',
[36m(TaskRunner pid=89263)[0m                                                                             'gradient_accumulation_fusion': False,
[36m(TaskRunner pid=89263)[0m                                                                             'moe_permute_fusion': True,
[36m(TaskRunner pid=89263)[0m                                                                             'moe_router_dtype': 'fp32',
[36m(TaskRunner pid=89263)[0m                                                                             'recompute_granularity': 'full',
[36m(TaskRunner pid=89263)[0m                                                                             'recompute_method': 'uniform',
[36m(TaskRunner pid=89263)[0m                                                                             'recompute_modules': ['core_attn'],
[36m(TaskRunner pid=89263)[0m                                                                             'recompute_num_layers': 1},
[36m(TaskRunner pid=89263)[0m                                             'param_offload': True,
[36m(TaskRunner pid=89263)[0m                                             'pipeline_model_parallel_size': 1,
[36m(TaskRunner pid=89263)[0m                                             'seed': 42,
[36m(TaskRunner pid=89263)[0m                                             'sequence_parallel': True,
[36m(TaskRunner pid=89263)[0m                                             'tensor_model_parallel_size': 1,
[36m(TaskRunner pid=89263)[0m                                             'use_dist_checkpointing': False,
[36m(TaskRunner pid=89263)[0m                                             'use_distributed_optimizer': True,
[36m(TaskRunner pid=89263)[0m                                             'use_mbridge': True,
[36m(TaskRunner pid=89263)[0m                                             'use_remove_padding': True,
[36m(TaskRunner pid=89263)[0m                                             'vanilla_mbridge': True,
[36m(TaskRunner pid=89263)[0m                                             'virtual_pipeline_model_parallel_size': None},
[36m(TaskRunner pid=89263)[0m                                'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=89263)[0m                                             'all_ranks': False,
[36m(TaskRunner pid=89263)[0m                                             'enable': False,
[36m(TaskRunner pid=89263)[0m                                             'ranks': [],
[36m(TaskRunner pid=89263)[0m                                             'save_path': 'outputs/profile',
[36m(TaskRunner pid=89263)[0m                                             'tool': None,
[36m(TaskRunner pid=89263)[0m                                             'tool_config': {'npu': {'_target_': 'verl.utils.profiler.config.NPUToolConfig',
[36m(TaskRunner pid=89263)[0m                                                                     'analysis': True,
[36m(TaskRunner pid=89263)[0m                                                                     'contents': [],
[36m(TaskRunner pid=89263)[0m                                                                     'discrete': False,
[36m(TaskRunner pid=89263)[0m                                                                     'level': 'level0'},
[36m(TaskRunner pid=89263)[0m                                                             'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=89263)[0m                                                                      'discrete': False},
[36m(TaskRunner pid=89263)[0m                                                             'torch': {'_target_': 'verl.utils.profiler.config.TorchProfilerToolConfig',
[36m(TaskRunner pid=89263)[0m                                                                       'step_end': None,
[36m(TaskRunner pid=89263)[0m                                                                       'step_start': 0},
[36m(TaskRunner pid=89263)[0m                                                             'torch_memory': {'_target_': 'verl.utils.profiler.config.TorchMemoryToolConfig',
[36m(TaskRunner pid=89263)[0m                                                                              'stack_depth': 32,
[36m(TaskRunner pid=89263)[0m                                                                              'trace_alloc_max_entries': 100000}}},
[36m(TaskRunner pid=89263)[0m                                'rollout_n': 16,
[36m(TaskRunner pid=89263)[0m                                'router_replay': {'_target_': 'verl.workers.config.RouterReplayConfig',
[36m(TaskRunner pid=89263)[0m                                                  'mode': 'disabled',
[36m(TaskRunner pid=89263)[0m                                                  'record_file': None,
[36m(TaskRunner pid=89263)[0m                                                  'replay_file': None},
[36m(TaskRunner pid=89263)[0m                                'strategy': 'megatron',
[36m(TaskRunner pid=89263)[0m                                'use_torch_compile': True},
[36m(TaskRunner pid=89263)[0m                        'rollout': {'_target_': 'verl.workers.config.RolloutConfig',
[36m(TaskRunner pid=89263)[0m                                    'agent': {'_target_': 'verl.workers.config.AgentLoopConfig',
[36m(TaskRunner pid=89263)[0m                                              'agent_loop_config_path': None,
[36m(TaskRunner pid=89263)[0m                                              'custom_async_server': {'_target_': 'verl.workers.config.CustomAsyncServerConfig',
[36m(TaskRunner pid=89263)[0m                                                                      'name': None,
[36m(TaskRunner pid=89263)[0m                                                                      'path': None},
[36m(TaskRunner pid=89263)[0m                                              'default_agent_loop': 'single_turn_agent',
[36m(TaskRunner pid=89263)[0m                                              'num_workers': 8},
[36m(TaskRunner pid=89263)[0m                                    'calculate_log_probs': False,
[36m(TaskRunner pid=89263)[0m                                    'cudagraph_capture_sizes': None,
[36m(TaskRunner pid=89263)[0m                                    'data_parallel_size': 1,
[36m(TaskRunner pid=89263)[0m                                    'disable_log_stats': True,
[36m(TaskRunner pid=89263)[0m                                    'do_sample': True,
[36m(TaskRunner pid=89263)[0m                                    'dtype': 'bfloat16',
[36m(TaskRunner pid=89263)[0m                                    'enable_chunked_prefill': True,
[36m(TaskRunner pid=89263)[0m                                    'enable_prefix_caching': True,
[36m(TaskRunner pid=89263)[0m                                    'enable_rollout_routing_replay': False,
[36m(TaskRunner pid=89263)[0m                                    'enforce_eager': False,
[36m(TaskRunner pid=89263)[0m                                    'engine_kwargs': {'sglang': {}, 'vllm': {}},
[36m(TaskRunner pid=89263)[0m                                    'expert_parallel_size': 1,
[36m(TaskRunner pid=89263)[0m                                    'free_cache_engine': True,
[36m(TaskRunner pid=89263)[0m                                    'gpu_memory_utilization': 0.8,
[36m(TaskRunner pid=89263)[0m                                    'ignore_eos': False,
[36m(TaskRunner pid=89263)[0m                                    'layer_name_map': {'gate_proj_layer_name': 'gate_up',
[36m(TaskRunner pid=89263)[0m                                                       'qkv_layer_name': 'qkv'},
[36m(TaskRunner pid=89263)[0m                                    'load_format': 'dummy',
[36m(TaskRunner pid=89263)[0m                                    'log_prob_max_token_len_per_gpu': 30720,
[36m(TaskRunner pid=89263)[0m                                    'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=89263)[0m                                    'log_prob_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=89263)[0m                                    'log_prob_use_dynamic_bsz': True,
[36m(TaskRunner pid=89263)[0m                                    'max_model_len': None,
[36m(TaskRunner pid=89263)[0m                                    'max_num_batched_tokens': 8192,
[36m(TaskRunner pid=89263)[0m                                    'max_num_seqs': 1024,
[36m(TaskRunner pid=89263)[0m                                    'mode': 'async',
[36m(TaskRunner pid=89263)[0m                                    'multi_stage_wake_up': False,
[36m(TaskRunner pid=89263)[0m                                    'multi_turn': {'_target_': 'verl.workers.config.MultiTurnConfig',
[36m(TaskRunner pid=89263)[0m                                                   'enable': False,
[36m(TaskRunner pid=89263)[0m                                                   'format': 'hermes',
[36m(TaskRunner pid=89263)[0m                                                   'interaction_config_path': None,
[36m(TaskRunner pid=89263)[0m                                                   'max_assistant_turns': None,
[36m(TaskRunner pid=89263)[0m                                                   'max_parallel_calls': 1,
[36m(TaskRunner pid=89263)[0m                                                   'max_tool_response_length': 256,
[36m(TaskRunner pid=89263)[0m                                                   'max_user_turns': None,
[36m(TaskRunner pid=89263)[0m                                                   'num_repeat_rollouts': None,
[36m(TaskRunner pid=89263)[0m                                                   'tokenization_sanity_check_mode': 'strict',
[36m(TaskRunner pid=89263)[0m                                                   'tool_config_path': None,
[36m(TaskRunner pid=89263)[0m                                                   'tool_response_truncate_side': 'middle',
[36m(TaskRunner pid=89263)[0m                                                   'use_inference_chat_template': False},
[36m(TaskRunner pid=89263)[0m                                    'n': 16,
[36m(TaskRunner pid=89263)[0m                                    'name': 'vllm',
[36m(TaskRunner pid=89263)[0m                                    'over_sample_rate': 0,
[36m(TaskRunner pid=89263)[0m                                    'pipeline_model_parallel_size': 1,
[36m(TaskRunner pid=89263)[0m                                    'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=89263)[0m                                                 'all_ranks': False,
[36m(TaskRunner pid=89263)[0m                                                 'enable': False,
[36m(TaskRunner pid=89263)[0m                                                 'ranks': [],
[36m(TaskRunner pid=89263)[0m                                                 'save_path': 'outputs/profile',
[36m(TaskRunner pid=89263)[0m                                                 'tool': None,
[36m(TaskRunner pid=89263)[0m                                                 'tool_config': {'npu': {'_target_': 'verl.utils.profiler.config.NPUToolConfig',
[36m(TaskRunner pid=89263)[0m                                                                         'analysis': True,
[36m(TaskRunner pid=89263)[0m                                                                         'contents': [],
[36m(TaskRunner pid=89263)[0m                                                                         'discrete': False,
[36m(TaskRunner pid=89263)[0m                                                                         'level': 'level0'},
[36m(TaskRunner pid=89263)[0m                                                                 'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=89263)[0m                                                                          'discrete': False},
[36m(TaskRunner pid=89263)[0m                                                                 'torch': {'_target_': 'verl.utils.profiler.config.TorchProfilerToolConfig',
[36m(TaskRunner pid=89263)[0m                                                                           'step_end': None,
[36m(TaskRunner pid=89263)[0m                                                                           'step_start': 0},
[36m(TaskRunner pid=89263)[0m                                                                 'torch_memory': {'_target_': 'verl.utils.profiler.config.TorchMemoryToolConfig',
[36m(TaskRunner pid=89263)[0m                                                                                  'stack_depth': 32,
[36m(TaskRunner pid=89263)[0m                                                                                  'trace_alloc_max_entries': 100000}}},
[36m(TaskRunner pid=89263)[0m                                    'prometheus': {'_target_': 'verl.workers.config.PrometheusConfig',
[36m(TaskRunner pid=89263)[0m                                                   'enable': False,
[36m(TaskRunner pid=89263)[0m                                                   'file': '/tmp/ray/session_latest/metrics/prometheus/prometheus.yml',
[36m(TaskRunner pid=89263)[0m                                                   'port': 9090,
[36m(TaskRunner pid=89263)[0m                                                   'served_model_name': 'Qwen/Qwen3-30B-A3B-Base'},
[36m(TaskRunner pid=89263)[0m                                    'prompt_length': 2048,
[36m(TaskRunner pid=89263)[0m                                    'quantization': None,
[36m(TaskRunner pid=89263)[0m                                    'quantization_config_file': None,
[36m(TaskRunner pid=89263)[0m                                    'response_length': 8192,
[36m(TaskRunner pid=89263)[0m                                    'skip_dump_dir': '/tmp/rollout_dump',
[36m(TaskRunner pid=89263)[0m                                    'skip_rollout': False,
[36m(TaskRunner pid=89263)[0m                                    'skip_tokenizer_init': True,
[36m(TaskRunner pid=89263)[0m                                    'temperature': 1.0,
[36m(TaskRunner pid=89263)[0m                                    'tensor_model_parallel_size': 1,
[36m(TaskRunner pid=89263)[0m                                    'top_k': -1,
[36m(TaskRunner pid=89263)[0m                                    'top_p': 1,
[36m(TaskRunner pid=89263)[0m                                    'trace': {'_target_': 'verl.workers.config.TraceConfig',
[36m(TaskRunner pid=89263)[0m                                              'backend': None,
[36m(TaskRunner pid=89263)[0m                                              'max_samples_per_step_per_worker': None,
[36m(TaskRunner pid=89263)[0m                                              'token2text': False},
[36m(TaskRunner pid=89263)[0m                                    'update_weights_bucket_megabytes': 512,
[36m(TaskRunner pid=89263)[0m                                    'val_kwargs': {'_target_': 'verl.workers.config.SamplingConfig',
[36m(TaskRunner pid=89263)[0m                                                   'do_sample': False,
[36m(TaskRunner pid=89263)[0m                                                   'n': 1,
[36m(TaskRunner pid=89263)[0m                                                   'temperature': 1.0,
[36m(TaskRunner pid=89263)[0m                                                   'top_k': -1,
[36m(TaskRunner pid=89263)[0m                                                   'top_p': 0.7}}},
[36m(TaskRunner pid=89263)[0m  'algorithm': {'_target_': 'verl.trainer.config.AlgoConfig',
[36m(TaskRunner pid=89263)[0m                'adv_estimator': 'grpo',
[36m(TaskRunner pid=89263)[0m                'gamma': 1.0,
[36m(TaskRunner pid=89263)[0m                'kl_ctrl': {'_target_': 'verl.trainer.config.KLControlConfig',
[36m(TaskRunner pid=89263)[0m                            'horizon': 10000,
[36m(TaskRunner pid=89263)[0m                            'kl_coef': 0.001,
[36m(TaskRunner pid=89263)[0m                            'target_kl': 0.1,
[36m(TaskRunner pid=89263)[0m                            'type': 'fixed'},
[36m(TaskRunner pid=89263)[0m                'kl_penalty': 'kl',
[36m(TaskRunner pid=89263)[0m                'lam': 0.95,
[36m(TaskRunner pid=89263)[0m                'norm_adv_by_std_in_grpo': True,
[36m(TaskRunner pid=89263)[0m                'pf_ppo': {'reweight_method': 'pow', 'weight_pow': 2.0},
[36m(TaskRunner pid=89263)[0m                'rollout_correction': {'bypass_mode': False,
[36m(TaskRunner pid=89263)[0m                                       'loss_type': 'ppo_clip',
[36m(TaskRunner pid=89263)[0m                                       'rollout_is': None,
[36m(TaskRunner pid=89263)[0m                                       'rollout_is_batch_normalize': False,
[36m(TaskRunner pid=89263)[0m                                       'rollout_is_threshold': 2.0,
[36m(TaskRunner pid=89263)[0m                                       'rollout_rs': None,
[36m(TaskRunner pid=89263)[0m                                       'rollout_rs_threshold': None,
[36m(TaskRunner pid=89263)[0m                                       'rollout_rs_threshold_lower': None,
[36m(TaskRunner pid=89263)[0m                                       'rollout_token_veto_threshold': None},
[36m(TaskRunner pid=89263)[0m                'use_kl_in_reward': False,
[36m(TaskRunner pid=89263)[0m                'use_pf_ppo': False},
[36m(TaskRunner pid=89263)[0m  'critic': {'_target_': 'verl.workers.config.McoreCriticConfig',
[36m(TaskRunner pid=89263)[0m             'checkpoint': {'_target_': 'verl.trainer.config.CheckpointConfig',
[36m(TaskRunner pid=89263)[0m                            'async_save': False,
[36m(TaskRunner pid=89263)[0m                            'load_contents': ['model', 'optimizer', 'extra'],
[36m(TaskRunner pid=89263)[0m                            'save_contents': ['model', 'optimizer', 'extra']},
[36m(TaskRunner pid=89263)[0m             'cliprange_value': 0.5,
[36m(TaskRunner pid=89263)[0m             'data_loader_seed': 42,
[36m(TaskRunner pid=89263)[0m             'enable': None,
[36m(TaskRunner pid=89263)[0m             'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=89263)[0m             'load_weight': True,
[36m(TaskRunner pid=89263)[0m             'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=89263)[0m             'megatron': {'_target_': 'verl.workers.config.McoreEngineConfig',
[36m(TaskRunner pid=89263)[0m                          'context_parallel_size': 1,
[36m(TaskRunner pid=89263)[0m                          'dist_checkpointing_path': None,
[36m(TaskRunner pid=89263)[0m                          'dist_checkpointing_prefix': '',
[36m(TaskRunner pid=89263)[0m                          'dtype': 'bfloat16',
[36m(TaskRunner pid=89263)[0m                          'expert_model_parallel_size': 1,
[36m(TaskRunner pid=89263)[0m                          'expert_tensor_parallel_size': None,
[36m(TaskRunner pid=89263)[0m                          'forward_only': False,
[36m(TaskRunner pid=89263)[0m                          'grad_offload': False,
[36m(TaskRunner pid=89263)[0m                          'optimizer_offload': False,
[36m(TaskRunner pid=89263)[0m                          'override_ddp_config': {},
[36m(TaskRunner pid=89263)[0m                          'override_mcore_model_config': {},
[36m(TaskRunner pid=89263)[0m                          'override_transformer_config': {'attention_backend': 'flash',
[36m(TaskRunner pid=89263)[0m                                                          'recompute_granularity': None,
[36m(TaskRunner pid=89263)[0m                                                          'recompute_method': None,
[36m(TaskRunner pid=89263)[0m                                                          'recompute_modules': ['core_attn'],
[36m(TaskRunner pid=89263)[0m                                                          'recompute_num_layers': None},
[36m(TaskRunner pid=89263)[0m                          'param_offload': False,
[36m(TaskRunner pid=89263)[0m                          'pipeline_model_parallel_size': 1,
[36m(TaskRunner pid=89263)[0m                          'seed': 42,
[36m(TaskRunner pid=89263)[0m                          'sequence_parallel': True,
[36m(TaskRunner pid=89263)[0m                          'tensor_model_parallel_size': 1,
[36m(TaskRunner pid=89263)[0m                          'use_dist_checkpointing': False,
[36m(TaskRunner pid=89263)[0m                          'use_distributed_optimizer': True,
[36m(TaskRunner pid=89263)[0m                          'use_mbridge': True,
[36m(TaskRunner pid=89263)[0m                          'use_remove_padding': True,
[36m(TaskRunner pid=89263)[0m                          'vanilla_mbridge': True,
[36m(TaskRunner pid=89263)[0m                          'virtual_pipeline_model_parallel_size': None},
[36m(TaskRunner pid=89263)[0m             'model': {'_target_': 'verl.trainer.config.BaseModelConfig',
[36m(TaskRunner pid=89263)[0m                       'external_lib': None,
[36m(TaskRunner pid=89263)[0m                       'lora': {'a2a_experimental': False,
[36m(TaskRunner pid=89263)[0m                                'adapter_path': None,
[36m(TaskRunner pid=89263)[0m                                'alpha': 32,
[36m(TaskRunner pid=89263)[0m                                'dropout': 0.0,
[36m(TaskRunner pid=89263)[0m                                'dropout_position': 'pre',
[36m(TaskRunner pid=89263)[0m                                'dtype': None,
[36m(TaskRunner pid=89263)[0m                                'exclude_modules': [],
[36m(TaskRunner pid=89263)[0m                                'freeze_language_model': True,
[36m(TaskRunner pid=89263)[0m                                'freeze_vision_model': True,
[36m(TaskRunner pid=89263)[0m                                'freeze_vision_projection': True,
[36m(TaskRunner pid=89263)[0m                                'lora_A_init_method': 'xavier',
[36m(TaskRunner pid=89263)[0m                                'lora_B_init_method': 'zero',
[36m(TaskRunner pid=89263)[0m                                'rank': 0,
[36m(TaskRunner pid=89263)[0m                                'target_modules': ['linear_qkv',
[36m(TaskRunner pid=89263)[0m                                                   'linear_proj',
[36m(TaskRunner pid=89263)[0m                                                   'linear_fc1',
[36m(TaskRunner pid=89263)[0m                                                   'linear_fc2'],
[36m(TaskRunner pid=89263)[0m                                'type': 'lora'},
[36m(TaskRunner pid=89263)[0m                       'override_config': {'model_config': {},
[36m(TaskRunner pid=89263)[0m                                           'moe_config': {'freeze_moe_router': False}},
[36m(TaskRunner pid=89263)[0m                       'path': '~/models/deepseek-llm-7b-chat',
[36m(TaskRunner pid=89263)[0m                       'tokenizer_path': 'Qwen/Qwen3-30B-A3B-Base',
[36m(TaskRunner pid=89263)[0m                       'trust_remote_code': False},
[36m(TaskRunner pid=89263)[0m             'nccl_timeout': 600,
[36m(TaskRunner pid=89263)[0m             'optim': {'_target_': 'verl.workers.config.McoreOptimizerConfig',
[36m(TaskRunner pid=89263)[0m                       'betas': [0.9, 0.999],
[36m(TaskRunner pid=89263)[0m                       'clip_grad': 1.0,
[36m(TaskRunner pid=89263)[0m                       'lr': 1e-05,
[36m(TaskRunner pid=89263)[0m                       'lr_decay_steps': None,
[36m(TaskRunner pid=89263)[0m                       'lr_decay_style': 'constant',
[36m(TaskRunner pid=89263)[0m                       'lr_warmup_init': 0.0,
[36m(TaskRunner pid=89263)[0m                       'lr_warmup_steps': -1,
[36m(TaskRunner pid=89263)[0m                       'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=89263)[0m                       'lr_wsd_decay_steps': None,
[36m(TaskRunner pid=89263)[0m                       'lr_wsd_decay_style': 'exponential',
[36m(TaskRunner pid=89263)[0m                       'min_lr': 0.0,
[36m(TaskRunner pid=89263)[0m                       'optimizer': 'adam',
[36m(TaskRunner pid=89263)[0m                       'override_optimizer_config': {},
[36m(TaskRunner pid=89263)[0m                       'total_training_steps': -1,
[36m(TaskRunner pid=89263)[0m                       'use_checkpoint_opt_param_scheduler': False,
[36m(TaskRunner pid=89263)[0m                       'weight_decay': 0.01,
[36m(TaskRunner pid=89263)[0m                       'weight_decay_incr_style': 'constant'},
[36m(TaskRunner pid=89263)[0m             'ppo_epochs': 1,
[36m(TaskRunner pid=89263)[0m             'ppo_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=89263)[0m             'ppo_micro_batch_size': None,
[36m(TaskRunner pid=89263)[0m             'ppo_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=89263)[0m             'ppo_mini_batch_size': 32,
[36m(TaskRunner pid=89263)[0m             'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=89263)[0m                          'all_ranks': False,
[36m(TaskRunner pid=89263)[0m                          'enable': False,
[36m(TaskRunner pid=89263)[0m                          'ranks': [],
[36m(TaskRunner pid=89263)[0m                          'save_path': 'outputs/profile',
[36m(TaskRunner pid=89263)[0m                          'tool': None,
[36m(TaskRunner pid=89263)[0m                          'tool_config': {'npu': {'_target_': 'verl.utils.profiler.config.NPUToolConfig',
[36m(TaskRunner pid=89263)[0m                                                  'analysis': True,
[36m(TaskRunner pid=89263)[0m                                                  'contents': [],
[36m(TaskRunner pid=89263)[0m                                                  'discrete': False,
[36m(TaskRunner pid=89263)[0m                                                  'level': 'level0'},
[36m(TaskRunner pid=89263)[0m                                          'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=89263)[0m                                                   'discrete': False},
[36m(TaskRunner pid=89263)[0m                                          'torch': {'_target_': 'verl.utils.profiler.config.TorchProfilerToolConfig',
[36m(TaskRunner pid=89263)[0m                                                    'step_end': None,
[36m(TaskRunner pid=89263)[0m                                                    'step_start': 0},
[36m(TaskRunner pid=89263)[0m                                          'torch_memory': {'_target_': 'verl.utils.profiler.config.TorchMemoryToolConfig',
[36m(TaskRunner pid=89263)[0m                                                           'stack_depth': 32,
[36m(TaskRunner pid=89263)[0m                                                           'trace_alloc_max_entries': 100000}}},
[36m(TaskRunner pid=89263)[0m             'rollout_n': 16,
[36m(TaskRunner pid=89263)[0m             'shuffle': False,
[36m(TaskRunner pid=89263)[0m             'strategy': 'megatron',
[36m(TaskRunner pid=89263)[0m             'use_dynamic_bsz': True},
[36m(TaskRunner pid=89263)[0m  'custom_reward_function': {'name': 'compute_score', 'path': None},
[36m(TaskRunner pid=89263)[0m  'data': {'apply_chat_template_kwargs': {},
[36m(TaskRunner pid=89263)[0m           'custom_cls': {'name': None, 'path': None},
[36m(TaskRunner pid=89263)[0m           'datagen': {'name': None, 'path': None},
[36m(TaskRunner pid=89263)[0m           'dataloader_num_workers': 8,
[36m(TaskRunner pid=89263)[0m           'filter_overlong_prompts': True,
[36m(TaskRunner pid=89263)[0m           'filter_overlong_prompts_workers': 64,
[36m(TaskRunner pid=89263)[0m           'image_key': 'images',
[36m(TaskRunner pid=89263)[0m           'image_patch_size': 14,
[36m(TaskRunner pid=89263)[0m           'max_prompt_length': 2048,
[36m(TaskRunner pid=89263)[0m           'max_response_length': 8192,
[36m(TaskRunner pid=89263)[0m           'prompt_key': 'prompt',
[36m(TaskRunner pid=89263)[0m           'return_full_prompt': False,
[36m(TaskRunner pid=89263)[0m           'return_multi_modal_inputs': True,
[36m(TaskRunner pid=89263)[0m           'return_raw_chat': True,
[36m(TaskRunner pid=89263)[0m           'return_raw_input_ids': False,
[36m(TaskRunner pid=89263)[0m           'reward_fn_key': 'data_source',
[36m(TaskRunner pid=89263)[0m           'sampler': {'class_name': None, 'class_path': None},
[36m(TaskRunner pid=89263)[0m           'seed': None,
[36m(TaskRunner pid=89263)[0m           'shuffle': True,
[36m(TaskRunner pid=89263)[0m           'tokenizer': None,
[36m(TaskRunner pid=89263)[0m           'tool_config_path': None,
[36m(TaskRunner pid=89263)[0m           'train_batch_size': 256,
[36m(TaskRunner pid=89263)[0m           'train_files': 'hf://datasets/BytedTsinghua-SIA/DAPO-Math-17k/data/dapo-math-17k.parquet',
[36m(TaskRunner pid=89263)[0m           'train_max_samples': -1,
[36m(TaskRunner pid=89263)[0m           'truncation': 'error',
[36m(TaskRunner pid=89263)[0m           'trust_remote_code': False,
[36m(TaskRunner pid=89263)[0m           'use_shm': False,
[36m(TaskRunner pid=89263)[0m           'val_batch_size': None,
[36m(TaskRunner pid=89263)[0m           'val_files': 'hf://datasets/BytedTsinghua-SIA/AIME-2024/data/aime-2024.parquet',
[36m(TaskRunner pid=89263)[0m           'val_max_samples': -1,
[36m(TaskRunner pid=89263)[0m           'validation_shuffle': False,
[36m(TaskRunner pid=89263)[0m           'video_key': 'videos'},
[36m(TaskRunner pid=89263)[0m  'global_profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=89263)[0m                      'global_tool_config': {'nsys': {'controller_nsight_options': {'cuda-graph-trace': 'graph',
[36m(TaskRunner pid=89263)[0m                                                                                    'cuda-memory-usage': 'true',
[36m(TaskRunner pid=89263)[0m                                                                                    'trace': 'cuda,nvtx,cublas,ucx'},
[36m(TaskRunner pid=89263)[0m                                                      'discrete': False,
[36m(TaskRunner pid=89263)[0m                                                      'worker_nsight_options': {'capture-range': 'cudaProfilerApi',
[36m(TaskRunner pid=89263)[0m                                                                                'capture-range-end': None,
[36m(TaskRunner pid=89263)[0m                                                                                'cuda-graph-trace': 'graph',
[36m(TaskRunner pid=89263)[0m                                                                                'cuda-memory-usage': 'true',
[36m(TaskRunner pid=89263)[0m                                                                                'kill': 'none',
[36m(TaskRunner pid=89263)[0m                                                                                'trace': 'cuda,nvtx,cublas,ucx'}},
[36m(TaskRunner pid=89263)[0m                                             'torch_memory': {'context': 'all',
[36m(TaskRunner pid=89263)[0m                                                              'kw_args': {},
[36m(TaskRunner pid=89263)[0m                                                              'stack_depth': 32,
[36m(TaskRunner pid=89263)[0m                                                              'stacks': 'all',
[36m(TaskRunner pid=89263)[0m                                                              'trace_alloc_max_entries': 100000}},
[36m(TaskRunner pid=89263)[0m                      'profile_continuous_steps': False,
[36m(TaskRunner pid=89263)[0m                      'save_path': 'outputs/profile',
[36m(TaskRunner pid=89263)[0m                      'steps': None,
[36m(TaskRunner pid=89263)[0m                      'tool': None},
[36m(TaskRunner pid=89263)[0m  'ray_kwargs': {'ray_init': {'num_cpus': None}, 'timeline_json_file': None},
[36m(TaskRunner pid=89263)[0m  'reward_manager': {'_target_': 'verl.trainer.config.config.RewardManagerConfig',
[36m(TaskRunner pid=89263)[0m                     'module': {'_target_': 'verl.trainer.config.config.ModuleConfig',
[36m(TaskRunner pid=89263)[0m                                'name': 'custom_reward_manager',
[36m(TaskRunner pid=89263)[0m                                'path': None},
[36m(TaskRunner pid=89263)[0m                     'name': 'dapo',
[36m(TaskRunner pid=89263)[0m                     'source': 'register'},
[36m(TaskRunner pid=89263)[0m  'reward_model': {'enable': False,
[36m(TaskRunner pid=89263)[0m                   'enable_resource_pool': False,
[36m(TaskRunner pid=89263)[0m                   'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=89263)[0m                   'launch_reward_fn_async': False,
[36m(TaskRunner pid=89263)[0m                   'load_weight': True,
[36m(TaskRunner pid=89263)[0m                   'max_length': None,
[36m(TaskRunner pid=89263)[0m                   'megatron': {'_target_': 'verl.workers.config.MegatronEngineConfig',
[36m(TaskRunner pid=89263)[0m                                'context_parallel_size': 1,
[36m(TaskRunner pid=89263)[0m                                'dist_checkpointing_path': None,
[36m(TaskRunner pid=89263)[0m                                'dist_checkpointing_prefix': '',
[36m(TaskRunner pid=89263)[0m                                'dtype': 'bfloat16',
[36m(TaskRunner pid=89263)[0m                                'expert_model_parallel_size': 1,
[36m(TaskRunner pid=89263)[0m                                'expert_tensor_parallel_size': None,
[36m(TaskRunner pid=89263)[0m                                'override_transformer_config': {'apply_rope_fusion': True,
[36m(TaskRunner pid=89263)[0m                                                                'attention_backend': 'flash',
[36m(TaskRunner pid=89263)[0m                                                                'gradient_accumulation_fusion': False,
[36m(TaskRunner pid=89263)[0m                                                                'moe_permute_fusion': True,
[36m(TaskRunner pid=89263)[0m                                                                'moe_router_dtype': 'fp32',
[36m(TaskRunner pid=89263)[0m                                                                'recompute_granularity': 'full',
[36m(TaskRunner pid=89263)[0m                                                                'recompute_method': 'uniform',
[36m(TaskRunner pid=89263)[0m                                                                'recompute_modules': ['core_attn'],
[36m(TaskRunner pid=89263)[0m                                                                'recompute_num_layers': 1},
[36m(TaskRunner pid=89263)[0m                                'param_offload': False,
[36m(TaskRunner pid=89263)[0m                                'pipeline_model_parallel_size': 1,
[36m(TaskRunner pid=89263)[0m                                'seed': 42,
[36m(TaskRunner pid=89263)[0m                                'sequence_parallel': True,
[36m(TaskRunner pid=89263)[0m                                'tensor_model_parallel_size': 1,
[36m(TaskRunner pid=89263)[0m                                'use_dist_checkpointing': False,
[36m(TaskRunner pid=89263)[0m                                'use_distributed_optimizer': False,
[36m(TaskRunner pid=89263)[0m                                'use_mbridge': True,
[36m(TaskRunner pid=89263)[0m                                'use_remove_padding': True,
[36m(TaskRunner pid=89263)[0m                                'vanilla_mbridge': True,
[36m(TaskRunner pid=89263)[0m                                'virtual_pipeline_model_parallel_size': None},
[36m(TaskRunner pid=89263)[0m                   'micro_batch_size': None,
[36m(TaskRunner pid=89263)[0m                   'micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=89263)[0m                   'model': {'external_lib': None,
[36m(TaskRunner pid=89263)[0m                             'input_tokenizer': 'Qwen/Qwen3-30B-A3B-Base',
[36m(TaskRunner pid=89263)[0m                             'override_config': {},
[36m(TaskRunner pid=89263)[0m                             'path': '~/models/FsfairX-LLaMA3-RM-v0.1',
[36m(TaskRunner pid=89263)[0m                             'trust_remote_code': False},
[36m(TaskRunner pid=89263)[0m                   'n_gpus_per_node': 8,
[36m(TaskRunner pid=89263)[0m                   'nccl_timeout': 600,
[36m(TaskRunner pid=89263)[0m                   'nnodes': 0,
[36m(TaskRunner pid=89263)[0m                   'num_workers': 1,
[36m(TaskRunner pid=89263)[0m                   'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=89263)[0m                                'all_ranks': False,
[36m(TaskRunner pid=89263)[0m                                'enable': False,
[36m(TaskRunner pid=89263)[0m                                'ranks': [],
[36m(TaskRunner pid=89263)[0m                                'save_path': 'outputs/profile',
[36m(TaskRunner pid=89263)[0m                                'tool': None,
[36m(TaskRunner pid=89263)[0m /root/verl/verl/trainer/main_ppo.py:307: UserWarning: Disabled critic as algorithm.adv_estimator != gae. If it is not intended, please set critic.enable=True
[36m(TaskRunner pid=89263)[0m   use_critic=need_critic(config),
[36m(TaskRunner pid=89263)[0m <string>:35: UserWarning: set sequence parallel to false as TP size is 1
[36m(TaskRunner pid=89263)[0m /root/verl/verl/utils/profiler/config.py:49: UserWarning: Torch profiler tool config is not fully supported now.
[36m(TaskRunner pid=89263)[0m   warnings.warn("Torch profiler tool config is not fully supported now.", stacklevel=1)
[36m(TaskRunner pid=89263)[0m Setting TOKENIZERS_PARALLELISM=false for forked processes.
[36m(TaskRunner pid=89263)[0m WARNING:2025-12-23 20:23:45,544:Setting TOKENIZERS_PARALLELISM=false for forked processes.
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):   0%|          | 0/1791700 [00:00<?, ? examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):   0%|          | 1000/1791700 [00:00<22:18, 1337.72 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):   0%|          | 3000/1791700 [00:01<10:01, 2975.22 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):   1%|          | 14000/1791700 [00:01<01:45, 16904.52 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):   1%|          | 19000/1791700 [00:01<01:21, 21834.08 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):   1%|▏         | 24000/1791700 [00:01<01:17, 22873.74 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):   2%|▏         | 31000/1791700 [00:01<01:02, 28312.57 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):   2%|▏         | 35000/1791700 [00:01<00:58, 30280.41 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):   2%|▏         | 40000/1791700 [00:01<00:51, 34006.55 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):   3%|▎         | 46000/1791700 [00:02<00:46, 37766.54 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):   3%|▎         | 55000/1791700 [00:02<00:38, 45172.01 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):   4%|▎         | 64000/1791700 [00:02<00:34, 50435.81 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):   4%|▍         | 73000/1791700 [00:02<00:32, 53162.62 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):   4%|▍         | 80000/1791700 [00:02<00:33, 51269.02 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):   5%|▌         | 92000/1791700 [00:02<00:28, 59650.58 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):   6%|▌         | 102000/1791700 [00:02<00:27, 62179.75 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):   6%|▌         | 111000/1791700 [00:03<00:27, 60434.37 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):   7%|▋         | 124000/1791700 [00:03<00:24, 66991.81 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):   7%|▋         | 133000/1791700 [00:03<00:26, 62229.14 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):   8%|▊         | 146000/1791700 [00:03<00:24, 66595.57 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):   9%|▉         | 160000/1791700 [00:03<00:22, 71316.81 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  10%|▉         | 172000/1791700 [00:03<00:22, 70484.15 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  10%|█         | 186000/1791700 [00:04<00:21, 73923.70 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  11%|█         | 200000/1791700 [00:04<00:20, 77605.66 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  12%|█▏        | 212000/1791700 [00:04<00:18, 85104.42 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  12%|█▏        | 222000/1791700 [00:04<00:18, 84085.91 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  13%|█▎        | 232000/1791700 [00:04<00:18, 83824.34 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  13%|█▎        | 241000/1791700 [00:04<00:19, 81384.91 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  14%|█▍        | 250000/1791700 [00:04<00:19, 78459.09 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  15%|█▍        | 262000/1791700 [00:05<00:18, 84226.89 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  15%|█▌        | 272000/1791700 [00:05<00:17, 85623.31 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  16%|█▌        | 282000/1791700 [00:05<00:17, 84143.87 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  16%|█▋        | 293000/1791700 [00:05<00:17, 86776.62 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  17%|█▋        | 302000/1791700 [00:05<00:17, 87072.62 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  17%|█▋        | 312000/1791700 [00:05<00:16, 90513.80 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  18%|█▊        | 322000/1791700 [00:05<00:16, 88552.98 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  18%|█▊        | 331000/1791700 [00:05<00:17, 85042.13 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  19%|█▉        | 343000/1791700 [00:05<00:16, 89661.32 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  20%|█▉        | 352000/1791700 [00:06<00:16, 86832.74 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  20%|██        | 361000/1791700 [00:06<00:16, 86029.42 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  21%|██        | 373000/1791700 [00:06<00:15, 94023.70 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  21%|██▏       | 383000/1791700 [00:06<00:16, 84887.09 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  22%|██▏       | 392000/1791700 [00:06<00:16, 84599.68 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  22%|██▏       | 403000/1791700 [00:06<00:15, 90610.90 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  23%|██▎       | 413000/1791700 [00:06<00:17, 80181.04 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  24%|██▎       | 423000/1791700 [00:06<00:16, 84962.97 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  24%|██▍       | 433000/1791700 [00:06<00:15, 88265.65 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  25%|██▍       | 443000/1791700 [00:07<00:15, 87293.70 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  25%|██▌       | 452000/1791700 [00:07<00:15, 85755.00 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  26%|██▌       | 462000/1791700 [00:07<00:15, 87743.05 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  26%|██▋       | 473000/1791700 [00:07<00:15, 87827.99 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  27%|██▋       | 482000/1791700 [00:07<00:15, 83236.02 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  28%|██▊       | 493000/1791700 [00:07<00:14, 90021.19 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  28%|██▊       | 503000/1791700 [00:07<00:14, 89669.58 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  29%|██▊       | 513000/1791700 [00:07<00:15, 80125.68 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  29%|██▉       | 526000/1791700 [00:08<00:13, 92110.83 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  30%|██▉       | 536000/1791700 [00:08<00:14, 86657.20 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  30%|███       | 545000/1791700 [00:08<00:15, 80973.48 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  31%|███       | 556000/1791700 [00:08<00:14, 85326.85 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  32%|███▏      | 567000/1791700 [00:08<00:13, 87569.06 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  32%|███▏      | 576000/1791700 [00:08<00:14, 82681.55 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  33%|███▎      | 586000/1791700 [00:08<00:14, 85796.94 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  33%|███▎      | 597000/1791700 [00:08<00:13, 90211.29 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  34%|███▍      | 607000/1791700 [00:09<00:14, 82002.90 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  34%|███▍      | 617000/1791700 [00:09<00:13, 84832.31 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  35%|███▌      | 632000/1791700 [00:09<00:12, 90032.86 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  36%|███▌      | 642000/1791700 [00:09<00:13, 82774.84 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  36%|███▋      | 651000/1791700 [00:09<00:13, 83819.57 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  37%|███▋      | 663000/1791700 [00:09<00:12, 86835.07 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  38%|███▊      | 672000/1791700 [00:09<00:13, 83090.19 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  38%|███▊      | 681000/1791700 [00:09<00:13, 83773.81 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  39%|███▊      | 693000/1791700 [00:09<00:12, 88887.31 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  39%|███▉      | 702000/1791700 [00:10<00:13, 82237.39 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  40%|███▉      | 711000/1791700 [00:10<00:13, 79783.84 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  40%|████      | 723000/1791700 [00:10<00:13, 81573.95 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  41%|████      | 732000/1791700 [00:10<00:13, 77303.72 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  41%|████▏     | 740000/1791700 [00:10<00:13, 75165.25 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  42%|████▏     | 751000/1791700 [00:10<00:13, 76070.51 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  43%|████▎     | 762000/1791700 [00:10<00:12, 80550.47 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  43%|████▎     | 772000/1791700 [00:11<00:12, 81140.40 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  44%|████▎     | 782000/1791700 [00:11<00:12, 82234.81 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  44%|████▍     | 791000/1791700 [00:11<00:12, 80278.91 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  45%|████▍     | 800000/1791700 [00:11<00:11, 82666.08 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  45%|████▌     | 809000/1791700 [00:11<00:11, 82568.34 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  46%|████▌     | 818000/1791700 [00:11<00:12, 75651.26 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  46%|████▌     | 826000/1791700 [00:11<00:12, 76103.97 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  47%|████▋     | 836000/1791700 [00:11<00:11, 82261.17 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  47%|████▋     | 845000/1791700 [00:11<00:11, 82410.22 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  48%|████▊     | 854000/1791700 [00:12<00:13, 71584.82 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  48%|████▊     | 867000/1791700 [00:12<00:10, 85805.97 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  49%|████▉     | 877000/1791700 [00:12<00:12, 71986.09 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  50%|████▉     | 887000/1791700 [00:12<00:11, 78165.10 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  50%|█████     | 897000/1791700 [00:12<00:11, 75614.29 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  51%|█████     | 906000/1791700 [00:12<00:13, 66839.52 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  51%|█████▏    | 920000/1791700 [00:12<00:10, 80484.20 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  52%|█████▏    | 930000/1791700 [00:13<00:10, 85122.58 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  52%|█████▏    | 940000/1791700 [00:13<00:10, 79057.43 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  53%|█████▎    | 949000/1791700 [00:13<00:10, 80187.59 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  54%|█████▎    | 961000/1791700 [00:13<00:09, 88331.48 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  54%|█████▍    | 971000/1791700 [00:13<00:09, 84448.97 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  55%|█████▍    | 980000/1791700 [00:13<00:10, 77432.57 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  55%|█████▌    | 992000/1791700 [00:13<00:09, 86909.87 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  56%|█████▌    | 1002000/1791700 [00:13<00:09, 85684.42 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  56%|█████▋    | 1011000/1791700 [00:14<00:10, 77832.56 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  57%|█████▋    | 1024000/1791700 [00:14<00:08, 88798.56 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  58%|█████▊    | 1034000/1791700 [00:14<00:09, 76638.88 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  58%|█████▊    | 1043000/1791700 [00:14<00:09, 77397.81 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  59%|█████▉    | 1054000/1791700 [00:14<00:09, 81592.12 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  59%|█████▉    | 1063000/1791700 [00:14<00:09, 73786.38 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  60%|█████▉    | 1071000/1791700 [00:14<00:10, 71556.67 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  60%|██████    | 1082000/1791700 [00:14<00:09, 78167.04 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  61%|██████    | 1091000/1791700 [00:15<00:09, 72997.81 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  61%|██████▏   | 1100000/1791700 [00:15<00:09, 76399.28 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  62%|██████▏   | 1108000/1791700 [00:15<00:09, 72841.49 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  62%|██████▏   | 1116000/1791700 [00:15<00:09, 68908.68 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  63%|██████▎   | 1126000/1791700 [00:15<00:08, 74620.33 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  63%|██████▎   | 1134000/1791700 [00:15<00:09, 68224.46 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  64%|██████▍   | 1145000/1791700 [00:15<00:08, 74207.04 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  65%|██████▍   | 1156000/1791700 [00:15<00:07, 82018.62 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  65%|██████▌   | 1165000/1791700 [00:16<00:08, 75156.04 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  66%|██████▌   | 1175000/1791700 [00:16<00:07, 81131.15 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  66%|██████▌   | 1184000/1791700 [00:16<00:07, 79426.47 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  67%|██████▋   | 1193000/1791700 [00:16<00:07, 75991.25 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  67%|██████▋   | 1205000/1791700 [00:16<00:06, 86697.17 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  68%|██████▊   | 1214000/1791700 [00:16<00:07, 77522.90 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  68%|██████▊   | 1224000/1791700 [00:16<00:06, 81962.94 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  69%|██████▉   | 1236000/1791700 [00:16<00:06, 84641.13 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  69%|██████▉   | 1245000/1791700 [00:17<00:06, 81923.25 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  70%|██████▉   | 1254000/1791700 [00:17<00:06, 79943.56 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  71%|███████   | 1266000/1791700 [00:17<00:05, 90157.09 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  71%|███████   | 1276000/1791700 [00:17<00:06, 77743.23 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  72%|███████▏  | 1285000/1791700 [00:17<00:06, 79057.59 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  72%|███████▏  | 1297000/1791700 [00:17<00:05, 88558.26 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  73%|███████▎  | 1307000/1791700 [00:17<00:05, 81927.33 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  73%|███████▎  | 1316000/1791700 [00:17<00:06, 77829.05 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  74%|███████▍  | 1329000/1791700 [00:18<00:05, 90717.24 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  75%|███████▍  | 1339000/1791700 [00:18<00:05, 76997.40 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  75%|███████▌  | 1350000/1791700 [00:18<00:05, 83486.27 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  76%|███████▌  | 1362000/1791700 [00:18<00:04, 90268.61 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  77%|███████▋  | 1372000/1791700 [00:18<00:05, 76148.02 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  77%|███████▋  | 1381000/1791700 [00:18<00:05, 77788.21 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  78%|███████▊  | 1395000/1791700 [00:18<00:04, 88549.48 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  78%|███████▊  | 1405000/1791700 [00:18<00:05, 77007.43 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  79%|███████▉  | 1414000/1791700 [00:19<00:04, 78093.48 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  80%|███████▉  | 1427000/1791700 [00:19<00:04, 89752.62 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  80%|████████  | 1436991/1791700 [00:19<00:04, 79473.76 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  81%|████████  | 1445991/1791700 [00:19<00:04, 79650.33 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  81%|████████▏ | 1459991/1791700 [00:19<00:03, 90551.08 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  82%|████████▏ | 1469991/1791700 [00:19<00:03, 81653.96 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  83%|████████▎ | 1478991/1791700 [00:19<00:03, 83125.42 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  83%|████████▎ | 1490991/1791700 [00:19<00:03, 92254.39 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  84%|████████▍ | 1500991/1791700 [00:20<00:03, 81903.41 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  84%|████████▍ | 1509991/1791700 [00:20<00:03, 80227.89 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  85%|████████▌ | 1522982/1791700 [00:20<00:02, 89647.87 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  86%|████████▌ | 1532982/1791700 [00:20<00:03, 82922.15 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  86%|████████▌ | 1541973/1791700 [00:20<00:03, 79687.32 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  87%|████████▋ | 1554973/1791700 [00:20<00:02, 82019.20 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  87%|████████▋ | 1565964/1791700 [00:20<00:02, 87523.16 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  88%|████████▊ | 1574955/1791700 [00:20<00:02, 86895.07 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  88%|████████▊ | 1583955/1791700 [00:21<00:02, 83436.15 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  89%|████████▉ | 1592946/1791700 [00:21<00:02, 81425.61 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  89%|████████▉ | 1601946/1791700 [00:21<00:02, 79691.69 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  90%|█████████ | 1612946/1791700 [00:21<00:02, 83608.00 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  91%|█████████ | 1621937/1791700 [00:21<00:02, 75262.91 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  91%|█████████ | 1632937/1791700 [00:21<00:01, 83038.86 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  92%|█████████▏| 1641928/1791700 [00:21<00:01, 82898.98 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  92%|█████████▏| 1650910/1791700 [00:21<00:01, 76583.90 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  93%|█████████▎| 1662892/1791700 [00:22<00:01, 84067.17 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  93%|█████████▎| 1671892/1791700 [00:22<00:01, 75391.41 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  94%|█████████▍| 1680874/1791700 [00:22<00:01, 75873.40 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  94%|█████████▍| 1689865/1791700 [00:22<00:01, 77757.25 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  95%|█████████▍| 1697865/1791700 [00:22<00:01, 72950.11 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  95%|█████████▌| 1707856/1791700 [00:22<00:01, 79534.03 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  96%|█████████▌| 1716847/1791700 [00:22<00:00, 76901.00 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  96%|█████████▋| 1724847/1791700 [00:22<00:00, 71735.94 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  97%|█████████▋| 1733847/1791700 [00:23<00:00, 73094.02 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  97%|█████████▋| 1741838/1791700 [00:23<00:00, 68276.89 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  98%|█████████▊| 1750819/1791700 [00:23<00:00, 72525.12 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  98%|█████████▊| 1758800/1791700 [00:23<00:00, 64810.24 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  99%|█████████▊| 1765780/1791700 [00:23<00:00, 56754.53 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  99%|█████████▉| 1772760/1791700 [00:23<00:00, 56748.98 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  99%|█████████▉| 1778750/1791700 [00:23<00:00, 48275.27 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32): 100%|█████████▉| 1784730/1791700 [00:24<00:00, 39509.80 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32): 100%|█████████▉| 1789710/1791700 [00:24<00:00, 22034.07 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32): 100%|██████████| 1791700/1791700 [00:25<00:00, 70904.73 examples/s]
[36m(TaskRunner pid=89263)[0m Setting TOKENIZERS_PARALLELISM=false for forked processes.
[36m(TaskRunner pid=89263)[0m WARNING:2025-12-23 20:24:11,736:Setting TOKENIZERS_PARALLELISM=false for forked processes.
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):   0%|          | 0/960 [00:00<?, ? examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):   3%|▎         | 30/960 [00:00<00:18, 51.48 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  12%|█▎        | 120/960 [00:00<00:04, 186.48 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  19%|█▉        | 180/960 [00:00<00:03, 236.75 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  25%|██▌       | 240/960 [00:01<00:02, 253.41 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  31%|███▏      | 300/960 [00:01<00:02, 310.22 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  38%|███▊      | 360/960 [00:01<00:01, 334.20 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  44%|████▍     | 420/960 [00:01<00:01, 350.39 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  50%|█████     | 480/960 [00:01<00:01, 343.07 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  56%|█████▋    | 540/960 [00:01<00:01, 355.48 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  62%|██████▎   | 600/960 [00:02<00:01, 341.66 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  69%|██████▉   | 660/960 [00:02<00:00, 355.49 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  75%|███████▌  | 720/960 [00:02<00:00, 352.23 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  81%|████████▏ | 780/960 [00:02<00:00, 360.52 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  88%|████████▊ | 840/960 [00:02<00:00, 359.91 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32):  94%|█████████▍| 900/960 [00:02<00:00, 360.99 examples/s]
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32): 100%|██████████| 960/960 [00:03<00:00, 362.80 examples/s]
[36m(TaskRunner pid=89263)[0m                                'tool_config': {'npu': {'_target_': 'verl.utils.profiler.config.NPUToolConfig',
[36m(TaskRunner pid=89263)[0m                                                        'analysis': True,
[36m(TaskRunner pid=89263)[0m                                                        'contents': [],
[36m(TaskRunner pid=89263)[0m                                                        'discrete': False,
[36m(TaskRunner pid=89263)[0m                                                        'level': 'level0'},
[36m(TaskRunner pid=89263)[0m                                                'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=89263)[0m                                                         'discrete': False},
[36m(TaskRunner pid=89263)[0m                                                'torch': {'_target_': 'verl.utils.profiler.config.TorchProfilerToolConfig',
[36m(TaskRunner pid=89263)[0m                                                          'step_end': None,
[36m(TaskRunner pid=89263)[0m                                                          'step_start': 0},
[36m(TaskRunner pid=89263)[0m                                                'torch_memory': {'_target_': 'verl.utils.profiler.config.TorchMemoryToolConfig',
[36m(TaskRunner pid=89263)[0m                                                                 'stack_depth': 32,
[36m(TaskRunner pid=89263)[0m                                                                 'trace_alloc_max_entries': 100000}}},
[36m(TaskRunner pid=89263)[0m                   'reward_kwargs': {'max_resp_len': 8192,
[36m(TaskRunner pid=89263)[0m                                     'overlong_buffer_cfg': {'enable': True,
[36m(TaskRunner pid=89263)[0m                                                             'len': 4096,
[36m(TaskRunner pid=89263)[0m                                                             'log': False,
[36m(TaskRunner pid=89263)[0m                                                             'penalty_factor': 1.0}},
[36m(TaskRunner pid=89263)[0m                   'reward_loop_class_name': None,
[36m(TaskRunner pid=89263)[0m                   'reward_loop_module_path': None,
[36m(TaskRunner pid=89263)[0m                   'reward_loop_source': 'register',
[36m(TaskRunner pid=89263)[0m                   'reward_manager': 'dapo',
[36m(TaskRunner pid=89263)[0m                   'rollout': {'_target_': 'verl.workers.config.RolloutConfig',
[36m(TaskRunner pid=89263)[0m                               'cudagraph_capture_sizes': None,
[36m(TaskRunner pid=89263)[0m                               'data_parallel_size': 1,
[36m(TaskRunner pid=89263)[0m                               'disable_log_stats': True,
[36m(TaskRunner pid=89263)[0m                               'dtype': 'bfloat16',
[36m(TaskRunner pid=89263)[0m                               'enable_chunked_prefill': True,
[36m(TaskRunner pid=89263)[0m                               'enable_prefix_caching': True,
[36m(TaskRunner pid=89263)[0m                               'enforce_eager': True,
[36m(TaskRunner pid=89263)[0m                               'engine_kwargs': {},
[36m(TaskRunner pid=89263)[0m                               'expert_parallel_size': 1,
[36m(TaskRunner pid=89263)[0m                               'free_cache_engine': True,
[36m(TaskRunner pid=89263)[0m                               'gpu_memory_utilization': 0.5,
[36m(TaskRunner pid=89263)[0m                               'limit_images': None,
[36m(TaskRunner pid=89263)[0m                               'load_format': 'auto',
[36m(TaskRunner pid=89263)[0m                               'max_model_len': None,
[36m(TaskRunner pid=89263)[0m                               'max_num_batched_tokens': 8192,
[36m(TaskRunner pid=89263)[0m                               'max_num_seqs': 1024,
[36m(TaskRunner pid=89263)[0m                               'name': '???',
[36m(TaskRunner pid=89263)[0m                               'prompt_length': 2048,
[36m(TaskRunner pid=89263)[0m                               'response_length': 2048,
[36m(TaskRunner pid=89263)[0m                               'skip_tokenizer_init': False,
[36m(TaskRunner pid=89263)[0m                               'tensor_model_parallel_size': 2},
[36m(TaskRunner pid=89263)[0m                   'sandbox_fusion': {'max_concurrent': 64,
[36m(TaskRunner pid=89263)[0m                                      'memory_limit_mb': 1024,
[36m(TaskRunner pid=89263)[0m                                      'url': None},
[36m(TaskRunner pid=89263)[0m                   'strategy': 'megatron',
[36m(TaskRunner pid=89263)[0m                   'use_dynamic_bsz': True,
[36m(TaskRunner pid=89263)[0m                   'use_reward_loop': True},
[36m(TaskRunner pid=89263)[0m  'trainer': {'balance_batch': True,
[36m(TaskRunner pid=89263)[0m              'critic_warmup': 0,
[36m(TaskRunner pid=89263)[0m              'default_hdfs_dir': None,
[36m(TaskRunner pid=89263)[0m              'default_local_dir': '/root/FIM-RLVR-LEAN4/checkpoint/wuxibin_gspo/qwen3-30B-base-grpo-megatron',
[36m(TaskRunner pid=89263)[0m              'del_local_ckpt_after_load': False,
[36m(TaskRunner pid=89263)[0m              'device': 'cuda',
[36m(TaskRunner pid=89263)[0m              'esi_redundant_time': 0,
[36m(TaskRunner pid=89263)[0m              'experiment_name': 'qwen3-30B-base-grpo-megatron',
[36m(TaskRunner pid=89263)[0m              'log_val_generations': 100,
[36m(TaskRunner pid=89263)[0m              'logger': ['console', 'wandb'],
[36m(TaskRunner pid=89263)[0m              'max_actor_ckpt_to_keep': None,
[36m(TaskRunner pid=89263)[0m              'max_critic_ckpt_to_keep': None,
[36m(TaskRunner pid=89263)[0m              'n_gpus_per_node': 1,
[36m(TaskRunner pid=89263)[0m              'nnodes': 1,
[36m(TaskRunner pid=89263)[0m              'project_name': 'wuxibin_gspo',
[36m(TaskRunner pid=89263)[0m              'ray_wait_register_center_timeout': 300,
[36m(TaskRunner pid=89263)[0m              'resume_from_path': None,
[36m(TaskRunner pid=89263)[0m              'resume_mode': 'auto',
[36m(TaskRunner pid=89263)[0m              'rollout_data_dir': None,
[36m(TaskRunner pid=89263)[0m              'save_freq': -1,
[36m(TaskRunner pid=89263)[0m              'test_freq': 10,
[36m(TaskRunner pid=89263)[0m              'total_epochs': 10,
[36m(TaskRunner pid=89263)[0m              'total_training_steps': 500,
[36m(TaskRunner pid=89263)[0m              'use_legacy_worker_impl': 'disable',
[36m(TaskRunner pid=89263)[0m              'val_before_train': False},
[36m(TaskRunner pid=89263)[0m  'transfer_queue': {'enable': False}}
[36m(TaskRunner pid=89263)[0m [validate_config] All configuration checks passed successfully!
[36m(TaskRunner pid=89263)[0m Using dataset class: RLHFDataset
[36m(TaskRunner pid=89263)[0m dataset len: 1791700
[36m(TaskRunner pid=89263)[0m filter dataset len: 1791700
[36m(TaskRunner pid=89263)[0m Using dataset class: RLHFDataset
[36m(TaskRunner pid=89263)[0m dataset len: 960
[36m(TaskRunner pid=89263)[0m filter dataset len: 960
[36m(TaskRunner pid=89263)[0m Size of train dataloader: 6998, Size of val dataloader: 1
[36m(TaskRunner pid=89263)[0m Total training steps: 500
[36m(TaskRunner pid=89263)[0m colocated worker base class <class 'verl.single_controller.base.worker.Worker'>
[36m(TaskRunner pid=89263)[0m bind role actor_rollout method chat_completion to class <class 'verl.single_controller.ray.base.create_colocated_worker_cls.<locals>.WorkerDict'>
[36m(TaskRunner pid=89263)[0m bind role actor_rollout method generate to class <class 'verl.single_controller.ray.base.create_colocated_worker_cls.<locals>.WorkerDict'>
[36m(TaskRunner pid=89263)[0m bind role actor_rollout method get_zeromq_address to class <class 'verl.single_controller.ray.base.create_colocated_worker_cls.<locals>.WorkerDict'>
[36m(TaskRunner pid=89263)[0m Filtering prompts longer than 2048 tokens (num_proc=32): 100%|██████████| 960/960 [00:03<00:00, 296.13 examples/s]
[36m(TaskRunner pid=89263)[0m /root/verl/verl/trainer/ppo/ray_trainer.py:335: UserWarning: Disabled critic as algorithm.adv_estimator != gae. If it is not intended, please set critic.enable=True
[36m(TaskRunner pid=89263)[0m   self.use_critic = need_critic(self.config)
[36m(pid=91821)[0m /root/anaconda3/envs/py310/lib/python3.10/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
[36m(pid=91821)[0m   import pynvml  # type: ignore[import]
[36m(WorkerDict pid=91821)[0m <string>:35: UserWarning: set sequence parallel to false as TP size is 1
[36m(WorkerDict pid=91821)[0m /root/verl/verl/utils/profiler/config.py:49: UserWarning: Torch profiler tool config is not fully supported now.
[36m(WorkerDict pid=91821)[0m   warnings.warn("Torch profiler tool config is not fully supported now.", stacklevel=1)
[36m(WorkerDict pid=91821)[0m WARNING:2025-12-23 20:24:21,504:fused_indices_to_multihot has reached end of life. Please migrate to a non-experimental function.
[36m(WorkerDict pid=91821)[0m /root/anaconda3/envs/py310/lib/python3.10/site-packages/megatron/core/transformer/transformer_config.py:1512: UserWarning: Using a large number of experts (e.g. >=32) without fp32 routing. Consider enabling moe_router_dtype for better numerical stability.
[36m(WorkerDict pid=91821)[0m   warnings.warn(
[36m(TaskRunner pid=89263)[0m bind role actor_rollout method sleep to class <class 'verl.single_controller.ray.base.create_colocated_worker_cls.<locals>.WorkerDict'>
[36m(TaskRunner pid=89263)[0m bind role actor_rollout method wake_up to class <class 'verl.single_controller.ray.base.create_colocated_worker_cls.<locals>.WorkerDict'>
[36m(WorkerDict pid=91821)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=91821)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=91821)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=91821)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=91821)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=91821)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=91821)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=91821)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=91821)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=91821)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=91821)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=91821)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=91821)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=91821)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=91821)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=91821)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=91821)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=91821)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=91821)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=91821)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=91821)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=91821)[0m TF config: TransformerConfig(tensor_model_parallel_size=1, pipeline_model_parallel_comm_backend=None, pipeline_model_parallel_size=1, virtual_pipeline_model_parallel_size=None, sequence_parallel=False, context_parallel_size=1, hierarchical_context_parallel_sizes=None, expert_model_parallel_size=1, expert_tensor_parallel_size=1, moe_extended_tp=False, perform_initialization=True, use_cpu_initialization=False, fp16=False, bf16=True, params_dtype=torch.bfloat16, timers=None, finalize_model_grads_func=None, grad_scale_func=None, no_sync_func=None, grad_sync_func=None, param_sync_func=None, deterministic_mode=False, enable_autocast=False, autocast_dtype=torch.bfloat16, num_microbatches_with_partial_activation_checkpoints=None, gradient_accumulation_fusion=False, async_tensor_model_parallel_allreduce=False, use_te_rng_tracker=False, tp_comm_overlap=False, tp_comm_bulk_wgrad=True, tp_comm_bulk_dgrad=True, tp_comm_overlap_ag=True, tp_comm_overlap_rs=True, tp_comm_overlap_rs_dgrad=False, tp_comm_split_ag=True, tp_comm_atomic_ag=False, tp_comm_split_rs=True, tp_comm_atomic_rs=False, cross_entropy_loss_fusion=False, cross_entropy_fusion_impl='native', tp_comm_overlap_disable_qkv=False, tp_comm_overlap_disable_fc1=False, tp_comm_bootstrap_backend='nccl', overlap_moe_expert_parallel_comm=False, delay_wgrad_compute=False, pipeline_dtype=torch.bfloat16, variable_seq_lengths=True, overlap_p2p_comm=False, batch_p2p_comm=False, batch_p2p_sync=True, use_ring_exchange_p2p=False, deallocate_pipeline_outputs=False, defer_embedding_wgrad_compute=False, wgrad_deferral_limit=0, overlap_p2p_comm_warmup_flush=False, microbatch_group_size_per_vp_stage=1, cpu_offloading=False, cpu_offloading_num_layers=0, _cpu_offloading_context=None, cpu_offloading_activations=True, cpu_offloading_weights=False, cpu_offloading_double_buffering=False, barrier_with_L1_time=True, num_layers=48, mtp_num_layers=None, mtp_loss_scaling_factor=None, num_layers_in_first_pipeline_stage=None, num_layers_in_last_pipeline_stage=None, pipeline_model_parallel_layout=None, account_for_embedding_in_pipeline_split=False, account_for_loss_in_pipeline_split=False, hidden_size=2048, num_attention_heads=32, attention_backend=<AttnBackend.flash: 1>, softmax_scale=None, softmax_type='vanilla', num_query_groups=4, ffn_hidden_size=6144, kv_channels=128, hidden_dropout=0.0, attention_dropout=0.0, fp32_residual_connection=False, apply_residual_connection_post_layernorm=False, layernorm_epsilon=1e-06, layernorm_zero_centered_gamma=False, add_bias_linear=False, add_qkv_bias=False, gated_linear_unit=True, activation_func=<function silu at 0x7b7fa80b3010>, activation_func_fp8_input_store=False, glu_linear_offset=0.0, activation_func_clamp_value=None, num_moe_experts=128, rotary_interleaved=False, window_size=None, window_attn_skip_freq=None, normalization='RMSNorm', qk_layernorm=True, test_mode=False, calculate_per_token_loss=False, multi_latent_attention=False, no_rope_freq=None, moe_deepep_num_sms=20, init_method=functools.partial(<function normal_ at 0x7b7fa81571c0>, mean=0.0, std=0.02), output_layer_init_method=functools.partial(<function normal_ at 0x7b7fa81571c0>, mean=0.0, std=0.0020412414523193153), init_method_std=0.02, embedding_init_method=functools.partial(<function normal_ at 0x7b7fa81571c0>, mean=0.0, std=0.02), embedding_init_method_std=0.02, init_model_with_meta_device=False, apply_query_key_layer_scaling=False, attention_softmax_in_fp32=True, disable_bf16_reduced_precision_matmul=False, bias_activation_fusion=True, masked_softmax_fusion=True, persist_layer_norm=True, memory_efficient_layer_norm=False, bias_dropout_fusion=True, apply_rope_fusion=True, use_fused_weighted_squared_relu=False, fused_single_qkv_rope=False, recompute_granularity='full', recompute_method='uniform', recompute_num_layers=1, distribute_saved_activations=None, recompute_modules=['core_attn'], fp8=None, fp8_recipe='delayed', fp8_param=False, fp8_margin=0, fp8_interval=1, fp8_amax_history_len=1, fp8_amax_compute_algo='most_recent', fp8_wgrad=True, fp8_dot_product_attention=False, fp8_multi_head_attention=False, tp_only_amax_red=False, first_last_layers_bf16=False, num_layers_at_start_in_bf16=1, num_layers_at_end_in_bf16=1, use_kitchen=False, fp4=None, fp4_recipe='nvfp4', fp4_param=False, moe_shared_expert_intermediate_size=None, moe_shared_expert_overlap=False, moe_layer_freq=1, moe_ffn_hidden_size=768, moe_router_load_balancing_type='none', moe_router_topk=8, moe_router_topk_limited_devices=None, moe_router_padding_for_fp8=False, moe_router_num_groups=None, moe_router_group_topk=None, moe_router_pre_softmax=False, moe_router_topk_scaling_factor=None, moe_router_score_function='softmax', moe_router_dtype='fp32', moe_router_enable_expert_bias=False, moe_router_bias_update_rate=0.001, moe_router_force_load_balancing=False, moe_grouped_gemm=True, moe_use_legacy_grouped_gemm=False, moe_aux_loss_coeff=0.001, moe_z_loss_coeff=None, moe_input_jitter_eps=None, moe_token_dropping=False, moe_token_dispatcher_type='alltoall', moe_enable_deepep=False, moe_per_layer_logging=False, moe_expert_capacity_factor=None, moe_pad_expert_input_to_capacity=False, moe_token_drop_policy='probs', moe_layer_recompute=False, moe_permute_fusion=True, moe_router_fusion=False, moe_apply_probs_on_input=False, cp_comm_type=None, enable_cuda_graph=False, cuda_graph_use_single_mempool=False, cuda_graph_retain_backward_graph=False, cuda_graph_warmup_steps=3, external_cuda_graph=False, cuda_graph_impl='none', cuda_graph_scope='full', clone_scatter_output_in_embedding=True, disable_parameter_transpose_cache=False, config_logger_dir='', flash_decode=False, use_te_activation_func=False, inference_rng_tracker=False, inference_sampling_seed=42, symmetric_ar_type=None, mrope_section=None, is_hybrid_model=False, mamba_state_dim=128, mamba_head_dim=64, mamba_num_groups=8, mamba_num_heads=None, use_mamba_mem_eff_path=True, mlp_chunks_for_prefill=1, heterogeneous_block_specs=False, hetereogenous_dist_checkpoint=False, quant_recipe=None, transformer_impl='transformer_engine')
[36m(WorkerDict pid=91821)[0m  > number of parameters on (tensor, pipeline) model parallel rank (0, 0): 30532122624
Error executing job with overrides: ['algorithm.adv_estimator=grpo', 'algorithm.use_kl_in_reward=False', 'algorithm.kl_ctrl.kl_coef=0.001', 'algorithm.gamma=1.0', 'algorithm.lam=0.95', 'data.train_files=hf://datasets/BytedTsinghua-SIA/DAPO-Math-17k/data/dapo-math-17k.parquet', 'data.val_files=hf://datasets/BytedTsinghua-SIA/AIME-2024/data/aime-2024.parquet', 'data.return_raw_chat=True', 'data.train_batch_size=256', 'data.max_prompt_length=2048', 'data.max_response_length=8192', 'data.filter_overlong_prompts=True', 'data.filter_overlong_prompts_workers=64', 'data.truncation=error', 'trainer.use_legacy_worker_impl=disable', 'trainer.critic_warmup=0', 'trainer.logger=[console,wandb]', 'trainer.project_name=wuxibin_gspo', 'trainer.experiment_name=qwen3-30B-base-grpo-megatron', 'trainer.default_local_dir=/root/FIM-RLVR-LEAN4/checkpoint/wuxibin_gspo/qwen3-30B-base-grpo-megatron', 'trainer.n_gpus_per_node=1', 'trainer.nnodes=1', 'trainer.val_before_train=False', 'trainer.log_val_generations=100', 'trainer.save_freq=-1', 'trainer.test_freq=10', 'trainer.total_epochs=10', 'trainer.total_training_steps=500', 'actor_rollout_ref.actor.optim.lr=1e-6', 'actor_rollout_ref.model.path=Qwen/Qwen3-30B-A3B-Base', 'actor_rollout_ref.model.use_remove_padding=True', 'actor_rollout_ref.actor.use_kl_loss=False', 'actor_rollout_ref.actor.kl_loss_coef=0.001', 'actor_rollout_ref.actor.clip_ratio_low=3e-4', 'actor_rollout_ref.actor.clip_ratio_high=4e-4', 'actor_rollout_ref.actor.clip_ratio_c=10.0', 'actor_rollout_ref.actor.policy_loss.loss_mode=gspo', 'actor_rollout_ref.actor.use_dynamic_bsz=True', 'actor_rollout_ref.actor.ppo_mini_batch_size=32', 'actor_rollout_ref.actor.ppo_max_token_len_per_gpu=30720', 'actor_rollout_ref.actor.megatron.tensor_model_parallel_size=1', 'actor_rollout_ref.actor.megatron.context_parallel_size=1', 'actor_rollout_ref.actor.megatron.pipeline_model_parallel_size=1', 'actor_rollout_ref.actor.megatron.virtual_pipeline_model_parallel_size=null', 'actor_rollout_ref.actor.megatron.expert_model_parallel_size=1', 'actor_rollout_ref.actor.megatron.expert_tensor_parallel_size=1', 'actor_rollout_ref.actor.megatron.param_offload=True', 'actor_rollout_ref.actor.megatron.grad_offload=True', 'actor_rollout_ref.actor.megatron.optimizer_offload=True', '+actor_rollout_ref.actor.megatron.override_transformer_config.moe_router_dtype=fp32', '+actor_rollout_ref.actor.megatron.override_transformer_config.moe_permute_fusion=True', '+actor_rollout_ref.actor.megatron.override_transformer_config.recompute_method=uniform', '+actor_rollout_ref.actor.megatron.override_transformer_config.recompute_granularity=full', '+actor_rollout_ref.actor.megatron.override_transformer_config.recompute_num_layers=1', '+actor_rollout_ref.actor.megatron.override_transformer_config.apply_rope_fusion=True', '+actor_rollout_ref.actor.megatron.override_transformer_config.gradient_accumulation_fusion=False', 'actor_rollout_ref.actor.megatron.use_mbridge=True', 'actor_rollout_ref.rollout.name=vllm', 'actor_rollout_ref.rollout.mode=async', 'actor_rollout_ref.rollout.tensor_model_parallel_size=1', 'actor_rollout_ref.rollout.data_parallel_size=1', 'actor_rollout_ref.rollout.expert_parallel_size=1', 'actor_rollout_ref.rollout.gpu_memory_utilization=0.8', 'actor_rollout_ref.rollout.n=16', 'actor_rollout_ref.rollout.val_kwargs.top_p=0.7', 'actor_rollout_ref.rollout.val_kwargs.temperature=1.0', 'actor_rollout_ref.rollout.val_kwargs.n=1', 'reward_model.reward_manager=dapo', '+reward_model.reward_kwargs.overlong_buffer_cfg.enable=True', '+reward_model.reward_kwargs.overlong_buffer_cfg.len=4096', '+reward_model.reward_kwargs.overlong_buffer_cfg.penalty_factor=1.0', '+reward_model.reward_kwargs.overlong_buffer_cfg.log=False', '+reward_model.reward_kwargs.max_resp_len=8192']
Traceback (most recent call last):
  File "/root/verl/verl/trainer/main_ppo.py", line 45, in main
    run_ppo(config)
  File "/root/verl/verl/trainer/main_ppo.py", line 99, in run_ppo
    ray.get(runner.run.remote(config))
  File "/root/anaconda3/envs/py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/anaconda3/envs/py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 104, in wrapper
    return func(*args, **kwargs)
  File "/root/anaconda3/envs/py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2967, in get
    values, debugger_breakpoint = worker.get_objects(
  File "/root/anaconda3/envs/py310/lib/python3.10/site-packages/ray/_private/worker.py", line 1015, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(OutOfMemoryError): [36mray::TaskRunner.run()[39m (pid=89263, ip=172.17.0.2, actor_id=ffd9a3cd4ba1640ee9af3c5d01000000, repr=<main_ppo.TaskRunner object at 0x79c196bfec20>)
  File "/root/verl/verl/trainer/main_ppo.py", line 371, in run
    trainer.init_workers()
  File "/root/verl/verl/trainer/ppo/ray_trainer.py", line 912, in init_workers
    self.actor_rollout_wg.init_model()
  File "/root/verl/verl/single_controller/ray/base.py", line 53, in __call__
    output = ray.get(output)
ray.exceptions.RayTaskError(OutOfMemoryError): [36mray::WorkerDict.actor_rollout_init_model()[39m (pid=91821, ip=172.17.0.2, actor_id=84e0fc4688f53b883f3304af01000000, repr=<verl.single_controller.ray.base.WorkerDict object at 0x7b73579f6f50>)
  File "/root/anaconda3/envs/py310/lib/python3.10/concurrent/futures/_base.py", line 451, in result
    return self.__get_result()
  File "/root/anaconda3/envs/py310/lib/python3.10/concurrent/futures/_base.py", line 403, in __get_result
    raise self._exception
  File "/root/verl/verl/single_controller/ray/base.py", line 841, in func
    return getattr(self.worker_dict[key], name)(*args, **kwargs)
  File "/root/verl/verl/single_controller/base/decorator.py", line 456, in inner
    return func(*args, **kwargs)
  File "/root/verl/verl/utils/transferqueue_utils.py", line 309, in dummy_inner
    output = func(*args, **kwargs)
  File "/root/verl/verl/workers/engine_workers.py", line 469, in init_model
    self.actor.reset()
  File "/root/verl/verl/single_controller/base/decorator.py", line 456, in inner
    return func(*args, **kwargs)
  File "/root/verl/verl/utils/transferqueue_utils.py", line 309, in dummy_inner
    output = func(*args, **kwargs)
  File "/root/verl/verl/workers/engine_workers.py", line 120, in reset
    self.engine.initialize()
  File "/root/verl/verl/workers/engine/megatron/transformer_impl.py", line 281, in initialize
    self.module = self._build_megatron_module()
  File "/root/verl/verl/workers/engine/megatron/transformer_impl.py", line 208, in _build_megatron_module
    module, updated_tf_config = make_megatron_module(
  File "/root/verl/verl/utils/megatron_utils.py", line 270, in make_megatron_module
    model = bridge.get_model(
  File "/root/anaconda3/envs/py310/lib/python3.10/site-packages/mbridge/core/bridge.py", line 115, in get_model
    model = get_model(
  File "/root/anaconda3/envs/py310/lib/python3.10/site-packages/mbridge/core/util.py", line 226, in get_model
    model = [
  File "/root/anaconda3/envs/py310/lib/python3.10/site-packages/mbridge/core/util.py", line 227, in <listcomp>
    DP(
  File "/root/anaconda3/envs/py310/lib/python3.10/site-packages/megatron/core/distributed/distributed_data_parallel.py", line 312, in __init__
    self.buffers, self.bucket_groups = _allocate_buffers_for_parameters(
  File "/root/anaconda3/envs/py310/lib/python3.10/site-packages/megatron/core/distributed/distributed_data_parallel.py", line 221, in _allocate_buffers_for_parameters
    _ParamAndGradBuffer(
  File "/root/anaconda3/envs/py310/lib/python3.10/site-packages/megatron/core/distributed/param_and_grad_buffer.py", line 716, in __init__
    self.param_data = torch.zeros(
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 56.87 GiB. GPU 0 has a total capacity of 94.97 GiB of which 31.39 GiB is free. Including non-PyTorch memory, this process has 63.57 GiB memory in use. Of the allocated memory 56.87 GiB is allocated by PyTorch, and 6.00 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
